var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function p(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function l(t){return document.createTextNode(t)}function f(){return l(" ")}function h(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let d;function y(t){d=t}const v=[],g=[],b=[],w=[],N=Promise.resolve();let x=!1;function S(t){b.push(t)}let k=!1;const E=new Set;function C(){if(!k){k=!0;do{for(let t=0;t<v.length;t+=1){const e=v[t];y(e),A(e.$$)}for(v.length=0;g.length;)g.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];E.has(e)||(E.add(e),e())}b.length=0}while(v.length);for(;w.length;)w.pop()();x=!1,k=!1,E.clear()}}function A(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const O=new Set;let T;function j(){T={r:0,c:[],p:T}}function P(){T.r||r(T.c),T=T.p}function M(t,e){t&&t.i&&(O.delete(t),t.i(e))}function I(t,e,n,r){if(t&&t.o){if(O.has(t))return;O.add(t),T.c.push(()=>{O.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function F(t){t&&t.c()}function _(t,n,i){const{fragment:a,on_mount:s,on_destroy:u,after_update:c}=t.$$;a&&a.m(n,i),S(()=>{const n=s.map(e).filter(o);u?u.push(...n):r(n),t.$$.on_mount=[]}),c.forEach(S)}function D(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function R(t,e){-1===t.$$.dirty[0]&&(v.push(t),x||(x=!0,N.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(e,o,i,a,s,c,p=[-1]){const l=d;y(e);const f=o.props||{},h=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:p};let m=!1;if(h.ctx=i?i(e,f,(t,n,...r)=>{const o=r.length?r[0]:n;return h.ctx&&s(h.ctx[t],h.ctx[t]=o)&&(h.bound[t]&&h.bound[t](o),m&&R(e,t)),n}):[],h.update(),m=!0,r(h.before_update),h.fragment=!!a&&a(h.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);h.fragment&&h.fragment.l(t),t.forEach(u)}else h.fragment&&h.fragment.c();o.intro&&M(e.$$.fragment),_(e,o.target,o.anchor),C()}y(l)}class B{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}var z="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function W(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function J(t,e){return t(e={exports:{}},e.exports),e.exports}var q=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Failed=0]="Failed",t[t.NoBrowserSupport=1]="NoBrowserSupport",t[t.NoAudioConsent=2]="NoAudioConsent",t[t.Disconnected=3]="Disconnected",t[t.Disconnecting=4]="Disconnecting",t[t.Connecting=5]="Connecting",t[t.Connected=6]="Connected",t[t.Starting=7]="Starting",t[t.Stopping=8]="Stopping",t[t.Recording=9]="Recording"}(e.ClientState||(e.ClientState={}))}));W(q);q.ClientState;var H=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.stateToString=function(t){var e;return null!==(e=r.get(t))&&void 0!==e?e:n};const n="Unknown",r=new Map([[q.ClientState.Failed,"Failed"],[q.ClientState.NoBrowserSupport,"NoBrowserSupport"],[q.ClientState.NoAudioConsent,"NoAudioConsent"],[q.ClientState.Disconnecting,"Disconnecting"],[q.ClientState.Disconnected,"Disconnected"],[q.ClientState.Connecting,"Connecting"],[q.ClientState.Connected,"Connected"],[q.ClientState.Starting,"Starting"],[q.ClientState.Stopping,"Stopping"],[q.ClientState.Recording,"Recording"]])}));W(H);H.stateToString;const U={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"اللغة العربية"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bh:{name:"Bihari",nativeName:"भोजपुरी"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan Standard",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"Dhivehi"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"Vakaviti"},fo:{name:"Faroese",nativeName:"føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"hrvatski jezik"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Tshiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Malaysia"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Ekakairũ Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"język polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovene",nativeName:"slovenski jezik"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmen"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}};class ${static getLanguages(t=[]){return t.map(t=>({code:t,name:$.getName(t),nativeName:$.getNativeName(t)}))}static getName(t){return $.validate(t)?U[t].name:""}static getAllNames(){return Object.values(U).map(t=>t.name)}static getNativeName(t){return $.validate(t)?U[t].nativeName:""}static getAllNativeNames(){return Object.values(U).map(t=>t.nativeName)}static getCode(t){return Object.keys(U).find(e=>{const n=U[e];return n.name.toLowerCase()===t.toLowerCase()||n.nativeName.toLowerCase()===t.toLowerCase()})||""}static getAllCodes(){return Object.keys(U)}static validate(t){return U.hasOwnProperty(t)}}const G={aa:"阿法尔语",ab:"阿布哈兹语",ae:"阿维斯陀语",af:"南非荷兰语",ak:"阿坎语",am:"阿姆哈拉语",an:"阿拉贡语",ar:"阿拉伯语",as:"阿萨姆语",av:"阿瓦尔语",ay:"艾马拉语",az:"阿塞拜疆语",ba:"巴什基尔语",be:"白俄罗斯语",bg:"保加利亚语",bh:"比哈尔语",bi:"比斯拉马语",bm:"班巴拉语",bn:"孟加拉语",bo:"藏语",br:"布列塔尼语",bs:"波斯尼亚语",ca:"加泰罗尼亚语",ce:"车臣语",ch:"查莫洛语",co:"科西嘉语",cr:"克里语",cs:"捷克语",cu:"古教会斯拉夫语",cv:"楚瓦什语",cy:"威尔士语",da:"丹麦语",de:"德语",dv:"迪维希语",dz:"不丹语",ee:"埃维语",el:"希腊语",en:"英语",eo:"世界语",es:"西班牙语",et:"爱沙尼亚语",eu:"巴斯克语",fa:"波斯语",ff:"富拉语",fi:"芬兰语",fj:"斐济语",fo:"法罗语",fr:"法语",fy:"西弗里西亚语",ga:"爱尔兰语",gd:"苏格兰盖尔语",gl:"加利西亚语",gn:"瓜拉尼语",gu:"古吉拉特语",gv:"马恩岛语",ha:"豪萨语",he:"希伯来语",hi:"印地语",ho:"莫图语",hr:"克罗地亚语",ht:"海地文",hu:"匈牙利语",hy:"亚美尼亚语",hz:"赫勒娄语",ia:"国际语",id:"印尼语",ie:"国际语",ig:"伊博语",ii:"诺苏语",ik:"依奴皮维克文",io:"伊多文",is:"冰岛语",it:"意大利语",iu:"因纽特语",ja:"日语",jv:"爪哇语",ka:"格鲁吉亚语",kg:"刚果语",ki:"基库尤语",kj:"宽亚马语",kk:"哈萨克语",kl:"格陵兰语",km:"高棉语",kn:"卡纳达语",ko:"韩语",kr:"卡努里语",ks:"克什米尔语",ku:"库尔德语",kv:"科米语",kw:"科尼什语",ky:"吉尔吉斯语",la:"拉丁语",lb:"卢森堡语",lg:"甘达语",li:"林堡语",ln:"林加拉语",lo:"老挝语",lt:"立陶宛语",lu:"卢巴加丹加语",lv:"拉脱维亚语",mg:"马尔加什语",mh:"马绍尔语",mi:"毛利语",mk:"马其顿语",ml:"马拉雅拉姆语",mn:"蒙古文",mr:"马拉地语",ms:"马来语",mt:"马耳他语",my:"缅甸语",na:"瑙鲁语",nb:"挪威博克马尔语",nd:"北恩德贝勒语",ne:"尼泊尔语",ng:"尼日尔刚果语",nl:"荷兰语",nn:"挪威尼诺斯克语",no:"挪威语",nr:"南恩德贝勒语",nv:"纳瓦霍语",ny:"齐切瓦语",oc:"奥克西唐语",oj:"欧及布威语",om:"奥罗莫语",or:"奥里亚语",os:"奥塞梯语",pa:"旁遮普语",pi:"巴利语",pl:"波兰语",ps:"普什图语",pt:"葡萄牙语",qu:"克丘亚语",rm:"罗曼斯语",rn:"基隆迪语",ro:"罗马尼亚语",ru:"俄语",rw:"卢旺达语",sa:"梵文",sc:"撒丁岛语",sd:"信德语",se:"北萨米文",sg:"桑戈语",si:"僧伽罗语",sk:"斯洛伐克语",sl:"斯洛文尼亚语",sm:"萨摩亚语",sn:"绍纳语",so:"索马里语",sq:"阿尔巴尼亚语",sr:"塞尔维亚语",ss:"斯瓦蒂语",st:"南索托语",su:"巽他语",sv:"瑞典语",sw:"斯瓦希里语",ta:"泰米尔语",te:"泰卢固语",tg:"塔吉克语",th:"泰语",ti:"提格雷语",tk:"土库曼语",tl:"菲律宾语",tn:"茨瓦纳语",to:"汤加语",tr:"土耳其语",ts:"特松加语",tt:"塔塔尔语",tw:"契维语",ty:"塔希提语",ug:"维吾尔语",uk:"乌克兰语",ur:"乌尔都语",uz:"乌兹别克语",ve:"文达语",vi:"越南语",vo:"沃拉普克语",wa:"华隆语",wo:"沃洛夫语",xh:"科萨语",yi:"意第绪语",yo:"约鲁巴语",za:"壮语",zh:"中文",zu:"祖鲁语"};class V extends ${static getLanguages(t){return super.getLanguages(t).map(t=>(Object.assign(t,{zhName:V.getZhName(t.code)}),t))}static getZhName(t){return super.validate(t)?G[t]:""}static getAllZhNames(){return Object.values(G)}}var K,Z,Y=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};function X(t,e,n,r){return t.call(r,e[n],n,e)}var Q=function(t,e,n){var r,o=0;for(r in null==K&&function(){for(var t in Z=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],K=!0,{toString:null})K=!1}(),t)if(!1===X(e,t,r,n))break;if(K)for(var i=t.constructor,a=!!i&&t===i.prototype;(r=Z[o++])&&("constructor"===r&&(a||!Y(t,r))||t[r]===Object.prototype[r]||!1!==X(e,t,r,n)););};var tt=function(t){var e=[];return Q(t,(function(t,n){"function"==typeof t&&e.push(n)})),e.sort()};var et=function(t,e,n){var r=t.length;e=null==e?0:e<0?Math.max(r+e,0):Math.min(e,r),n=null==n?r:n<0?Math.max(r+n,0):Math.min(n,r);for(var o=[];e<n;)o.push(t[e++]);return o};var nt=function(t,e,n){var r=et(arguments,2);return function(){return t.apply(e,r.concat(et(arguments)))}};var rt=function(t,e,n){if(null!=t)for(var r=-1,o=t.length;++r<o&&!1!==e.call(n,t[r],r,t););};var ot=function(t,e){var n=arguments.length>1?et(arguments,1):tt(t);rt(n,(function(e){t[e]=nt(t[e],t)}))};var it=function(t,e,n){Q(t,(function(r,o){if(Y(t,o))return e.call(n,t[o],o,t)}))};var at=function(t){return t};var st=function(t){return function(e){return e[t]}},ut=/^\[object (.*)\]$/,ct=Object.prototype.toString;var pt=function(t){return null===t?"Null":void 0===t?"Undefined":ut.exec(ct.call(t))[1]};var lt=function(t,e){return pt(t)===e},ft=Array.isArray||function(t){return lt(t,"Array")};function ht(t,e){for(var n=-1,r=t.length;++n<r;)if(mt(t[n],e))return!0;return!1}function mt(t,e){return t&&"object"==typeof t?ft(t)&&ft(e)?function(t,e){for(var n=-1,r=e.length;++n<r;)if(!ht(t,e[n]))return!1;return!0}(t,e):function(t,e){var n=!0;return it(e,(function(e,r){if(!mt(t[r],e))return n=!1})),n}(t,e):t===e}var dt=mt;var yt=function(t,e){if(null==t)return at;switch(typeof t){case"function":return void 0!==e?function(n,r,o){return t.call(e,n,r,o)}:t;case"object":return function(e){return dt(e,t)};case"string":case"number":return st(t)}};var vt=function(t,e,n){e=yt(e,n);var r=!1;return it(t,(function(n,o){if(e(n,o,t))return r=!0,!1})),r};var gt=function(t,e){return vt(t,(function(t){return t===e}))};var bt=function(t){return!!t&&"object"==typeof t&&t.constructor===Object};var wt=function t(e,n){for(var r,o=0,i=arguments.length;++o<i;)(r=arguments[o])&&it(r,(function(n,r){var o=e[r];null==o?e[r]=n:bt(o)&&bt(n)&&t(o,n)}));return e};function Nt(t,e){for(var n,r=0,o=arguments.length;++r<o;)(n=arguments[r])&&it(n,xt,t);return t}function xt(t,e){var n=this[e];bt(t)&&bt(n)?Nt(n,t):this[e]=t}var St=Nt;var kt=function(t,e,n){e=yt(e,n);var r=!0;return it(t,(function(n,o){if(!e(n,o,t))return r=!1,!1})),r};var Et=function(t){return lt(t,"Object")};var Ct=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};function At(t,e){return Y(this,e)}var Ot=function(t,e,n){return n=n||Ct,Et(t)&&Et(e)?kt(t,function(t){return function(e,n){return Y(this,n)&&t(e,this[n])}}(n),e)&&kt(e,At,t):n(t,e)};var Tt=function(t,e){return rt(et(arguments,1),(function(e){it(e,(function(e,n){null==t[n]&&(t[n]=e)}))})),t};var jt=function(t,e,n){e=yt(e,n);var r={};return it(t,(function(t,n,o){e(t,n,o)&&(r[n]=t)})),r};var Pt=function(t,e,n){var r;return e=yt(e,n),vt(t,(function(t,n,o){if(e(t,n,o))return r=t,!0})),r};var Mt=function(t,e){return null==t?{}:function t(e,n,r,o){return it(e,(function(e,i){var a=r?r+"."+i:i;0!==o&&bt(e)?t(e,n,a,o-1):n[a]=e})),n}(t,{},"",e=null==e?-1:e)};var It=function(t,e){for(var n=e.split("."),r=n.pop();e=n.shift();)if(null==(t=t[e]))return;return t[r]};var Ft=function(t,e){return void 0!==It(t,e)},_t=Object.keys||function(t){var e=[];return it(t,(function(t,n){e.push(n)})),e};var Dt=function(t,e,n){e=yt(e,n);var r={};return it(t,(function(t,n,o){r[n]=e(t,n,o)})),r};var Rt=function(t,e){var n=!0;return it(e,(function(e,r){if(t[r]!==e)return n=!1})),n};var Lt=function(t,e,n){if(null!=t&&t.length){if(t.length&&!e)return Math.max.apply(Math,t);e=yt(e,n);for(var r,o,i,a=-1/0,s=-1,u=t.length;++s<u;)(i=e(o=t[s],s,t))>a&&(a=i,r=o);return r}return 1/0};var Bt=function(t){var e=[];return it(t,(function(t,n){e.push(t)})),e};function zt(t,e){this[e]=t}var Wt=function(t,e){for(var n,r=0,o=arguments.length;++r<o;)null!=(n=arguments[r])&&it(n,zt,t);return t};var Jt=function(t){switch(pt(t)){case"Object":return bt(r=t)?Wt({},r):r;case"Array":return t.slice();case"RegExp":return n="",n+=(e=t).multiline?"m":"",n+=e.global?"g":"",n+=e.ignoreCase?"i":"",new RegExp(e.source,n);case"Date":return new Date(+t);default:return t}var e,n,r};function qt(t,e){switch(pt(t)){case"Object":return function(t,e){if(bt(t)){var n={};return it(t,(function(t,n){this[n]=qt(t,e)}),n),n}return e?e(t):t}(t,e);case"Array":return function(t,e){var n=[],r=-1,o=t.length;for(;++r<o;)n[r]=qt(t[r],e);return n}(t,e);default:return Jt(t)}}var Ht=qt;var Ut=function t(){var e,n,r,o,i=1;for(o=Ht(arguments[0]);r=arguments[i++];)for(e in r)Y(r,e)&&(n=r[e],Et(n)&&Et(o[e])?o[e]=t(o[e],n):o[e]=Ht(n));return o};var $t=function(t,e,n){if(null!=t&&t.length){if(t.length&&!e)return Math.min.apply(Math,t);e=yt(e,n);for(var r,o,i,a=1/0,s=-1,u=t.length;++s<u;)(i=e(o=t[s],s,t))<a&&(a=i,r=o);return r}return-1/0};var Gt=function(t,e){return e?(rt(e.split("."),(function(e){t[e]||(t[e]={}),t=t[e]})),t):t};var Vt=function(t,e,n){if(n=n||0,null==t)return-1;for(var r=t.length,o=n<0?r+n:n;o<r;){if(t[o]===e)return o;o++}return-1};var Kt=function(t,e){return-1!==Vt(t,e)};var Zt=function(t,e){return Dt(t,st(e))};var Yt=function(t){var e=0;return it(t,(function(){e++})),e};var Xt=function(t,e,n,r){var o=arguments.length>2;if(!Yt(t)&&!o)throw new Error("reduce of empty object with no initial value");return it(t,(function(t,i,a){o?n=e.call(r,n,t,i,a):(n=t,o=!0)})),n};var Qt=function(t,e,n){return e=yt(e,n),jt(t,(function(t,n,r){return!e(t,n,r)}),n)};var te=function(t){return lt(t,"Function")};var ee=function(t,e,n){var r=/^(.+)\.(.+)$/.exec(e);r?Gt(t,r[1])[r[2]]=n:t[e]=n};var ne=function(t,e){if(Ft(t,e)){for(var n=e.split("."),r=n.pop();e=n.shift();)t=t[e];return delete t[r]}return!0},re={bindAll:ot,contains:gt,deepFillIn:wt,deepMatches:dt,deepMixIn:St,equals:Ot,every:kt,fillIn:Tt,filter:jt,find:Pt,flatten:Mt,forIn:Q,forOwn:it,functions:tt,get:It,has:Ft,hasOwn:Y,keys:_t,map:Dt,matches:Rt,max:function(t,e){return Lt(Bt(t),e)},merge:Ut,min:function(t,e){return $t(Bt(t),e)},mixIn:Wt,namespace:Gt,omit:function(t,e){var n="string"!=typeof arguments[1]?arguments[1]:et(arguments,1),r={};for(var o in t)t.hasOwnProperty(o)&&!Kt(n,o)&&(r[o]=t[o]);return r},pick:function(t,e){for(var n,r="string"!=typeof arguments[1]?arguments[1]:et(arguments,1),o={},i=0;n=r[i++];)o[n]=t[n];return o},pluck:Zt,reduce:Xt,reject:Qt,result:function(t,e){var n=t[e];if(void 0!==n)return te(n)?n.call(t):n},set:ee,size:Yt,some:vt,unset:ne,values:Bt},oe=J((function(t){(function(){var e,n,r;n=re,e=function(){function t(){}return t.prototype.getCountry=function(e){return t.prototype.countries[e]},t.prototype.getCode=function(e){var r,o;return o=null,null!=e&&-1!==(r=n.values(t.prototype.countries).indexOf(e))&&(o=Object.keys(t.prototype.countries)[r]),o},t.prototype.getCountries=function(){return n.values(t.prototype.countries)},t.prototype.getCodes=function(){return Object.keys(t.prototype.countries)},t.prototype.getData=function(){return t.prototype.countries},t.prototype.countries={AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthélemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},t}(),r=null,t.exports=null!=r?r:r=new e}).call(z)}));const ie=/^([a-z]{2})-([A-Z]{2})$/;class ae{static getLanguageCode(t){var e=t.match(ie);return!e||e.length<1?"":e[1]}static getLanguageName(t){var e=ae.getLanguageCode(t);return V.getName(e)}static getLanguageNativeName(t){var e=ae.getLanguageCode(t);return V.getNativeName(e)}static getLanguageZhName(t){var e=ae.getLanguageCode(t);return V.getZhName(e)}static validateLanguageCode(t){var e=ae.getLanguageCode(t);return V.validate(e)}static getLanguages(t){for(var e=[],n=0;n<t.length;n++)e.push({code:t[n],name:ae.getLanguageName(t[n]),nativeName:ae.getLanguageNativeName(t[n]),zhName:ae.getLanguageZhName(t[n])});return e}static getCountryCode(t){var e=t.match(ie);return!e||e.length<2?"":e[2]}static getCountryName(t){var e=ae.getCountryCode(t);return oe.getCountry(e)}static validateCountryCode(t){return t=ae.getCountryCode(t),-1!==oe.getCodes().indexOf(t)}static validate(t){var e=t.match(ie);return!!(e&&3===e.length&&ae.validateLanguageCode(t)&&ae.validateCountryCode(t))}}var se="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),ue=new Uint8Array(16);function ce(){if(!se)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return se(ue)}for(var pe,le,fe=[],he=0;he<256;++he)fe[he]=(he+256).toString(16).substr(1);function me(t,e){var n=e||0,r=fe;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}var de=0,ye=0;function ve(t,e,n){var r=function(t,r,o,i){var a=o&&i||0;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t)),"string"==typeof r&&(r=function(t){var e=[];return t.replace(/[a-fA-F0-9]{2}/g,(function(t){e.push(parseInt(t,16))})),e}(r)),!Array.isArray(t))throw TypeError("value must be an array of bytes");if(!Array.isArray(r)||16!==r.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var s=n(r.concat(t));if(s[6]=15&s[6]|e,s[8]=63&s[8]|128,o)for(var u=0;u<16;++u)o[a+u]=s[u];return o||me(s)};try{r.name=t}catch(t){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function ge(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function be(t,e,n,r,o,i){return ge((a=ge(ge(e,t),ge(r,i)))<<(s=o)|a>>>32-s,n);var a,s}function we(t,e,n,r,o,i,a){return be(e&n|~e&r,t,e,o,i,a)}function Ne(t,e,n,r,o,i,a){return be(e&r|n&~r,t,e,o,i,a)}function xe(t,e,n,r,o,i,a){return be(e^n^r,t,e,o,i,a)}function Se(t,e,n,r,o,i,a){return be(n^(e|~r),t,e,o,i,a)}var ke=ve("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.charCodeAt(n)}return function(t){var e,n,r,o=[],i=32*t.length;for(e=0;e<i;e+=8)n=t[e>>5]>>>e%32&255,r=parseInt("0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n),16),o.push(r);return o}(function(t,e){var n,r,o,i,a;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var s=1732584193,u=-271733879,c=-1732584194,p=271733878;for(n=0;n<t.length;n+=16)r=s,o=u,i=c,a=p,s=we(s,u,c,p,t[n],7,-680876936),p=we(p,s,u,c,t[n+1],12,-389564586),c=we(c,p,s,u,t[n+2],17,606105819),u=we(u,c,p,s,t[n+3],22,-1044525330),s=we(s,u,c,p,t[n+4],7,-176418897),p=we(p,s,u,c,t[n+5],12,1200080426),c=we(c,p,s,u,t[n+6],17,-1473231341),u=we(u,c,p,s,t[n+7],22,-45705983),s=we(s,u,c,p,t[n+8],7,1770035416),p=we(p,s,u,c,t[n+9],12,-1958414417),c=we(c,p,s,u,t[n+10],17,-42063),u=we(u,c,p,s,t[n+11],22,-1990404162),s=we(s,u,c,p,t[n+12],7,1804603682),p=we(p,s,u,c,t[n+13],12,-40341101),c=we(c,p,s,u,t[n+14],17,-1502002290),u=we(u,c,p,s,t[n+15],22,1236535329),s=Ne(s,u,c,p,t[n+1],5,-165796510),p=Ne(p,s,u,c,t[n+6],9,-1069501632),c=Ne(c,p,s,u,t[n+11],14,643717713),u=Ne(u,c,p,s,t[n],20,-373897302),s=Ne(s,u,c,p,t[n+5],5,-701558691),p=Ne(p,s,u,c,t[n+10],9,38016083),c=Ne(c,p,s,u,t[n+15],14,-660478335),u=Ne(u,c,p,s,t[n+4],20,-405537848),s=Ne(s,u,c,p,t[n+9],5,568446438),p=Ne(p,s,u,c,t[n+14],9,-1019803690),c=Ne(c,p,s,u,t[n+3],14,-187363961),u=Ne(u,c,p,s,t[n+8],20,1163531501),s=Ne(s,u,c,p,t[n+13],5,-1444681467),p=Ne(p,s,u,c,t[n+2],9,-51403784),c=Ne(c,p,s,u,t[n+7],14,1735328473),u=Ne(u,c,p,s,t[n+12],20,-1926607734),s=xe(s,u,c,p,t[n+5],4,-378558),p=xe(p,s,u,c,t[n+8],11,-2022574463),c=xe(c,p,s,u,t[n+11],16,1839030562),u=xe(u,c,p,s,t[n+14],23,-35309556),s=xe(s,u,c,p,t[n+1],4,-1530992060),p=xe(p,s,u,c,t[n+4],11,1272893353),c=xe(c,p,s,u,t[n+7],16,-155497632),u=xe(u,c,p,s,t[n+10],23,-1094730640),s=xe(s,u,c,p,t[n+13],4,681279174),p=xe(p,s,u,c,t[n],11,-358537222),c=xe(c,p,s,u,t[n+3],16,-722521979),u=xe(u,c,p,s,t[n+6],23,76029189),s=xe(s,u,c,p,t[n+9],4,-640364487),p=xe(p,s,u,c,t[n+12],11,-421815835),c=xe(c,p,s,u,t[n+15],16,530742520),u=xe(u,c,p,s,t[n+2],23,-995338651),s=Se(s,u,c,p,t[n],6,-198630844),p=Se(p,s,u,c,t[n+7],10,1126891415),c=Se(c,p,s,u,t[n+14],15,-1416354905),u=Se(u,c,p,s,t[n+5],21,-57434055),s=Se(s,u,c,p,t[n+12],6,1700485571),p=Se(p,s,u,c,t[n+3],10,-1894986606),c=Se(c,p,s,u,t[n+10],15,-1051523),u=Se(u,c,p,s,t[n+1],21,-2054922799),s=Se(s,u,c,p,t[n+8],6,1873313359),p=Se(p,s,u,c,t[n+15],10,-30611744),c=Se(c,p,s,u,t[n+6],15,-1560198380),u=Se(u,c,p,s,t[n+13],21,1309151649),s=Se(s,u,c,p,t[n+4],6,-145523070),p=Se(p,s,u,c,t[n+11],10,-1120210379),c=Se(c,p,s,u,t[n+2],15,718787259),u=Se(u,c,p,s,t[n+9],21,-343485551),s=ge(s,r),u=ge(u,o),c=ge(c,i),p=ge(p,a);return[s,u,c,p]}(function(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t[e/8])<<e%32;return n}(t),8*t.length))}));function Ee(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}function Ce(t,e){return t<<e|t>>>32-e}var Ae=ve("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var r=unescape(encodeURIComponent(t));t=new Array(r.length);for(var o=0;o<r.length;o++)t[o]=r.charCodeAt(o)}t.push(128);var i=t.length/4+2,a=Math.ceil(i/16),s=new Array(a);for(o=0;o<a;o++){s[o]=new Array(16);for(var u=0;u<16;u++)s[o][u]=t[64*o+4*u]<<24|t[64*o+4*u+1]<<16|t[64*o+4*u+2]<<8|t[64*o+4*u+3]}for(s[a-1][14]=8*(t.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(t.length-1)&4294967295,o=0;o<a;o++){for(var c=new Array(80),p=0;p<16;p++)c[p]=s[o][p];for(p=16;p<80;p++)c[p]=Ce(c[p-3]^c[p-8]^c[p-14]^c[p-16],1);var l=n[0],f=n[1],h=n[2],m=n[3],d=n[4];for(p=0;p<80;p++){var y=Math.floor(p/20),v=Ce(l,5)+Ee(y,f,h,m)+d+e[y]+c[p]>>>0;d=m,m=h,h=Ce(f,30)>>>0,f=l,l=v}n[0]=n[0]+l>>>0,n[1]=n[1]+f>>>0,n[2]=n[2]+h>>>0,n[3]=n[3]+m>>>0,n[4]=n[4]+d>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),Oe=Object.freeze({__proto__:null,v1:function(t,e,n){var r=e&&n||0,o=e||[],i=(t=t||{}).node||pe,a=void 0!==t.clockseq?t.clockseq:le;if(null==i||null==a){var s=t.random||(t.rng||ce)();null==i&&(i=pe=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=le=16383&(s[6]<<8|s[7]))}var u=void 0!==t.msecs?t.msecs:(new Date).getTime(),c=void 0!==t.nsecs?t.nsecs:ye+1,p=u-de+(c-ye)/1e4;if(p<0&&void 0===t.clockseq&&(a=a+1&16383),(p<0||u>de)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");de=u,ye=c,le=a;var l=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;o[r++]=l>>>24&255,o[r++]=l>>>16&255,o[r++]=l>>>8&255,o[r++]=255&l;var f=u/4294967296*1e4&268435455;o[r++]=f>>>8&255,o[r++]=255&f,o[r++]=f>>>24&15|16,o[r++]=f>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var h=0;h<6;++h)o[r+h]=i[h];return e||me(o)},v3:ke,v4:function(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||ce)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[r+i]=o[i];return e||me(o)},v5:Ae}),Te=J((function(t,e){function n(t){if(0===t)return 1;const e=Math.PI*t;return Math.sin(e)/e}Object.defineProperty(e,"__esModule",{value:!0}),e.generateDownsampler=function(t,e){const r=t/e,o=function(t,e,r){if(r%2==0)throw Error("Filter length must be odd");const o=new Array(r);let i=0;for(let a=0;a<r;a++){const s=n(2*e/t*(a-(r-1)/2));i+=s,o[a]=s}for(let t=0;t<r;t++)o[t]=o[t]/i;return o}(t,e/2,23);let i=new Float32Array(0);return t=>{const e=new Float32Array(i.length+t.length);e.set(i,0),e.set(t,i.length);const n=Math.ceil((e.length-o.length)/r),a=new Float32Array(n);for(let t=0;t<n;t++){const n=Math.round(r*t);for(let r=0;r<o.length;r++)a[t]+=e[n+r]*o[r]}const s=Math.round(r*n);return i=s<e.length?e.slice(s):new Float32Array(0),a}},e.float32ToInt16=function(t){let e=t.length;const n=new Int16Array(e);for(;e-- >0;)n[e]=t[e]*(t[e]<0?32768:32767);return n.buffer}}));W(Te);Te.generateDownsampler,Te.float32ToInt16;var je=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultSampleRate=16e3,e.ErrNotInitialized=new Error("Microphone is not initialized"),e.ErrAlreadyInitialized=new Error("Microphone is already initialized"),e.ErrDeviceNotSupported=new Error("Current device does not support microphone API"),e.ErrNoAudioConsent=new Error("Microphone consent is no given")}));W(je);je.DefaultSampleRate,je.ErrNotInitialized,je.ErrAlreadyInitialized,je.ErrDeviceNotSupported,je.ErrNoAudioConsent;var Pe=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.BrowserMicrophone=class{constructor(t){this.onAudioCb=()=>{},this.sampleRate=t}onAudio(t){this.onAudioCb=t}initialize(t){var e;return void 0!==this.audioTrack?t(je.ErrAlreadyInitialized):void 0===(null===(e=window.navigator)||void 0===e?void 0:e.mediaDevices)?t(je.ErrDeviceNotSupported):void window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e=>{if(this.mediaStream=e,this.audioTrack=this.mediaStream.getAudioTracks()[0],this.audioTrack.enabled=!1,void 0!==window.AudioContext)this.audioContext=new window.AudioContext;else{if(void 0===window.webkitAudioContext)throw Error("Microphone functionality is not supported in your browser");this.audioContext=new window.webkitAudioContext}this.downsampler=Te.generateDownsampler(this.audioContext.sampleRate,this.sampleRate),this.audioProcessor=this.audioContext.createScriptProcessor(4096,1,1),this.audioContext.createMediaStreamSource(this.mediaStream).connect(this.audioProcessor),this.audioProcessor.connect(this.audioContext.destination),this.audioProcessor.onaudioprocess=t=>{if(void 0===this.audioTrack)throw Error("Microphone audio track is not initialized");if(void 0===this.downsampler)throw Error("Microphone downsampler is not initialized");if(!this.audioTrack.enabled)return;const e=Te.float32ToInt16(this.downsampler(t.inputBuffer.getChannelData(0)));this.onAudioCb(e)},t()}).catch(()=>{t(je.ErrNoAudioConsent)})}close(t){if(void 0===this.mediaStream)return t(je.ErrNotInitialized);if(this.mute(),this.mediaStream.getTracks().forEach(t=>t.stop()),void 0!==this.audioProcessor&&this.audioProcessor.disconnect(),void 0===this.audioContext)return t();const e=e=>(this.mediaStream=void 0,this.audioTrack=void 0,this.audioContext=void 0,this.downsampler=void 0,this.audioProcessor=void 0,void 0!==e?t(e):t());this.audioContext.close().then(e).catch(e)}mute(){void 0!==this.audioTrack&&(this.audioTrack.enabled=!1)}unmute(){void 0!==this.audioTrack&&(this.audioTrack.enabled=!0)}}}));W(Pe);Pe.BrowserMicrophone;var Me=J((function(t,e){function n(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(Pe),n(je)}));W(Me);var Ie=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Started="started",t.Stopped="stopped",t.SegmentEnd="segment_end",t.Transcript="transcript",t.Entity="entity",t.Intent="intent",t.TentativeTranscript="tentative_transcript",t.TentativeEntities="tentative_entities",t.TentativeIntent="tentative_intent"}(e.WebsocketResponseType||(e.WebsocketResponseType={}))}));W(Ie);Ie.WebsocketResponseType;var Fe=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.Websocket=class{constructor(t,e,n,r){this.startCbs=[],this.stopCbs=[],this.onResponseCb=()=>{},this.onCloseCb=()=>{},this.onWebsocketMessage=t=>{let e;try{e=JSON.parse(t.data)}catch(t){return void console.error("[SpeechlyClient] Error parsing response from the server:",t)}switch(e.type){case Ie.WebsocketResponseType.Started:this.startCbs.forEach(t=>{try{t(void 0,e.audio_context)}catch(t){console.error('[SpeechlyClient] Error while invoking "onStart" callback:',t)}}),this.startCbs.length=0;break;case Ie.WebsocketResponseType.Stopped:this.stopCbs.forEach(t=>{try{t(void 0,e.audio_context)}catch(t){console.error('[SpeechlyClient] Error while invoking "onStop" callback:',t)}}),this.stopCbs.length=0;break;default:this.onResponseCb(e)}},this.onWebsocketClose=t=>{this.onCloseCb(Error("Websocket was closed: "+t.reason))},this.onWebsocketError=t=>{this.close(1e3,"Client disconnecting due to an error"),this.onCloseCb(Error("Websocket was closed because of error"))},this.baseUrl=t,this.languageCode=n,this.sampleRate=r,this.appId=e}onResponse(t){this.onResponseCb=t}onClose(t){this.onCloseCb=t}initialize(t,e){if(void 0!==this.websocket)return e(Error("Cannot initialize an already initialized websocket client"));!function(t,e,n){const r=new WebSocket(t,e),o=()=>{r.removeEventListener("close",o),r.removeEventListener("error",o),r.removeEventListener("open",i),n(Error("Connection failed"))},i=()=>{r.removeEventListener("close",o),r.removeEventListener("error",o),r.removeEventListener("open",i),n(void 0,r)};r.addEventListener("close",o),r.addEventListener("error",o),r.addEventListener("open",i)}(function(t,e,n,r){const o=new URLSearchParams;return o.append("deviceId",e),o.append("languageCode",n),o.append("sampleRate",r.toString()),`${t}?${o.toString()}`}(this.baseUrl,t,this.languageCode,this.sampleRate),this.appId,(t,n)=>void 0!==t?e(t):(this.websocket=n,this.websocket.addEventListener("message",this.onWebsocketMessage),this.websocket.addEventListener("error",this.onWebsocketError),this.websocket.addEventListener("close",this.onWebsocketClose),e()))}close(t,e){if(void 0===this.websocket)return Error("Websocket is not open");this.websocket.removeEventListener("message",this.onWebsocketMessage),this.websocket.removeEventListener("error",this.onWebsocketError),this.websocket.removeEventListener("close",this.onWebsocketClose),this.websocket.close(t,e),this.websocket=void 0}start(t){if(!this.isOpen())return t(Error("Websocket is not ready"));this.startCbs.push(t),this.websocket.send(n)}stop(t){if(!this.isOpen())return t(new Error("websocket is not ready"));this.stopCbs.push(t),this.websocket.send(r)}send(t){if(!this.isOpen())return Error("Cannot send data through inactive websocket");this.websocket.send(t)}isOpen(){return void 0!==this.websocket&&this.websocket.readyState===this.websocket.OPEN}};const n=JSON.stringify({event:"start"}),r=JSON.stringify({event:"stop"})}));W(Fe);Fe.Websocket;var _e=J((function(t,e){function n(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(Fe),n(Ie)}));W(_e);var De=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.SegmentState=class{constructor(t,e){this.isFinalized=!1,this.words=[],this.entities=new Map,this.intent={intent:"",isFinal:!1},this.contextId=t,this.id=e}toSegment(){let t=0;const e=new Array(this.entities.size);return this.entities.forEach(n=>{e[t]=n,t++}),{id:this.id,contextId:this.contextId,isFinal:this.isFinalized,words:this.words,entities:e,intent:this.intent}}updateTranscript(t){return t.forEach(t=>{this.words[t.index]=t}),this}updateEntities(t){return t.forEach(t=>this.entities.set(function(t){return`${t.startPosition.toString()}:${t.endPosition.toString()}`}(t),t)),this}updateIntent(t){return this.intent.isFinal||(this.intent=t),this}finalize(){return this.entities.forEach((t,e)=>{t.isFinal||this.entities.delete(e)}),this.words=this.words.filter(t=>t.isFinal),this.intent.isFinal||(this.intent.intent="",this.intent.isFinal=!0),this.isFinalized=!0,this}}}));W(De);De.SegmentState;var Re=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.parseTentativeTranscript=function(t){return t.words.map(({word:t,index:e,start_timestamp:n,end_timestamp:r})=>({value:t,index:e,startTimestamp:n,endTimestamp:r,isFinal:!1}))},e.parseTranscript=function(t){return{value:t.word,index:t.index,startTimestamp:t.start_timestamp,endTimestamp:t.end_timestamp,isFinal:!0}},e.parseTentativeEntities=function(t){return t.entities.map(({entity:t,value:e,start_position:n,end_position:r})=>({type:t,value:e,startPosition:n,endPosition:r,isFinal:!1}))},e.parseEntity=function(t){return{type:t.entity,value:t.value,startPosition:t.start_position,endPosition:t.end_position,isFinal:!0}},e.parseIntent=function(t,e){return{intent:t.intent,isFinal:e}}}));W(Re);Re.parseTentativeTranscript,Re.parseTranscript,Re.parseTentativeEntities,Re.parseEntity,Re.parseIntent;var Le=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ErrNoStorageSupport=new Error("Current device does not support storage API"),e.ErrKeyNotFound=new Error("Requested key was not present in storage")}));W(Le);Le.ErrNoStorageSupport,Le.ErrKeyNotFound;var Be=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.LocalStorage=class{constructor(){this.storage=window.localStorage}initialize(t){t()}close(t){t()}get(t,e){const n=this.storage.getItem(t);return null===n?e(Le.ErrKeyNotFound):e(void 0,n)}set(t,e,n){return this.storage.setItem(t,e),n()}}}));W(Be);Be.LocalStorage;var ze=J((function(t,e){function n(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(Be),n(Le)}));W(ze);var We=J((function(t,e){var n=z&&z.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=n(ae);e.Client=class{constructor(t){var e,n,o,i,a,s;if(this.activeContexts=new Map,this.state=q.ClientState.Disconnected,this.reconnectAttemptCount=5,this.nextReconnectDelay=1e3,this.stateChangeCb=()=>{},this.segmentChangeCb=()=>{},this.tentativeTranscriptCb=()=>{},this.tentativeEntitiesCb=()=>{},this.tentativeIntentCb=()=>{},this.transcriptCb=()=>{},this.entityCb=()=>{},this.intentCb=()=>{},this.handleWebsocketResponse=t=>{this.debug&&console.log("[SpeechlyClient]","Received response",t);const{audio_context:e,segment_id:n,type:r}=t;let{data:o}=t,i=this.activeContexts.get(e);if(void 0!==i){switch(r){case _e.WebsocketResponseType.TentativeTranscript:o=o;const t=Re.parseTentativeTranscript(o);this.tentativeTranscriptCb(e,n,t,o.transcript),i=i.updateTranscript(t);break;case _e.WebsocketResponseType.Transcript:o=o;const r=Re.parseTranscript(o);this.transcriptCb(e,n,r),i=i.updateTranscript([r]);break;case _e.WebsocketResponseType.TentativeEntities:o=o;const a=Re.parseTentativeEntities(o);this.tentativeEntitiesCb(e,n,a),i=i.updateEntities(a);break;case _e.WebsocketResponseType.Entity:o=o;const s=Re.parseEntity(o);this.entityCb(e,n,s),i=i.updateEntities([s]);break;case _e.WebsocketResponseType.TentativeIntent:o=o;const u=Re.parseIntent(o,!1);this.tentativeIntentCb(e,n,u),i=i.updateIntent(u);break;case _e.WebsocketResponseType.Intent:o=o;const c=Re.parseIntent(o,!0);this.intentCb(e,n,c),i=i.updateIntent(c);break;case _e.WebsocketResponseType.SegmentEnd:i=i.finalize()}this.segmentChangeCb(i.toSegment()),i.isFinalized?this.activeContexts.set(e,new De.SegmentState(e,i.id+1)):this.activeContexts.set(e,i)}else console.warn("[SpeechlyClient]","Received response for non-existent context",e)},this.handleWebsocketClosure=t=>{this.debug&&console.error("[SpeechlyClient]","Server connection closed",t),this.reconnectWebsocket()},this.handleMicrophoneAudio=t=>{this.state===q.ClientState.Recording&&(this.debug&&console.log("[SpeechlyClient]","Sending audio data",t),this.websocket.send(t))},!r.default.validate(t.language))throw Error(`[SpeechlyClient] Invalid language "${t.language}"`);this.debug=null!==(e=t.debug)&&void 0!==e&&e,this.storage=null!==(n=t.storage)&&void 0!==n?n:new ze.LocalStorage,this.microphone=null!==(o=t.microphone)&&void 0!==o?o:new Me.BrowserMicrophone(null!==(i=t.sampleRate)&&void 0!==i?i:Me.DefaultSampleRate),this.websocket=new _e.Websocket(null!==(a=t.url)&&void 0!==a?a:"wss://api.speechly.com/ws",t.appId,t.language,null!==(s=t.sampleRate)&&void 0!==s?s:Me.DefaultSampleRate),this.microphone.onAudio(this.handleMicrophoneAudio),this.websocket.onResponse(this.handleWebsocketResponse),this.websocket.onClose(this.handleWebsocketClosure)}initialize(t=(()=>{})){if(this.state!==q.ClientState.Disconnected)return t(new Error("Cannot initialize client - client is not in Disconnected state"));this.setState(q.ClientState.Connecting),this.microphone.initialize(e=>{if(void 0!==e){switch(e){case Me.ErrDeviceNotSupported:this.setState(q.ClientState.NoBrowserSupport);break;case Me.ErrNoAudioConsent:this.setState(q.ClientState.NoAudioConsent);break;default:this.setState(q.ClientState.Failed)}return t(e)}const n=(t,e)=>{this.websocket.initialize(t,t=>void 0!==t?(this.reconnectWebsocket(),e()):(this.setState(q.ClientState.Connected),e()))};this.storage.initialize(e=>{if(void 0!==e)return t(e);this.storage.get("speechly-device-id",(e,r)=>{if(void 0!==e){const e=Oe.v4();this.storage.set("speechly-device-id",e,r=>void 0!==r?t(r):(this.deviceId=e,n(e,t)))}const o=r;return this.deviceId=o,n(o,t)})})})}close(t=(()=>{})){this.storage.close(e=>{const n=[];void 0!==e&&n.push(e.message),this.microphone.close(e=>{void 0!==e&&n.push(e.message);const r=this.websocket.close(1e3,"client disconnecting");return void 0!==r&&n.push(r.message),this.activeContexts.clear(),this.setState(q.ClientState.Disconnected),n.length>0?t(Error(n.join(","))):t()})})}startContext(t=(()=>{})){if(this.state!==q.ClientState.Connected)return t(Error("Cannot start context - client is not connected"));this.reconnectAttemptCount=5,this.nextReconnectDelay=1e3,this.setState(q.ClientState.Starting),this.websocket.start((e,n)=>{if(void 0!==e)return this.setState(q.ClientState.Connected),t(e);const r=n;return this.setState(q.ClientState.Recording),this.microphone.unmute(),this.activeContexts.set(r,new De.SegmentState(r,1)),t(void 0,n)})}stopContext(t=(()=>{})){if(this.state!==q.ClientState.Recording)return t(new Error("Cannot stop context - client is not recording"));this.setState(q.ClientState.Stopping),this.microphone.mute(),this.websocket.stop((e,n)=>{if(void 0!==e)return this.setState(q.ClientState.Failed),t(e);const r=n;return this.setState(q.ClientState.Connected),this.activeContexts.delete(r)||console.warn("[SpeechlyClient]","Attempted to remove non-existent context",r),t()})}onStateChange(t){this.stateChangeCb=t}onSegmentChange(t){this.segmentChangeCb=t}onTentativeTranscript(t){this.tentativeTranscriptCb=t}onTranscript(t){this.transcriptCb=t}onTentativeEntities(t){this.tentativeEntitiesCb=t}onEntity(t){this.entityCb=t}onTentativeIntent(t){this.tentativeIntentCb=t}onIntent(t){this.intentCb=t}reconnectWebsocket(){if(void 0===this.deviceId)return this.setState(q.ClientState.Disconnected);const t=this.deviceId;if(this.reconnectAttemptCount<1)return this.setState(q.ClientState.Disconnected);this.state!==q.ClientState.Connecting&&this.setState(q.ClientState.Connecting),this.debug&&console.log("[SpeechlyClient]",`Attempting to re-connect to the server in ${this.nextReconnectDelay.toString()}ms`),setTimeout(()=>{this.reconnectAttemptCount=this.reconnectAttemptCount-1,this.nextReconnectDelay=2*this.nextReconnectDelay,this.websocket.initialize(t,t=>{if(void 0!==t)return this.reconnectWebsocket();this.setState(q.ClientState.Connected)})},this.nextReconnectDelay)}setState(t){this.state!==t&&(this.debug&&console.log("[SpeechlyClient]","State transition",H.stateToString(this.state),H.stateToString(t)),this.state=t,this.stateChangeCb(t))}}}));W(We);We.Client;var Je=J((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(q),e.stateToString=H.stateToString,e.Client=We.Client}));W(Je);Je.stateToString,Je.Client;const qe=new(W(J((function(t,e){function n(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(Je),n(je),n(Le)}))).Client)({appId:"3beb7f30-242f-4bbe-9ae7-fa38d977bb75",language:"en-US"});var He=W(J((function(t,e){
/**
     * rpg-dice-roller - A dice roller that accepts standard dice notation
     * 
     * @version v4.0.2
     * @license MIT
     * @author GreenImp <info@greenimp.co.uk> (http://greenimp.co.uk)
     * @link https://github.com/GreenImp/rpg-dice-roller
     */
!function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=p(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function f(t,e,n,r){return(f="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,r){var o,a=p(t,e);if(a){if((o=Object.getOwnPropertyDescriptor(a,e)).set)return o.set.call(r,n),!0;if(!o.writable)return!1}if(o=Object.getOwnPropertyDescriptor(r,e)){if(!o.writable)return!1;o.value=n,Object.defineProperty(r,e,o)}else i(r,e,n);return!0})(t,e,n,r)}function h(t,e,n,r,o){if(!f(t,e,n,r||t)&&o)throw new Error("failed to set property");return n}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e,n,r){this.message=t,this.expected=e,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}(function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n})(y,Error),y.buildMessage=function(t,e){var n={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?i(t.parts[e][0])+"-"+i(t.parts[e][1]):i(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,o,i=new Array(t.length);for(e=0;e<t.length;e++)i[e]=(o=t[e],n[o.type](o));if(i.sort(),i.length>0){for(e=1,r=1;e<i.length;e++)i[e-1]!==i[e]&&(i[r]=i[e],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."};var v=function(t,e){e=void 0!==e?e:{};var n,r,o,a,s={},u={Main:Tt},c=Tt,p=kt("{",!1),l=kt(",",!1),f=kt("}",!1),h=kt("d",!1),v=kt("%",!1),g=kt("dF",!1),b=kt(".",!1),w=/^[12]/,N=Et(["1","2"],!1,!1),x=kt("!",!1),S=kt("p",!1),k=/^[lh]/,E=Et(["l","h"],!1,!1),C=kt("k",!1),A=kt("r",!1),O=kt("o",!1),T=kt("cs",!1),j=kt("cf",!1),P=kt("s",!1),M=kt("a",!1),I=kt("f",!1),F=kt("!=",!1),_=kt("<=",!1),D=kt(">=",!1),R=kt("=",!1),L=kt(">",!1),B=kt("<",!1),z=kt("(",!1),W=kt(")",!1),J=function(t,e,n){return[t].concat(d(e),[n])},q=kt("abs",!1),H=kt("ceil",!1),U=kt("cos",!1),$=kt("exp",!1),G=kt("floor",!1),V=kt("log",!1),K=kt("round",!1),Z=kt("sign",!1),Y=kt("sin",!1),X=kt("sqrt",!1),Q=kt("tan",!1),tt=kt("pow",!1),et=kt("-",!1),nt=/^[.]/,rt=Et(["."],!1,!1),ot=/^[1-9]/,it=Et([["1","9"]],!1,!1),at=/^[0-9]/,st=Et([["0","9"]],!1,!1),ut=function(){return parseInt(St(),10)},ct=kt("**",!1),pt=kt("*",!1),lt=kt("^",!1),ft=kt("/",!1),ht=kt("+",!1),mt={type:"other",description:"whitespace"},dt=/^[ \t\n\r]/,yt=Et([" ","\t","\n","\r"],!1,!1),vt=0,gt=0,bt=[{line:1,column:1}],wt=0,Nt=[],xt=0;if("startRule"in e){if(!(e.startRule in u))throw new Error("Can't start parsing from rule \""+e.startRule+'".');c=u[e.startRule]}function St(){return t.substring(gt,vt)}function kt(t,e){return{type:"literal",text:t,ignoreCase:e}}function Et(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function Ct(e){var n,r=bt[e];if(r)return r;for(n=e-1;!bt[n];)n--;for(r={line:(r=bt[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return bt[e]=r,r}function At(t,e){var n=Ct(t),r=Ct(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Ot(t){vt<wt||(vt>wt&&(wt=vt,Nt=[]),Nt.push(t))}function Tt(){return _t()}function jt(){var e,n,r,o,a,u,c,h,m,y,v,g;if(e=vt,123===t.charCodeAt(vt)?(n="{",vt++):(n=s,0===xt&&Ot(p)),n!==s)if(Wt()!==s)if((r=_t())!==s){for(o=[],a=vt,(u=Wt())!==s?(44===t.charCodeAt(vt)?(c=",",vt++):(c=s,0===xt&&Ot(l)),c!==s&&(h=Wt())!==s&&(m=_t())!==s?a=u=[u,c,h,m]:(vt=a,a=s)):(vt=a,a=s);a!==s;)o.push(a),a=vt,(u=Wt())!==s?(44===t.charCodeAt(vt)?(c=",",vt++):(c=s,0===xt&&Ot(l)),c!==s&&(h=Wt())!==s&&(m=_t())!==s?a=u=[u,c,h,m]:(vt=a,a=s)):(vt=a,a=s);if(o!==s)if((a=Wt())!==s)if(125===t.charCodeAt(vt)?(u="}",vt++):(u=s,0===xt&&Ot(f)),u!==s){for(c=[],h=Mt();h!==s;)c.push(h),h=Mt();c!==s?(gt=e,y=r,v=o,g=c,e=n={type:"group",notation:St(),expressions:[y].concat(d(v.map((function(t){return t[3]})))),modifiers:Object.assign.apply(Object,[{}].concat(d(g.map((function(t){return i({},t.subType,t)})))))}):(vt=e,e=s)}else vt=e,e=s;else vt=e,e=s;else vt=e,e=s}else vt=e,e=s;else vt=e,e=s;else vt=e,e=s;return e}function Pt(){var e,n,r,o,a,u;if(e=vt,(n=function(){var e,n,r;return e=vt,(n=function(){var e,n,r,o;return e=vt,(n=Ft())===s&&(n=null),n!==s?(100===t.charCodeAt(vt)?(r="d",vt++):(r=s,0===xt&&Ot(h)),r!==s&&(o=Ft())!==s?(gt=e,e=n={type:"dice",subType:"standard",qty:n||1,d:r,sides:o}):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r,o;return e=vt,(n=Ft())===s&&(n=null),n!==s?(100===t.charCodeAt(vt)?(r="d",vt++):(r=s,0===xt&&Ot(h)),r!==s?(37===t.charCodeAt(vt)?(o="%",vt++):(o=s,0===xt&&Ot(v)),o!==s?(gt=e,e=n={type:"dice",subType:"percentile",qty:n||1,d:r,sides:100}):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r,o,i,a,u;return e=vt,(n=Ft())===s&&(n=null),n!==s?("dF"===t.substr(vt,2)?(r="dF",vt+=2):(r=s,0===xt&&Ot(g)),r!==s?(o=vt,46===t.charCodeAt(vt)?(i=".",vt++):(i=s,0===xt&&Ot(b)),i!==s?(w.test(t.charAt(vt))?(a=t.charAt(vt),vt++):(a=s,0===xt&&Ot(N)),a!==s?o=i=[i,a]:(vt=o,o=s)):(vt=o,o=s),o===s&&(o=null),o!==s?(gt=e,n={type:"dice",subType:"fudge",qty:n||1,d:r,sides:(u=o)?parseInt(u[1],10):2},e=n):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s),e}()),n!==s&&(gt=e,r=n,n=Object.assign(r,{notation:St()})),e=n}())!==s){for(r=[],o=Mt();o!==s;)r.push(o),o=Mt();r!==s?(gt=e,a=n,u=r,e=n=Object.assign(a,{modifiers:Object.assign.apply(Object,[{}].concat(d(u.map((function(t){return i({},t.subType,t)})))))})):(vt=e,e=s)}else vt=e,e=s;return e}function Mt(){var e,n,r;return e=vt,(n=function(){var e,n,r,o,i;return e=vt,33===t.charCodeAt(vt)?(n="!",vt++):(n=s,0===xt&&Ot(x)),n!==s?(33===t.charCodeAt(vt)?(r="!",vt++):(r=s,0===xt&&Ot(x)),r===s&&(r=null),r!==s?(112===t.charCodeAt(vt)?(o="p",vt++):(o=s,0===xt&&Ot(S)),o===s&&(o=null),o!==s?((i=It())===s&&(i=null),i!==s?(gt=e,e=n={type:"modifier",subType:"explode",penetrate:!!o,compound:!!r,comparePoint:i}):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r;return e=vt,(n=It())!==s?((r=function(){var e,n,r;return e=vt,102===t.charCodeAt(vt)?(n="f",vt++):(n=s,0===xt&&Ot(I)),n!==s&&(r=It())!==s?(gt=e,e=n=r):(vt=e,e=s),e}())===s&&(r=null),r!==s?(gt=e,e=n={type:"modifier",subType:"target",successCP:n,failureCP:r}):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r,o;return e=vt,100===t.charCodeAt(vt)?(n="d",vt++):(n=s,0===xt&&Ot(h)),n!==s?(k.test(t.charAt(vt))?(r=t.charAt(vt),vt++):(r=s,0===xt&&Ot(E)),r===s&&(r=null),r!==s&&(o=Lt())!==s?(gt=e,e=n={type:"modifier",subType:"drop",end:r||"l",qty:o}):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r,o;return e=vt,107===t.charCodeAt(vt)?(n="k",vt++):(n=s,0===xt&&Ot(C)),n!==s?(k.test(t.charAt(vt))?(r=t.charAt(vt),vt++):(r=s,0===xt&&Ot(E)),r===s&&(r=null),r!==s&&(o=Lt())!==s?(gt=e,e=n={type:"modifier",subType:"keep",end:r||"h",qty:o}):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r,o;return e=vt,114===t.charCodeAt(vt)?(n="r",vt++):(n=s,0===xt&&Ot(A)),n!==s?(111===t.charCodeAt(vt)?(r="o",vt++):(r=s,0===xt&&Ot(O)),r===s&&(r=null),r!==s?((o=It())===s&&(o=null),o!==s?(gt=e,e=n={type:"modifier",subType:"re-roll",once:!!r,comparePoint:o}):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r;return e=vt,"cs"===t.substr(vt,2)?(n="cs",vt+=2):(n=s,0===xt&&Ot(T)),n!==s&&(r=It())!==s?(gt=e,e=n={type:"modifier",subType:"critical-success",comparePoint:r}):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r;return e=vt,"cf"===t.substr(vt,2)?(n="cf",vt+=2):(n=s,0===xt&&Ot(j)),n!==s&&(r=It())!==s?(gt=e,e=n={type:"modifier",subType:"critical-failure",comparePoint:r}):(vt=e,e=s),e}())===s&&(n=function(){var e,n,r;return e=vt,115===t.charCodeAt(vt)?(n="s",vt++):(n=s,0===xt&&Ot(P)),n!==s?(97===t.charCodeAt(vt)?(r="a",vt++):(r=s,0===xt&&Ot(M)),r===s&&(100===t.charCodeAt(vt)?(r="d",vt++):(r=s,0===xt&&Ot(h))),r===s&&(r=null),r!==s?(gt=e,e=n={type:"modifier",subType:"sort",direction:r||"a"}):(vt=e,e=s)):(vt=e,e=s),e}()),n!==s&&(gt=e,r=n,n=Object.assign(r,{notation:St()})),e=n}function It(){var e,n,r;return e=vt,(n=function(){var e;return"!="===t.substr(vt,2)?(e="!=",vt+=2):(e=s,0===xt&&Ot(F)),e===s&&("<="===t.substr(vt,2)?(e="<=",vt+=2):(e=s,0===xt&&Ot(_)),e===s&&(">="===t.substr(vt,2)?(e=">=",vt+=2):(e=s,0===xt&&Ot(D)),e===s&&(61===t.charCodeAt(vt)?(e="=",vt++):(e=s,0===xt&&Ot(R)),e===s&&(62===t.charCodeAt(vt)?(e=">",vt++):(e=s,0===xt&&Ot(L)),e===s&&(60===t.charCodeAt(vt)?(e="<",vt++):(e=s,0===xt&&Ot(B))))))),e}())!==s&&(r=Rt())!==s?(gt=e,e=n={type:"compare-point",operator:n,value:r}):(vt=e,e=s),e}function Ft(){var e,n,r,o;return(e=Lt())===s&&(e=vt,40===t.charCodeAt(vt)?(n="(",vt++):(n=s,0===xt&&Ot(z)),n!==s&&Wt()!==s&&(r=_t())!==s&&Wt()!==s?(41===t.charCodeAt(vt)?(o=")",vt++):(o=s,0===xt&&Ot(W)),o!==s?(gt=e,e=n=J(n,r,o)):(vt=e,e=s)):(vt=e,e=s)),e}function _t(){var t,e,n,r,o,i,a,u,c,p;if(t=vt,(e=Dt())!==s){for(n=[],r=vt,(o=Wt())!==s&&(i=zt())!==s&&(a=Wt())!==s&&(u=Dt())!==s?r=o=[o,i,a,u]:(vt=r,r=s);r!==s;)n.push(r),r=vt,(o=Wt())!==s&&(i=zt())!==s&&(a=Wt())!==s&&(u=Dt())!==s?r=o=[o,i,a,u]:(vt=r,r=s);n!==s?(gt=t,c=e,p=n,c=Array.isArray(c)?c:[c],t=e=[].concat(d(c),d(p.map((function(t){var e=m(t,4);return[e[1],e[3]]})).flat(2)))):(vt=t,t=s)}else vt=t,t=s;return t}function Dt(){var e,n,r,o;return(e=function(){var e,n,r,o,i,a,u,c;return e=vt,"abs"===t.substr(vt,3)?(n="abs",vt+=3):(n=s,0===xt&&Ot(q)),n===s&&("ceil"===t.substr(vt,4)?(n="ceil",vt+=4):(n=s,0===xt&&Ot(H)),n===s&&("cos"===t.substr(vt,3)?(n="cos",vt+=3):(n=s,0===xt&&Ot(U)),n===s&&("exp"===t.substr(vt,3)?(n="exp",vt+=3):(n=s,0===xt&&Ot($)),n===s&&("floor"===t.substr(vt,5)?(n="floor",vt+=5):(n=s,0===xt&&Ot(G)),n===s&&("log"===t.substr(vt,3)?(n="log",vt+=3):(n=s,0===xt&&Ot(V)),n===s&&("round"===t.substr(vt,5)?(n="round",vt+=5):(n=s,0===xt&&Ot(K)),n===s&&("sign"===t.substr(vt,4)?(n="sign",vt+=4):(n=s,0===xt&&Ot(Z)),n===s&&("sin"===t.substr(vt,3)?(n="sin",vt+=3):(n=s,0===xt&&Ot(Y)),n===s&&("sqrt"===t.substr(vt,4)?(n="sqrt",vt+=4):(n=s,0===xt&&Ot(X)),n===s&&("tan"===t.substr(vt,3)?(n="tan",vt+=3):(n=s,0===xt&&Ot(Q)))))))))))),n!==s?(40===t.charCodeAt(vt)?(r="(",vt++):(r=s,0===xt&&Ot(z)),r!==s&&Wt()!==s&&(o=_t())!==s&&Wt()!==s?(41===t.charCodeAt(vt)?(i=")",vt++):(i=s,0===xt&&Ot(W)),i!==s?(gt=e,c=o,n=["".concat(n,"(")].concat(d(c),[")"]),e=n):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s),e===s&&(e=vt,"pow"===t.substr(vt,3)?(n="pow",vt+=3):(n=s,0===xt&&Ot(tt)),n!==s?(40===t.charCodeAt(vt)?(r="(",vt++):(r=s,0===xt&&Ot(z)),r!==s&&Wt()!==s&&(o=_t())!==s&&Wt()!==s?(44===t.charCodeAt(vt)?(i=",",vt++):(i=s,0===xt&&Ot(l)),i!==s&&Wt()!==s&&(a=_t())!==s&&Wt()!==s?(41===t.charCodeAt(vt)?(u=")",vt++):(u=s,0===xt&&Ot(W)),u!==s?(gt=e,n=function(t,e,n){return["".concat(t,"(")].concat(d(e),[","],d(n),[")"])}(n,o,a),e=n):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s)):(vt=e,e=s)),e}())===s&&(e=Pt())===s&&(e=Rt())===s&&(e=vt,40===t.charCodeAt(vt)?(n="(",vt++):(n=s,0===xt&&Ot(z)),n!==s&&Wt()!==s&&(r=_t())!==s&&Wt()!==s?(41===t.charCodeAt(vt)?(o=")",vt++):(o=s,0===xt&&Ot(W)),o!==s?(gt=e,e=n=J(n,r,o)):(vt=e,e=s)):(vt=e,e=s),e===s&&(e=jt())),e}function Rt(){var e,n,r,o,i;return e=vt,45===t.charCodeAt(vt)?(n="-",vt++):(n=s,0===xt&&Ot(et)),n===s&&(n=null),n!==s&&Bt()!==s?(r=vt,nt.test(t.charAt(vt))?(o=t.charAt(vt),vt++):(o=s,0===xt&&Ot(rt)),o!==s&&(i=Bt())!==s?r=o=[o,i]:(vt=r,r=s),r===s&&(r=null),r!==s?(gt=e,e=n=parseFloat(St())):(vt=e,e=s)):(vt=e,e=s),e}function Lt(){var e,n,r,o;if(e=vt,ot.test(t.charAt(vt))?(n=t.charAt(vt),vt++):(n=s,0===xt&&Ot(it)),n!==s){for(r=[],at.test(t.charAt(vt))?(o=t.charAt(vt),vt++):(o=s,0===xt&&Ot(st));o!==s;)r.push(o),at.test(t.charAt(vt))?(o=t.charAt(vt),vt++):(o=s,0===xt&&Ot(st));r!==s?(gt=e,e=n=ut()):(vt=e,e=s)}else vt=e,e=s;return e}function Bt(){var e,n,r;if(e=vt,n=[],at.test(t.charAt(vt))?(r=t.charAt(vt),vt++):(r=s,0===xt&&Ot(st)),r!==s)for(;r!==s;)n.push(r),at.test(t.charAt(vt))?(r=t.charAt(vt),vt++):(r=s,0===xt&&Ot(st));else n=s;return n!==s&&(gt=e,n=ut()),e=n}function zt(){var e,n;return e=vt,"**"===t.substr(vt,2)?(n="**",vt+=2):(n=s,0===xt&&Ot(ct)),n!==s&&(gt=e,n="^"),(e=n)===s&&(42===t.charCodeAt(vt)?(e="*",vt++):(e=s,0===xt&&Ot(pt)),e===s&&(94===t.charCodeAt(vt)?(e="^",vt++):(e=s,0===xt&&Ot(lt)),e===s&&(37===t.charCodeAt(vt)?(e="%",vt++):(e=s,0===xt&&Ot(v)),e===s&&(47===t.charCodeAt(vt)?(e="/",vt++):(e=s,0===xt&&Ot(ft)),e===s&&(43===t.charCodeAt(vt)?(e="+",vt++):(e=s,0===xt&&Ot(ht)),e===s&&(45===t.charCodeAt(vt)?(e="-",vt++):(e=s,0===xt&&Ot(et)))))))),e}function Wt(){var e,n;for(xt++,e=[],dt.test(t.charAt(vt))?(n=t.charAt(vt),vt++):(n=s,0===xt&&Ot(yt));n!==s;)e.push(n),dt.test(t.charAt(vt))?(n=t.charAt(vt),vt++):(n=s,0===xt&&Ot(yt));return xt--,e===s&&(n=s,0===xt&&Ot(mt)),e}if((n=c())!==s&&vt===t.length)return n;throw n!==s&&vt<t.length&&Ot({type:"end"}),r=Nt,o=wt<t.length?t.charAt(wt):null,a=wt<t.length?At(wt,wt+1):At(wt,wt),new y(y.buildMessage(r,o),r,o,a)};Array.prototype.flat||(Array.prototype.flat=function(){var t=arguments[0];return(t=void 0===t?1:Math.floor(t))<1?Array.prototype.slice.call(this):function t(e,n){for(var r=e.length>>>0,o=[],i=0;i<r;){if(i in e){var a=e[i];Array.isArray(a)&&n>0?o=o.concat(t(a,n-1)):o.push(a)}i++}return o}(this,t)}),Array.prototype.flatMap||(Array.prototype.flatMap=function(){return Array.prototype.map.apply(this,arguments).flat(1)});var g,b,w,N,x,S,k,E,C,A,O,T,j,P=Object.freeze({isNumeric:function(t){return!Array.isArray(t)&&!Number.isNaN(t)&&Number.isFinite(parseInt(t,10))},isBase64:function(t){try{return!(!t||btoa(atob(t))!==t)}catch(t){return!1}},isJson:function(t){try{var n=!!t&&JSON.parse(t);return!(!n||"object"!==e(n))}catch(t){return!1}},generateNumber:function(t,e){return t=t?parseInt(t,10):1,(e=e?parseInt(e,10):t)<=t?t:Math.floor(Math.random()*(e-t+1)+t)},get sumArray(){var t=this;return function(e){return Array.isArray(e)?e.reduce((function(e,n){return e+(t.isNumeric(n)?parseFloat(n):0)}),0):0}},compareNumbers:function(t,e,n){var r;switch(t=parseFloat(t),e=parseFloat(e),n){case"=":case"==":r=t===e;break;case"<":r=t<e;break;case">":r=t>e;break;case"<=":r=t<=e;break;case">=":r=t>=e;break;case"!":case"!=":r=t!==e;break;default:r=!1}return r},toFixed:function(t,e){return parseFloat(parseFloat(t).toFixed(e||0))}}),M=Object.freeze({JSON:0,BASE_64:1,OBJECT:2}),I=function(){function t(e){if(n(this,t),!e)throw new Error("Notation is required");this.notation=e,this.order=999}return o(t,[{key:"run",value:function(t,e){return t}},{key:"toJSON",value:function(){var t=this.notation;return{name:this.name,notation:t,type:"modifier"}}},{key:"toString",value:function(){return this.notation}},{key:"name",get:function(){return this.constructor.name}}]),t}(),F=(T=Symbol("operator"),j=Symbol("value"),function(){function t(e,r){if(n(this,t),!e)throw new Error("ComparePoint: No compare operator specified");if(!r&&0!==r)throw new Error("ComparePoint: No compare value specified");this.operator=e,this.value=r}return o(t,[{key:"isMatch",value:function(t){return P.compareNumbers(t,this.value,this.operator)}},{key:"toJSON",value:function(){return{operator:this.operator,type:"compare-point",value:this.value}}},{key:"toString",value:function(){return"".concat(this.operator).concat(this.value)}},{key:"operator",set:function(t){if(!this.constructor.isValidOperator(t))throw new Error('ComparePoint: operator "'.concat(t,'" is not valid'));this[T]=t},get:function(){return this[T]}},{key:"value",set:function(t){if(!P.isNumeric(t))throw new Error("ComparePoint: value must be numeric");this[j]=parseInt(t,10)},get:function(){return this[j]}}],[{key:"isValidOperator",value:function(t){return"string"==typeof t&&/^(?:[<>!]?=|[<>])$/.test(t)}}]),t}()),_=(O=Symbol("compare-point"),function(t){function e(t,r){var o;return n(this,e),o=c(this,s(e).call(this,t)),r&&(o.comparePoint=r),o}return a(e,t),o(e,[{key:"isComparePoint",value:function(t){return this.comparePoint?this.comparePoint.isMatch(t):(console.warn("No Compare Point specified"),!1)}},{key:"toJSON",value:function(){var t=this.comparePoint;return Object.assign(l(s(e.prototype),"toJSON",this).call(this),{comparePoint:t})}},{key:"comparePoint",get:function(){return this[O]},set:function(t){if(!(t instanceof F))throw TypeError("comparePoint must be instance of ComparePoint");this[O]=t}}]),e}(I)),D=function(){var t=Symbol("calculation-value"),r=Symbol("modifiers"),i=Symbol("initial-value"),a=Symbol("use-in-total"),s=Symbol("value");return function(){function u(t,r){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n(this,u),P.isNumeric(t))this[i]=parseInt(t,10);else{if(!t||"object"!==e(t)||Array.isArray(t))throw new Error("Result value is invalid: ".concat(t));var a=P.isNumeric(t.initialValue)?t.initialValue:t.value;if(!P.isNumeric(a))throw new Error("Result value is invalid: ".concat(a));this[i]=parseInt(a,10),P.isNumeric(t.value)&&parseInt(t.value,10)!==this[i]&&(this.value=t.value),P.isNumeric(t.calculationValue)&&parseFloat(t.calculationValue)!==this.value&&(this.calculationValue=t.calculationValue),Array.isArray(t.modifiers)&&t.modifiers.length&&(r=t.modifiers),"boolean"==typeof t.useInTotal&&(o=t.useInTotal)}this.modifiers=r||[],this.useInTotal=o}return o(u,[{key:"toJSON",value:function(){return{calculationValue:this.calculationValue,initialValue:this.initialValue,modifierFlags:this.modifierFlags,modifiers:this.modifiers,type:"result",useInTotal:this.useInTotal,value:this.value}}},{key:"toString",value:function(){return this.value+this.modifierFlags}},{key:"calculationValue",get:function(){return P.isNumeric(this[t])?parseFloat(this[t]):this.value},set:function(e){var n=P.isNumeric(e);if(e&&!n)throw new Error("Result calculation value is invalid: ".concat(e));this[t]=n?parseFloat(e):null}},{key:"initialValue",get:function(){return this[i]}},{key:"modifierFlags",get:function(){return this.modifiers.reduce((function(t,e){switch(e){case"compound":case"explode":e="!";break;case"critical-failure":e="__";break;case"critical-success":e="**";break;case"drop":e="d";break;case"penetrate":e="p";break;case"re-roll":e="r";break;case"re-roll-once":e="ro";break;case"target-failure":e="_";break;case"target-success":e="*"}return t+e}),"")}},{key:"modifiers",get:function(){return this[r]||[]},set:function(t){if((t||0===t)&&(!Array.isArray(t)||t.some((function(t){return"string"!=typeof t}))))throw new Error("Modifiers must be an array of modifier names: ".concat(t));this[r]=t||[]}},{key:"useInTotal",get:function(){return!!this[a]},set:function(t){this[a]=!!t}},{key:"value",get:function(){return P.isNumeric(this[s])?this[s]:this[i]},set:function(t){if(!P.isNumeric(t))throw new Error("Result value is invalid: ".concat(t));this[s]=parseInt(t,10)}}]),u}()}(),R=(C=Symbol("compound"),A=Symbol("penetrate"),function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n(this,e),(r=c(this,s(e).call(this,t,o)))[C]=!!i,r[A]=!!a,r.order=1,r}return a(e,t),o(e,[{key:"run",value:function(t,e){var n=this;if(e.min===e.max)throw new Error("Die must have more than 1 side to explode: ".concat(e));return t.rolls=t.rolls.map((function(t){for(var r=[t],o=t.value;n.isComparePoint(o);){var i=r[r.length-1],a=e.rollOnce();o=a.value,i.modifiers.push("explode"),n.penetrate&&(i.modifiers.push("penetrate"),a.value--),r.push(a)}return n.compound&&r.length>1?(t.value=P.sumArray(r),t.modifiers=["explode","compound"],n.penetrate&&t.modifiers.push("penetrate"),t):r})).flat(),t}},{key:"toJSON",value:function(){var t=this.compound,n=this.penetrate;return Object.assign(l(s(e.prototype),"toJSON",this).call(this),{compound:t,penetrate:n})}},{key:"compound",get:function(){return this[C]}},{key:"penetrate",get:function(){return this[A]}}]),e}(_)),L=(E=Symbol("rolls"),function(){function t(e){n(this,t),this.rolls=e||[]}return o(t,[{key:"addRoll",value:function(t){var e=t instanceof D?t:new D(t);this[E].push(e)}},{key:"toJSON",value:function(){return{rolls:this.rolls,value:this.value}}},{key:"toString",value:function(){return"[".concat(this.rolls.join(", "),"]")}},{key:"length",get:function(){return this.rolls.length||0}},{key:"rolls",get:function(){return d(this[E]||[])},set:function(t){var e=this;if(!t||!Array.isArray(t))throw new Error("Rolls must be an array: ".concat(t));this[E]=[],t.forEach((function(t){e.addRoll(t)}))}},{key:"value",get:function(){return this.rolls.reduce((function(t,e){return t+(e.useInTotal?e.calculationValue:0)}),0)}}]),t}()),B=(k=Symbol("once"),function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n(this,e),(r=c(this,s(e).call(this,t,i))).once=!!o,r.order=2,r}return a(e,t),o(e,[{key:"run",value:function(t,e){var n=this;if(e.min===e.max)throw new Error("Die must have more than 1 side to re-roll: ".concat(e));return t.rolls.map((function(t){for(var r=!1;n.isComparePoint(t.value)&&(!n.once||!r);){var o=e.rollOnce();t.value=o.value,r=!0}return r&&t.modifiers.push("re-roll".concat(n.once?"-once":"")),t})),t}},{key:"toJSON",value:function(){var t=this.once;return Object.assign(l(s(e.prototype),"toJSON",this).call(this),{once:t})}},{key:"once",get:function(){return!!this[k]},set:function(t){this[k]=!!t}}]),e}(_)),W=(w=Symbol("modifiers"),N=Symbol("notation"),x=Symbol("qty"),S=Symbol("sides"),function(){function t(r,o){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n(this,t),!r)throw new TypeError("Dice: Notation is required");if(!o)throw new TypeError("Dice: sides is required");if(!P.isNumeric(a)||a<1)throw new TypeError("qty must be a positive integer");if(this[N]=r,this[x]=parseInt(a,10),this[S]=o,s){if(s instanceof Map)this[w]=s;else if(Array.isArray(s))this[w]=new Map(s.map((function(t){return[t.name,t]})));else{if("object"!==e(s))throw new Error("modifiers should be a Map or an Object");this[w]=new Map(Object.entries(s))}if(this[w].size&&d(this[w].entries()).some((function(t){return!(t[1]instanceof I)})))throw new Error("modifiers is invalid. List must only contain Modifier instances");this[w].forEach((function(t){t instanceof R&&!t.comparePoint?t.comparePoint=new F("=",i.max):t instanceof B&&!t.comparePoint&&(t.comparePoint=new F("=",i.min))}))}}return o(t,[{key:"roll",value:function(){for(var t=this,e=new L,n=0;n<this.qty;n++)e.addRoll(this.rollOnce());return(this.modifiers||[]).forEach((function(n){n.run(e,t)})),e}},{key:"rollOnce",value:function(){return new D(P.generateNumber(this.min,this.max))}},{key:"toJSON",value:function(){return{max:this.max,min:this.min,modifiers:this.modifiers,name:this.name,notation:this.notation,qty:this.qty,sides:this.sides,type:"die"}}},{key:"toString",value:function(){return this.notation}},{key:"modifiers",get:function(){return this[w]?new Map(d(this[w]).sort((function(t,e){return t[1].order-e[1].order}))):null}},{key:"max",get:function(){return this.sides}},{key:"min",get:function(){return 1}},{key:"name",get:function(){return this.constructor.name}},{key:"notation",get:function(){return this[N]}},{key:"qty",get:function(){return this[x]}},{key:"sides",get:function(){return this[S]}}]),t}()),J=function(t){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n(this,e),r||0===r){if(1!==r&&2!==r)throw new Error("nonBlanks must be 1 or 2")}else r=2;return c(this,s(e).call(this,t,parseInt(r,10),o,i))}return a(e,t),o(e,[{key:"rollOnce",value:function(){var t=0;if(2===this.nonBlanks)t=P.generateNumber(1,3)-2;else if(1===this.nonBlanks){var e=P.generateNumber(1,6);1===e?t=-1:6===e&&(t=1)}return new D(t)}},{key:"max",get:function(){return 1}},{key:"min",get:function(){return-1}},{key:"nonBlanks",get:function(){return l(s(e.prototype),"sides",this)}},{key:"sides",get:function(){return"F.".concat(this.nonBlanks)}}]),e}(W),q=function(t){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n(this,e),c(this,s(e).call(this,t,100,r,o))}return a(e,t),o(e,[{key:"max",get:function(){return 100}},{key:"sides",get:function(){return"%"}}]),e}(W),H=Object.freeze({__proto__:null,FudgeDice:J,PercentileDice:q,StandardDice:W}),U=function(t){function e(t,r){var o;return n(this,e),(o=c(this,s(e).call(this,t,r))).order=7,o}return a(e,t),o(e,[{key:"run",value:function(t,e){var n=this;return t.rolls.map((function(t){return n.isComparePoint(t.value)&&t.modifiers.push("critical-failure"),t})),t}}]),e}(_),$=function(t){function e(t,r){var o;return n(this,e),(o=c(this,s(e).call(this,t,r))).order=6,o}return a(e,t),o(e,[{key:"run",value:function(t,e){var n=this;return t.rolls.map((function(t){return n.isComparePoint(t.value)&&t.modifiers.push("critical-success"),t})),t}}]),e}(_),G=function(){var t=Symbol("end"),e=Symbol("qty");return function(r){function i(t,e,r){var o;return n(this,i),(o=c(this,s(i).call(this,t))).end=e,o.qty=r||0===r?r:1,o.order=3,o}return a(i,r),o(i,[{key:"_rangeToDrop",value:function(t){return[this.qty,t.length]}},{key:"run",value:function(t,e){var n,r=this;return(n=d(t.rolls).map((function(t,e){return{value:t.value,index:e}})).sort((function(t,e){return"h"===r.end?e.value-t.value:t.value-e.value})).map((function(t){return t.index}))).slice.apply(n,d(this._rangeToDrop(t))).forEach((function(e){var n=t.rolls[e];n.modifiers.push("drop"),n.useInTotal=!1})),t}},{key:"toJSON",value:function(){var t=this.end,e=this.qty;return Object.assign(l(s(i.prototype),"toJSON",this).call(this),{end:t,qty:e})}},{key:"end",get:function(){return this[t]},set:function(e){if("h"!==e&&"l"!==e)throw new Error('End must be "h" or "l"');this[t]=e}},{key:"qty",get:function(){return this[e]},set:function(t){if(!P.isNumeric(t)||t<1)throw new Error("qty must be a positive integer");this[e]=parseInt(t,10)}}]),i}(I)}(),V=function(t){function e(t,r,o){var i;return n(this,e),(i=c(this,s(e).call(this,t,r,o))).order=4,i}return a(e,t),o(e,[{key:"_rangeToDrop",value:function(t){return[0,this.qty]}}]),e}(G),K=(b=Symbol("direction"),function(t){function e(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a";return n(this,e),(r=c(this,s(e).call(this,t))).direction=o||"a",r.order=8,r}return a(e,t),o(e,[{key:"run",value:function(t,e){var n=this;return t.rolls=t.rolls.sort((function(t,e){return"d"===n.direction?e.value-t.value:t.value-e.value})),t}},{key:"toJSON",value:function(){var t=this.direction;return Object.assign(l(s(e.prototype),"toJSON",this).call(this),{direction:t})}},{key:"direction",get:function(){return this[b]},set:function(t){if("a"!==t&&"d"!==t)throw new Error('Direction must be "a" (Ascending) or "d" (Descending)');this[b]=t}}]),e}(I)),Z=(g=Symbol("failure-cp"),function(t){function e(t,r,o){var i;return n(this,e),(i=c(this,s(e).call(this,t,r))).failureComparePoint=o,i.order=5,i}return a(e,t),o(e,[{key:"getStateValue",value:function(t){return this.isSuccess(t)?1:this.isFailure(t)?-1:0}},{key:"isFailure",value:function(t){return!!this.failureComparePoint&&this.failureComparePoint.isMatch(t)}},{key:"isNeutral",value:function(t){return!this.isSuccess(t)&&!this.isFailure(t)}},{key:"isSuccess",value:function(t){return this.isComparePoint(t)}},{key:"run",value:function(t,e){var n=this;return t.rolls.map((function(t){return n.isSuccess(t.value)?t.modifiers.push("target-success"):n.isFailure(t)&&t.modifiers.push("target-failure"),t.calculationValue=n.getStateValue(t.value),t})),t}},{key:"toJSON",value:function(){var t=this.failureComparePoint,n=this.successComparePoint,r=l(s(e.prototype),"toJSON",this).call(this);return delete r.comparePoint,Object.assign(r,{failureComparePoint:t,successComparePoint:n})}},{key:"failureComparePoint",get:function(){return this[g]},set:function(t){if(t&&!(t instanceof F))throw TypeError("failure comparePoint must be instance of ComparePoint or null");this[g]=t||null}},{key:"successComparePoint",get:function(){return this.comparePoint},set:function(t){h(s(e.prototype),"comparePoint",t,this,!0)}}]),e}(_)),Y=Object.freeze({__proto__:null,ComparisonModifier:_,CriticalFailureModifier:U,CriticalSuccessModifier:$,DropModifier:V,ExplodeModifier:R,KeepModifier:G,ReRollModifier:B,SortingModifier:K,TargetModifier:Z}),X=function(){var t=Symbol("modifiers"),e=Symbol("notation"),r=Symbol("expressions");return function(){function i(o,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,i),this[e]=o,this[r]=a,this[t]=s}return o(i,[{key:"toJSON",value:function(){var t=this.modifiers,e=this.notation;return{expressions:this.expressions,modifiers:t,notation:e,type:"group"}}},{key:"modifiers",get:function(){return this[t]}},{key:"notation",get:function(){return this[e]}},{key:"expressions",get:function(){return this[r]}}]),i}()}();function Q(t,e){return t(e={exports:{}},e.exports),e.exports}Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isNaN=Number.isNaN||function(t){return t!=t},"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==z||"undefined"!=typeof self&&self;var tt=function(t){return t&&t.constructor.prototype.isBigNumber||!1},et=Q((function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.clone=function t(r){var o=n(r);if("number"===o||"string"===o||"boolean"===o||null==r)return r;if("function"==typeof r.clone)return r.clone();if(Array.isArray(r))return r.map((function(e){return t(e)}));if(r instanceof Date)return new Date(r.valueOf());if(tt(r))return r;if(r instanceof RegExp)throw new TypeError("Cannot clone "+r);return e.map(r,t)},e.map=function(t,n){var r={};for(var o in t)e.hasOwnProperty(t,o)&&(r[o]=n(t[o]));return r},e.extend=function(t,n){for(var r in n)e.hasOwnProperty(n,r)&&(t[r]=n[r]);return t},e.deepExtend=function t(n,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var o in r)if(e.hasOwnProperty(r,o))if(r[o]&&r[o].constructor===Object)void 0===n[o]&&(n[o]={}),n[o].constructor===Object?t(n[o],r[o]):n[o]=r[o];else{if(Array.isArray(r[o]))throw new TypeError("Arrays are not supported by deepExtend");n[o]=r[o]}return n},e.deepEqual=function(t,n){var r,o,i;if(Array.isArray(t)){if(!Array.isArray(n))return!1;if(t.length!==n.length)return!1;for(o=0,i=t.length;o<i;o++)if(!e.deepEqual(t[o],n[o]))return!1;return!0}if(t instanceof Object){if(Array.isArray(n)||!(n instanceof Object))return!1;for(r in t)if(!e.deepEqual(t[r],n[r]))return!1;for(r in n)if(!e.deepEqual(t[r],n[r]))return!1;return!0}return t===n},e.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(t){}return!1},e.lazy=function(t,n,r){if(e.canDefineProperty()){var o,i=!0;Object.defineProperty(t,n,{get:function(){return i&&(o=r(),i=!1),o},set:function(t){o=t,i=!1},configurable:!0,enumerable:!0})}else t[n]=r()},e.traverse=function(t,e){var n=t;if(e)for(var r=e.split("."),o=0;o<r.length;o++){var i=r[o];i in n||(n[i]={}),n=n[i]}return n},e.hasOwnProperty=function(t,e){return t&&Object.hasOwnProperty.call(t,e)},e.isFactory=function(t){return t&&"function"==typeof t.factory}})),nt=(et.clone,et.map,et.extend,et.deepExtend,et.deepEqual,et.canDefineProperty,et.lazy,et.traverse,et.isFactory,Q((function(t,e){t.exports=function(){function t(){return!0}function e(){return!1}function n(){}return function r(){var o=[{name:"number",test:function(t){return"number"==typeof t}},{name:"string",test:function(t){return"string"==typeof t}},{name:"boolean",test:function(t){return"boolean"==typeof t}},{name:"Function",test:function(t){return"function"==typeof t}},{name:"Array",test:Array.isArray},{name:"Date",test:function(t){return t instanceof Date}},{name:"RegExp",test:function(t){return t instanceof RegExp}},{name:"Object",test:function(t){return"object"==typeof t&&t.constructor===Object}},{name:"null",test:function(t){return null===t}},{name:"undefined",test:function(t){return void 0===t}}],i={name:"any",test:t},a=[],s=[],u={types:o,conversions:s,ignore:a};function c(t){var e=z(u.types,(function(e){return e.name===t}));if(e)return e;if("any"===t)return i;var n=z(u.types,(function(e){return e.name.toLowerCase()===t.toLowerCase()}));throw new TypeError('Unknown type "'+t+'"'+(n?'. Did you mean "'+n.name+'"?':""))}function p(t){return t===i?999:u.types.indexOf(t)}function l(t){var e=z(u.types,(function(e){return e.test(t)}));if(e)return e.name;throw new TypeError("Value has unknown type. Value: "+t)}function f(t){return t.map((function(t){var e=t.types.map(w);return(t.restParam?"...":"")+e.join("|")})).join(",")}function h(t,e){var n=0===t.indexOf("..."),r=(n?t.length>3?t.slice(3):"any":t).split("|").map(M).filter(I).filter(P),o=function(t,e){var n={};return t.forEach((function(t){-1!==e.indexOf(t.from)||-1===e.indexOf(t.to)||n[t.from]||(n[t.from]=t)})),Object.keys(n).map((function(t){return n[t]}))}(e,r),i=r.map((function(t){var e=c(t);return{name:t,typeIndex:p(e),test:e.test,conversion:null,conversionIndex:-1}})),a=o.map((function(t){var n=c(t.from);return{name:t.from,typeIndex:p(n),test:n.test,conversion:t,conversionIndex:e.indexOf(t)}}));return{types:i.concat(a),restParam:n}}function m(t){var e=D(t);return!!e&&e.restParam}function d(t){return t.types.some((function(t){return null!=t.conversion}))}function y(e){if(e&&0!==e.types.length){if(1===e.types.length)return c(e.types[0].name).test;if(2===e.types.length){var n=c(e.types[0].name).test,r=c(e.types[1].name).test;return function(t){return n(t)||r(t)}}var o=e.types.map((function(t){return c(t.name).test}));return function(t){for(var e=0;e<o.length;e++)if(o[e](t))return!0;return!1}}return t}function v(t){var e,n,r,o;if(m(t)){var i=(e=(o=t,o.slice(0,o.length-1)).map(y)).length,a=y(D(t));return function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return function(t){for(var e=i;e<t.length;e++)if(!a(t[e]))return!1;return!0}(t)&&t.length>=i+1}}return 0===t.length?function(t){return 0===t.length}:1===t.length?(n=y(t[0]),function(t){return n(t[0])&&1===t.length}):2===t.length?(n=y(t[0]),r=y(t[1]),function(t){return n(t[0])&&r(t[1])&&2===t.length}):(e=t.map(y),function(t){for(var n=0;n<e.length;n++)if(!e[n](t[n]))return!1;return t.length===e.length})}function g(t,e){return e<t.params.length?t.params[e]:m(t.params)?D(t.params):null}function b(t,e,n){var r=g(t,e);return(r?n?r.types.filter(N):r.types:[]).map(w)}function w(t){return t.name}function N(t){return null===t.conversion||void 0===t.conversion}function x(t,e){var n=function(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return Object.keys(e)}(W(t,(function(t){return b(t,e,!1)})));return-1!==n.indexOf("any")?["any"]:n}function S(t,e,n){var r,o,i,a=t||"unnamed",s=n;for(i=0;i<e.length;i++){var u=s.filter((function(t){var n=y(g(t,i));return(i<t.params.length||m(t.params))&&n(e[i])}));if(0===u.length){if((o=x(s,i)).length>0){var c=l(e[i]);return(r=new TypeError("Unexpected type of argument in function "+a+" (expected: "+o.join(" or ")+", actual: "+c+", index: "+i+")")).data={category:"wrongType",fn:a,index:i,actual:c,expected:o},r}}else s=u}var p=s.map((function(t){return m(t.params)?1/0:t.params.length}));if(e.length<Math.min.apply(null,p))return o=x(s,i),(r=new TypeError("Too few arguments in function "+a+" (expected: "+o.join(" or ")+", index: "+e.length+")")).data={category:"tooFewArgs",fn:a,index:e.length,expected:o},r;var f=Math.max.apply(null,p);return e.length>f?((r=new TypeError("Too many arguments in function "+a+" (expected: "+f+", actual: "+e.length+")")).data={category:"tooManyArgs",fn:a,index:e.length,expectedLength:f},r):((r=new TypeError('Arguments of type "'+e.join(", ")+'" do not match any of the defined signatures of function '+a+".")).data={category:"mismatch",actual:e.map(l)},r)}function k(t){for(var e=999,n=0;n<t.types.length;n++)N(t.types[n])&&(e=Math.min(e,t.types[n].typeIndex));return e}function E(t){for(var e=999,n=0;n<t.types.length;n++)N(t.types[n])||(e=Math.min(e,t.types[n].conversionIndex));return e}function C(t,e){var n;return 0!=(n=t.restParam-e.restParam)||0!=(n=d(t)-d(e))||0!=(n=k(t)-k(e))?n:E(t)-E(e)}function A(t,e){var n,r,o=Math.min(t.params.length,e.params.length);if(0!=(r=t.params.some(d)-e.params.some(d)))return r;for(n=0;n<o;n++)if(0!=(r=d(t.params[n])-d(e.params[n])))return r;for(n=0;n<o;n++)if(0!==(r=C(t.params[n],e.params[n])))return r;return t.params.length-e.params.length}function O(t){var e,n,r,o,i=[],a=[];switch(t.types.forEach((function(t){t.conversion&&(i.push(c(t.conversion.from).test),a.push(t.conversion.convert))})),a.length){case 0:return function(t){return t};case 1:return e=i[0],r=a[0],function(t){return e(t)?r(t):t};case 2:return e=i[0],n=i[1],r=a[0],o=a[1],function(t){return e(t)?r(t):n(t)?o(t):t};default:return function(t){for(var e=0;e<a.length;e++)if(i[e](t))return a[e](t);return t}}}function T(t,e){return function t(n,r,o){if(r<n.length){var i,a=n[r],s=e?a.types.filter(N):a.types;if(a.restParam){var u=s.filter(N);i=u.length<s.length?[u,s]:[s]}else i=s.map((function(t){return[t]}));return W(i,(function(e){return t(n,r+1,o.concat([e]))}))}return[o.map((function(t,e){return{types:t,restParam:e===n.length-1&&m(n)}}))]}(t,0,[])}function j(t,r){if(0===Object.keys(r).length)throw new SyntaxError("No signatures provided");var o=[];Object.keys(r).map((function(t){return function(t,e,n){var r=[];return""!==t.trim()&&(r=t.split(",").map(M).map((function(t,e,r){var o=h(t,n);if(o.restParam&&e!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+t+'": only allowed for the last parameter');return o}))),r.some(_)?null:{params:r,fn:e}}(t,r[t],u.conversions)})).filter(F).forEach((function(t){var e=z(o,(function(e){return function(t,e){for(var n=Math.max(t.params.length,e.params.length),r=0;r<n;r++)if(!B(b(t,r,!0),b(e,r,!0)))return!1;var o=t.params.length,i=e.params.length,a=m(t.params),s=m(e.params);return a?s?o===i:i>=o:s?o>=i:o===i}(e,t)}));if(e)throw new TypeError('Conflicting signatures "'+f(e.params)+'" and "'+f(t.params)+'".');o.push(t)}));var i=W(o,(function(t){return(t?T(t.params,!1):[]).map((function(e){return{params:e,fn:t.fn}}))})).filter(F);i.sort(A);var a=i[0]&&i[0].params.length<=2&&!m(i[0].params),s=i[1]&&i[1].params.length<=2&&!m(i[1].params),c=i[2]&&i[2].params.length<=2&&!m(i[2].params),p=i[3]&&i[3].params.length<=2&&!m(i[3].params),l=i[4]&&i[4].params.length<=2&&!m(i[4].params),g=i[5]&&i[5].params.length<=2&&!m(i[5].params),w=a&&s&&c&&p&&l&&g,N=i.map((function(t){return v(t.params)})),x=a?y(i[0].params[0]):e,k=s?y(i[1].params[0]):e,E=c?y(i[2].params[0]):e,C=p?y(i[3].params[0]):e,j=l?y(i[4].params[0]):e,P=g?y(i[5].params[0]):e,I=a?y(i[0].params[1]):e,D=s?y(i[1].params[1]):e,L=c?y(i[2].params[1]):e,J=p?y(i[3].params[1]):e,q=l?y(i[4].params[1]):e,H=g?y(i[5].params[1]):e,U=i.map((function(t){return function(t,e){var n=e;if(t.some(d)){var r=m(t),o=t.map(O);n=function(){for(var t=[],n=r?arguments.length-1:arguments.length,i=0;i<n;i++)t[i]=o[i](arguments[i]);return r&&(t[n]=arguments[n].map(o[n])),e.apply(null,t)}}var i=n;if(m(t)){var a=t.length-1;i=function(){return n.apply(null,R(arguments,0,a).concat([R(arguments,a)]))}}return i}(t.params,t.fn)})),$=a?U[0]:n,G=s?U[1]:n,V=c?U[2]:n,K=p?U[3]:n,Z=l?U[4]:n,Y=g?U[5]:n,X=a?i[0].params.length:-1,Q=s?i[1].params.length:-1,tt=c?i[2].params.length:-1,et=p?i[3].params.length:-1,nt=l?i[4].params.length:-1,rt=g?i[5].params.length:-1,ot=w?6:0,it=i.length,at=function(){for(var e=ot;e<it;e++)if(N[e](arguments))return U[e].apply(null,arguments);throw S(t,arguments,i)},st=function(t,e){return arguments.length===X&&x(t)&&I(e)?$.apply(null,arguments):arguments.length===Q&&k(t)&&D(e)?G.apply(null,arguments):arguments.length===tt&&E(t)&&L(e)?V.apply(null,arguments):arguments.length===et&&C(t)&&J(e)?K.apply(null,arguments):arguments.length===nt&&j(t)&&q(e)?Z.apply(null,arguments):arguments.length===rt&&P(t)&&H(e)?Y.apply(null,arguments):at.apply(null,arguments)};try{Object.defineProperty(st,"name",{value:t})}catch(t){}return st.signatures=function(t){var e={};return t.forEach((function(t){t.params.some(d)||T(t.params,!0).forEach((function(n){e[f(n)]=t.fn}))})),e}(i),st}function P(t){return-1===u.ignore.indexOf(t)}function M(t){return t.trim()}function I(t){return!!t}function F(t){return null!==t}function _(t){return 0===t.types.length}function D(t){return t[t.length-1]}function R(t,e,n){return Array.prototype.slice.call(t,e,n)}function L(t,e){return-1!==t.indexOf(e)}function B(t,e){for(var n=0;n<t.length;n++)if(L(e,t[n]))return!0;return!1}function z(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return t[n]}function W(t,e){return Array.prototype.concat.apply([],t.map(e))}function J(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(("object"==typeof r.signatures||"string"==typeof r.signature)&&""!==r.name)if(""===e)e=r.name;else if(e!==r.name){var o=new Error("Function names do not match (expected: "+e+", actual: "+r.name+")");throw o.data={actual:r.name,expected:e},o}}return e}function q(t){var e,n={};function r(t,r){if(n.hasOwnProperty(t)&&r!==n[t])throw(e=new Error('Signature "'+t+'" is defined twice')).data={signature:t},e}for(var o=0;o<t.length;o++){var i=t[o];if("object"==typeof i.signatures)for(var a in i.signatures)i.signatures.hasOwnProperty(a)&&(r(a,i.signatures[a]),n[a]=i.signatures[a]);else{if("string"!=typeof i.signature)throw(e=new TypeError("Function is no typed-function (index: "+o+")")).data={index:o},e;r(i.signature,i),n[i.signature]=i}}return n}return(u=j("typed",{"string, Object":j,Object:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return j(J(e),t)},"...Function":function(t){return j(J(t),q(t))},"string, ...Function":function(t,e){return j(t,q(e))}})).create=r,u.types=o,u.conversions=s,u.ignore=a,u.convert=function(t,e){var n=l(t);if(e===n)return t;for(var r=0;r<u.conversions.length;r++){var o=u.conversions[r];if(o.from===n&&o.to===e)return o.convert(t)}throw new Error("Cannot convert from "+n+" to "+e)},u.find=function(t,e){if(!t.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof e){n=e.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(e))throw new TypeError("String array or a comma separated string expected");n=e}var o=n.join(","),i=t.signatures[o];if(i)return i;throw new TypeError("Signature not found (signature: "+(t.name||"unnamed")+"("+n.join(", ")+"))")},u.addType=function(t,e){if(!t||"string"!=typeof t.name||"function"!=typeof t.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==e)for(var n=0;n<u.types.length;n++)if("Object"===u.types[n].name)return void u.types.splice(n,0,t);u.types.push(t)},u.addConversion=function(t){if(!t||"string"!=typeof t.from||"string"!=typeof t.to||"function"!=typeof t.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");u.conversions.push(t)},u}()}()}))),rt=Q((function(t,e){function n(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}e.isNumber=function(t){return"number"==typeof t},e.isInteger=function(t){return"boolean"==typeof t||!!isFinite(t)&&t===Math.round(t)},e.sign=Math.sign||function(t){return t>0?1:t<0?-1:0},e.format=function(t,n){if("function"==typeof n)return n(t);if(t===1/0)return"Infinity";if(t===-1/0)return"-Infinity";if(isNaN(t))return"NaN";var r,o="auto";switch(n&&(n.notation&&(o=n.notation),e.isNumber(n)?r=n:e.isNumber(n.precision)&&(r=n.precision)),o){case"fixed":return e.toFixed(t,r);case"exponential":return e.toExponential(t,r);case"engineering":return e.toEngineering(t,r);case"auto":if(n&&n.exponential&&(void 0!==n.exponential.lower||void 0!==n.exponential.upper)){var i=et.map(n,(function(t){return t}));return i.exponential=void 0,void 0!==n.exponential.lower&&(i.lowerExp=Math.round(Math.log(n.exponential.lower)/Math.LN10)),void 0!==n.exponential.upper&&(i.upperExp=Math.round(Math.log(n.exponential.upper)/Math.LN10)),console.warn("Deprecation warning: Formatting options exponential.lower and exponential.upper (minimum and maximum value) are replaced with exponential.lowerExp and exponential.upperExp (minimum and maximum exponent) since version 4.0.0. Replace "+JSON.stringify(n)+" with "+JSON.stringify(i)),e.toPrecision(t,r,i)}return e.toPrecision(t,r,n&&n).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+o+'". Choose "auto", "exponential", or "fixed".')}},e.splitNumber=function(t){var e=String(t).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+t);var n=e[1],r=e[2],o=parseFloat(e[4]||"0"),i=r.indexOf(".");o+=-1!==i?i-1:r.length-1;var a=r.replace(".","").replace(/^0*/,(function(t){return o-=t.length,""})).replace(/0*$/,"").split("").map((function(t){return parseInt(t)}));return 0===a.length&&(a.push(0),o++),{sign:n,coefficients:a,exponent:o}},e.toEngineering=function(t,r){if(isNaN(t)||!isFinite(t))return String(t);var o=e.roundDigits(e.splitNumber(t),r),i=o.exponent,a=o.coefficients,s=i%3==0?i:i<0?i-3-i%3:i-i%3;if(e.isNumber(r))r>a.length&&(a=a.concat(n(r-a.length)));else{var u=i>=0?i:Math.abs(s);a.length-1<u&&(a=a.concat(n(u-(a.length-1))))}for(var c=Math.abs(i-s),p=1;--c>=0;)p++;var l=a.slice(p).join(""),f=e.isNumber(r)&&l.length||l.match(/[1-9]/)?"."+l:"",h=a.slice(0,p).join("")+f+"e"+(i>=0?"+":"")+s.toString();return o.sign+h},e.toFixed=function(t,r){if(isNaN(t)||!isFinite(t))return String(t);var o=e.splitNumber(t),i="number"==typeof r?e.roundDigits(o,o.exponent+1+r):o,a=i.coefficients,s=i.exponent+1,u=s+(r||0);return a.length<u&&(a=a.concat(n(u-a.length))),s<0&&(a=n(1-s).concat(a),s=1),s<a.length&&a.splice(s,0,0===s?"0.":"."),i.sign+a.join("")},e.toExponential=function(t,r){if(isNaN(t)||!isFinite(t))return String(t);var o=e.splitNumber(t),i=r?e.roundDigits(o,r):o,a=i.coefficients,s=i.exponent;a.length<r&&(a=a.concat(n(r-a.length)));var u=a.shift();return i.sign+u+(a.length>0?"."+a.join(""):"")+"e"+(s>=0?"+":"")+s},e.toPrecision=function(t,r,o){if(isNaN(t)||!isFinite(t))return String(t);var i=o&&void 0!==o.lowerExp?o.lowerExp:-3,a=o&&void 0!==o.upperExp?o.upperExp:5,s=e.splitNumber(t);if(s.exponent<i||s.exponent>=a)return e.toExponential(t,r);var u=r?e.roundDigits(s,r):s,c=u.coefficients,p=u.exponent;c.length<r&&(c=c.concat(n(r-c.length))),c=c.concat(n(p-c.length+1+(c.length<r?r-c.length:0)));var l=p>0?p:0;return l<(c=n(-p).concat(c)).length-1&&c.splice(l+1,0,"."),u.sign+c.join("")},e.roundDigits=function(t,e){for(var n={sign:t.sign,coefficients:t.coefficients,exponent:t.exponent},r=n.coefficients;e<=0;)r.unshift(0),n.exponent++,e++;if(r.length>e&&r.splice(e,r.length-e)[0]>=5){var o=e-1;for(r[o]++;10===r[o];)r.pop(),0===o&&(r.unshift(0),n.exponent++,o++),r[--o]++}return n},e.digits=function(t){return t.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},e.DBL_EPSILON=Number.EPSILON||2220446049250313e-31,e.nearlyEqual=function(t,n,r){if(null==r)return t===n;if(t===n)return!0;if(isNaN(t)||isNaN(n))return!1;if(isFinite(t)&&isFinite(n)){var o=Math.abs(t-n);return o<e.DBL_EPSILON||o<=Math.max(Math.abs(t),Math.abs(n))*r}return!1}}));rt.isNumber,rt.isInteger,rt.sign,rt.format,rt.splitNumber,rt.toEngineering,rt.toFixed,rt.toExponential,rt.toPrecision,rt.roundDigits,rt.digits,rt.DBL_EPSILON,rt.nearlyEqual;function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var it=rt.digits,at=function(){return at=nt.create,nt},st=function(t){t.isNumber=function(t){return"number"==typeof t},t.isComplex=function(e){return t.Complex&&e instanceof t.Complex||!1},t.isBigNumber=tt,t.isFraction=function(e){return t.Fraction&&e instanceof t.Fraction||!1},t.isUnit=function(t){return t&&t.constructor.prototype.isUnit||!1},t.isString=function(t){return"string"==typeof t},t.isArray=Array.isArray,t.isMatrix=(rt.isNumber,rt.isInteger,rt.sign,rt.format,rt.splitNumber,rt.toEngineering,rt.toFixed,rt.toExponential,rt.toPrecision,rt.roundDigits,rt.digits,rt.DBL_EPSILON,rt.nearlyEqual,function(t){return t&&t.constructor.prototype.isMatrix||!1}),t.isDenseMatrix=function(t){return t&&t.isDenseMatrix&&t.constructor.prototype.isMatrix||!1},t.isSparseMatrix=function(t){return t&&t.isSparseMatrix&&t.constructor.prototype.isMatrix||!1},t.isRange=function(t){return t&&t.constructor.prototype.isRange||!1},t.isIndex=function(t){return t&&t.constructor.prototype.isIndex||!1},t.isBoolean=function(t){return"boolean"==typeof t},t.isResultSet=function(t){return t&&t.constructor.prototype.isResultSet||!1},t.isHelp=function(t){return t&&t.constructor.prototype.isHelp||!1},t.isFunction=function(t){return"function"==typeof t},t.isDate=function(t){return t instanceof Date},t.isRegExp=function(t){return t instanceof RegExp},t.isObject=function(e){return"object"===ot(e)&&e.constructor===Object&&!t.isComplex(e)&&!t.isFraction(e)},t.isNull=function(t){return null===t},t.isUndefined=function(t){return void 0===t},t.isAccessorNode=function(t){return t&&t.isAccessorNode&&t.constructor.prototype.isNode||!1},t.isArrayNode=function(t){return t&&t.isArrayNode&&t.constructor.prototype.isNode||!1},t.isAssignmentNode=function(t){return t&&t.isAssignmentNode&&t.constructor.prototype.isNode||!1},t.isBlockNode=function(t){return t&&t.isBlockNode&&t.constructor.prototype.isNode||!1},t.isConditionalNode=function(t){return t&&t.isConditionalNode&&t.constructor.prototype.isNode||!1},t.isConstantNode=function(t){return t&&t.isConstantNode&&t.constructor.prototype.isNode||!1},t.isFunctionAssignmentNode=function(t){return t&&t.isFunctionAssignmentNode&&t.constructor.prototype.isNode||!1},t.isFunctionNode=function(t){return t&&t.isFunctionNode&&t.constructor.prototype.isNode||!1},t.isIndexNode=function(t){return t&&t.isIndexNode&&t.constructor.prototype.isNode||!1},t.isNode=function(t){return t&&t.isNode&&t.constructor.prototype.isNode||!1},t.isObjectNode=function(t){return t&&t.isObjectNode&&t.constructor.prototype.isNode||!1},t.isOperatorNode=function(t){return t&&t.isOperatorNode&&t.constructor.prototype.isNode||!1},t.isParenthesisNode=function(t){return t&&t.isParenthesisNode&&t.constructor.prototype.isNode||!1},t.isRangeNode=function(t){return t&&t.isRangeNode&&t.constructor.prototype.isNode||!1},t.isSymbolNode=function(t){return t&&t.isSymbolNode&&t.constructor.prototype.isNode||!1},t.isChain=function(t){return t&&t.constructor.prototype.isChain||!1};var e=at();return e.types=[{name:"number",test:t.isNumber},{name:"Complex",test:t.isComplex},{name:"BigNumber",test:t.isBigNumber},{name:"Fraction",test:t.isFraction},{name:"Unit",test:t.isUnit},{name:"string",test:t.isString},{name:"Array",test:t.isArray},{name:"Matrix",test:t.isMatrix},{name:"DenseMatrix",test:t.isDenseMatrix},{name:"SparseMatrix",test:t.isSparseMatrix},{name:"Range",test:t.isRange},{name:"Index",test:t.isIndex},{name:"boolean",test:t.isBoolean},{name:"ResultSet",test:t.isResultSet},{name:"Help",test:t.isHelp},{name:"function",test:t.isFunction},{name:"Date",test:t.isDate},{name:"RegExp",test:t.isRegExp},{name:"null",test:t.isNull},{name:"undefined",test:t.isUndefined},{name:"OperatorNode",test:t.isOperatorNode},{name:"ConstantNode",test:t.isConstantNode},{name:"SymbolNode",test:t.isSymbolNode},{name:"ParenthesisNode",test:t.isParenthesisNode},{name:"FunctionNode",test:t.isFunctionNode},{name:"FunctionAssignmentNode",test:t.isFunctionAssignmentNode},{name:"ArrayNode",test:t.isArrayNode},{name:"AssignmentNode",test:t.isAssignmentNode},{name:"BlockNode",test:t.isBlockNode},{name:"ConditionalNode",test:t.isConditionalNode},{name:"IndexNode",test:t.isIndexNode},{name:"RangeNode",test:t.isRangeNode},{name:"Node",test:t.isNode},{name:"Object",test:t.isObject}],e.conversions=[{from:"number",to:"BigNumber",convert:function(e){if(it(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t.BigNumber(e)}},{from:"number",to:"Complex",convert:function(e){return new t.Complex(e,0)}},{from:"number",to:"string",convert:function(t){return t+""}},{from:"BigNumber",to:"Complex",convert:function(e){return new t.Complex(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(t){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return new t.Complex(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){if(new t.Fraction(e).valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return new t.Fraction(e)}},{from:"string",to:"number",convert:function(t){var e=Number(t);if(isNaN(e))throw new Error('Cannot convert "'+t+'" to a number');return e}},{from:"string",to:"BigNumber",convert:function(e){try{return new t.BigNumber(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(e){try{return new t.Fraction(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){try{return new t.Complex(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(t){return+t}},{from:"boolean",to:"BigNumber",convert:function(e){return new t.BigNumber(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return new t.Fraction(+e)}},{from:"boolean",to:"string",convert:function(t){return+t}},{from:"Array",to:"Matrix",convert:function(e){return new t.DenseMatrix(e)}},{from:"Matrix",to:"Array",convert:function(t){return t.valueOf()}}],e};function ut(){}ut.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function o(){r.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,a=r.length;i<a;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}};var ct=ut,pt=ut;ct.TinyEmitter=pt;var lt=function(t){var e=new ct;return t.on=e.on.bind(e),t.off=e.off.bind(e),t.once=e.once.bind(e),t.emit=e.emit.bind(e),t};function ft(t,e,n,r){if(!(this instanceof ft))throw new SyntaxError("Constructor must be called with the new operator");this.fn=t,this.count=e,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+t+" ("+e+" provided, "+n+(null!=r?"-"+r:"")+" expected)",this.stack=(new Error).stack}ft.prototype=new Error,ft.prototype.constructor=Error,ft.prototype.name="ArgumentsError",ft.prototype.isArgumentsError=!0;var ht=ft;function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var dt=et.lazy,yt=et.isFactory,vt=et.traverse,gt={math:!0,name:"import",factory:function(t,e,n,r,o){function i(t,e,n){if(n.wrap&&"function"==typeof e&&(s=function(){for(var t=[],e=0,n=arguments.length;e<n;e++){var r=arguments[e];t[e]=r&&r.valueOf()}return i.apply(o,t)},(i=e).transform&&(s.transform=i.transform),e=s),p(o[t])&&p(e))return e=n.override?r(t,e.signatures):r(o[t],e),o[t]=e,a(t,e),void o.emit("import",t,(function(){return e}));var i,s;if(void 0===o[t]||n.override)return o[t]=e,a(t,e),void o.emit("import",t,(function(){return e}));if(!n.silent)throw new Error('Cannot import "'+t+'": already exists')}function a(t,e){e&&"function"==typeof e.transform?(o.expression.transform[t]=e.transform,l(t)&&(o.expression.mathWithTransform[t]=e.transform)):(delete o.expression.transform[t],l(t)&&(o.expression.mathWithTransform[t]=e))}function s(t){delete o.expression.transform[t],l(t)?o.expression.mathWithTransform[t]=o[t]:delete o.expression.mathWithTransform[t]}function u(t,e){if("string"==typeof t.name){var i=t.name,a=i in o.expression.transform,u=t.path?vt(o,t.path):o,c=u.hasOwnProperty(i)?u[i]:void 0,l=function(){var o=n(t);if(o&&"function"==typeof o.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(p(c)&&p(o))return e.override||(o=r(c,o)),o;if(void 0===c||e.override)return o;if(!e.silent)throw new Error('Cannot import "'+i+'": already exists')};!1!==t.lazy?(dt(u,i,l),a?s(i):("expression.transform"===t.path||f(t))&&dt(o.expression.mathWithTransform,i,l)):(u[i]=l(),a?s(i):("expression.transform"===t.path||f(t))&&(o.expression.mathWithTransform[i]=l())),o.emit("import",i,l,t.path)}else n(t)}function c(e){return"function"==typeof e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e||null===e||e&&t.isUnit(e)||e&&t.isComplex(e)||e&&t.isBigNumber(e)||e&&t.isFraction(e)||e&&t.isMatrix(e)||e&&Array.isArray(e)}function p(t){return"function"==typeof t&&"object"===mt(t.signatures)}function l(t){return!h.hasOwnProperty(t)}function f(t){return void 0===t.path&&!h.hasOwnProperty(t.name)}var h={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function t(e,n){var r=arguments.length;if(1!==r&&2!==r)throw new ht("import",r,1,2);if(n||(n={}),yt(e))u(e,n);else if(Array.isArray(e))e.forEach((function(e){t(e,n)}));else if("object"===mt(e)){for(var o in e)if(e.hasOwnProperty(o)){var a=e[o];c(a)?i(o,a,n):yt(e)?u(e,n):t(a,n)}}else if(!n.silent)throw new TypeError("Factory, Object, or Array expected")}},lazy:!0};function bt(t,e,n){if(void 0!==t[e]&&!function(t,e){return-1!==t.indexOf(e)}(n,t[e])){var r=function(t,e){return t.map((function(t){return t.toLowerCase()})).indexOf(e.toLowerCase())}(n,t[e]);-1!==r?(console.warn('Warning: Wrong casing for configuration option "'+e+'", should be "'+n[r]+'" instead of "'+t[e]+'".'),t[e]=n[r]):console.warn('Warning: Unknown value "'+t[e]+'" for configuration option "'+e+'". Available options: '+n.map(JSON.stringify).join(", ")+".")}}var wt={name:"config",math:!0,factory:function(t,e,n,r,o){var i=["Matrix","Array"],a=["number","BigNumber","Fraction"];function s(t){if(t){var n=et.map(e,et.clone);bt(t,"matrix",i),bt(t,"number",a),et.deepExtend(e,t);var r=et.map(e,et.clone),s=et.map(t,et.clone);return o.emit("config",r,n,s),r}return et.map(e,et.clone)}return s.MATRIX=i,s.NUMBER=a,s}},Nt=et.isFactory,xt={create:function(t){if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var e=[],n=[],r=lt({});r.type={},r.expression={transform:{},mathWithTransform:{}},r.typed=st(r.type);var o={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function i(t){if(!Nt(t))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var a,s=e.indexOf(t);return-1===s?(a=!0===t.math?t.factory(r.type,o,i,r.typed,r):t.factory(r.type,o,i,r.typed),e.push(t),n.push(a)):a=n[s],a}return r.import=i(gt),r.config=i(wt),r.expression.mathWithTransform.config=r.config,t&&r.config(t),r}},St=function t(e,n,r){return e&&"function"==typeof e.map?e.map((function(e){return t(e,n)})):n(e)};function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Et={name:"typeof",factory:function(t,e,n,r){var o=r("_typeof",{any:function(e){var n=kt(e);return"object"===n?null===e?"null":Array.isArray(e)?"Array":e instanceof Date?"Date":e instanceof RegExp?"RegExp":t.isBigNumber(e)?"BigNumber":t.isComplex(e)?"Complex":t.isFraction(e)?"Fraction":t.isMatrix(e)?"Matrix":t.isUnit(e)?"Unit":t.isIndex(e)?"Index":t.isRange(e)?"Range":t.isResultSet(e)?"ResultSet":t.isNode(e)?e.type:t.isChain(e)?"Chain":t.isHelp(e)?"Help":"Object":"function"===n?"Function":n}});return o.toTex=void 0,o}},Ct={name:"number",factory:function(t,e,n,r){var o=r("number",{"":function(){return 0},number:function(t){return t},string:function(t){if("NaN"===t)return NaN;var e=Number(t);if(isNaN(e))throw new SyntaxError('String "'+t+'" is no valid number');return e},BigNumber:function(t){return t.toNumber()},Fraction:function(t){return t.valueOf()},Unit:function(t){throw new Error("Second argument with valueless unit expected")},null:function(t){return 0},"Unit, string | Unit":function(t,e){return t.toNumber(e)},"Array | Matrix":function(t){return St(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},o}},At={name:"bignumber",factory:function(t,e,n,r){var o=r("bignumber",{"":function(){return new t.BigNumber(0)},number:function(e){return new t.BigNumber(e+"")},string:function(e){return new t.BigNumber(e)},BigNumber:function(t){return t},Fraction:function(e){return new t.BigNumber(e.n).div(e.d).times(e.s)},null:function(e){return new t.BigNumber(0)},"Array | Matrix":function(t){return St(t,o)}});return o.toTex={0:"0",1:"\\left(${args[0]}\\right)"},o}},Ot={name:"fraction",factory:function(t,e,n,r){var o=r("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new t.Fraction(e)},string:function(e){return new t.Fraction(e)},"number, number":function(e,n){return new t.Fraction(e,n)},null:function(e){return new t.Fraction(0)},BigNumber:function(e){return new t.Fraction(e.toString())},Fraction:function(t){return t},Object:function(e){return new t.Fraction(e)},"Array | Matrix":function(t){return St(t,o)}});return o}},Tt={path:"type",name:"_numeric",factory:function(t,e,n,r){var o=n(Et),i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:n(Ct),BigNumber:n(At),Fraction:n(Ot)},s=function(t,e){var n=o(t);if(!(n in i))throw new TypeError("Cannot convert "+t+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(e in a))throw new TypeError("Cannot convert "+t+' to type "'+e+'"; valid output types are '+Object.keys(a).join(", "));return e===n?t:a[e](t)};return s.toTex=function(t,e){return t.args[0].toTex()},s}};function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Pt=et.hasOwnProperty;function Mt(t,e){return!(!t||"object"!==jt(t)||!Pt(_t,e)&&(e in Object.prototype||e in Function.prototype))}function It(t,e){return!(!t||"function"!=typeof t[e]||Pt(t,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(t)||!Pt(Dt,e)&&(e in Object.prototype||e in Function.prototype))}function Ft(t){return"object"===jt(t)&&t&&t.constructor===Object}var _t={length:!0,name:!0},Dt={toString:!0,valueOf:!0,toLocaleString:!0},Rt={getSafeProperty:function(t,e){if(Ft(t)&&Mt(t,e))return t[e];if("function"==typeof t[e]&&It(t,e))throw new Error('Cannot access method "'+e+'" as a property');throw new Error('No access to property "'+e+'"')},setSafeProperty:function(t,e,n){if(Ft(t)&&Mt(t,e))return t[e]=n,n;throw new Error('No access to property "'+e+'"')},isSafeProperty:Mt,validateSafeMethod:function(t,e){if(!It(t,e))throw new Error('No access to method "'+e+'"')},isSafeMethod:It,isPlainObject:Ft},Lt={end:!0};function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var zt=et.deepEqual,Wt=et.hasOwnProperty,Jt={name:"Node",path:"expression.node",math:!0,factory:function(t,e,n,r,o){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.eval=function(t){return this.compile().eval(t)},i.prototype.type="Node",i.prototype.isNode=!0,i.prototype.comment="",i.prototype.compile=function(){var t=this._compile(o.expression.mathWithTransform,{}),e={};return{eval:function(n){var r=n||{};return function(t){for(var e in t)if(Wt(t,e)&&e in Lt)throw new Error('Scope contains an illegal symbol, "'+e+'" is a reserved keyword')}(r),t(r,e,null)}}},i.prototype._compile=function(t,e){throw new Error("Method _compile should be implemented by type "+this.type)},i.prototype.forEach=function(t){throw new Error("Cannot run forEach on a Node interface")},i.prototype.map=function(t){throw new Error("Cannot run map on a Node interface")},i.prototype._ifNode=function(e){if(!t.isNode(e))throw new TypeError("Callback function must return a Node");return e},i.prototype.traverse=function(t){t(this,null,null),function t(e,n){e.forEach((function(e,r,o){n(e,r,o),t(e,n)}))}(this,t)},i.prototype.transform=function(t){return function t(e,n){return e.map((function(e,r,o){return t(n(e,r,o),n)}))}(t(this,null,null),t)},i.prototype.filter=function(t){var e=[];return this.traverse((function(n,r,o){t(n,r,o)&&e.push(n)})),e},i.prototype.find=function(){throw new Error("Function Node.find is deprecated. Use Node.filter instead.")},i.prototype.match=function(){throw new Error("Function Node.match is deprecated. See functions Node.filter, Node.transform, Node.traverse.")},i.prototype.clone=function(){throw new Error("Cannot clone a Node interface")},i.prototype.cloneDeep=function(){return this.map((function(t){return t.cloneDeep()}))},i.prototype.equals=function(t){return!!t&&zt(this,t)},i.prototype.toString=function(t){var e;if(t&&"object"===Bt(t))switch(Bt(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this._toString(t)},i.prototype.toJSON=function(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)},i.prototype.toHTML=function(t){var e;if(t&&"object"===Bt(t))switch(Bt(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this.toHTML(t)},i.prototype._toString=function(){throw new Error("_toString not implemented for "+this.type)},i.prototype.toTex=function(t){var e;if(t&&"object"===Bt(t))switch(Bt(t.handler)){case"object":case"undefined":break;case"function":e=t.handler(this,t);break;default:throw new TypeError("Object or function expected as callback")}return void 0!==e?e:this._toTex(t)},i.prototype._toTex=function(t){throw new Error("_toTex not implemented for "+this.type)},i.prototype.getIdentifier=function(){return this.type},i.prototype.getContent=function(){return this},i}};function qt(t,e,n){if(!(this instanceof qt))throw new SyntaxError("Constructor must be called with the new operator");this.index=t,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}qt.prototype=new RangeError,qt.prototype.constructor=RangeError,qt.prototype.name="IndexError",qt.prototype.isIndexError=!0;var Ht=qt,Ut=function(t){return t&&t.isIndexError?new Ht(t.index+1,t.min+1,void 0!==t.max?t.max+1:void 0):t},$t=Q((function(t,e){e.format=function(t,n){if("function"==typeof n)return n(t);if(!t.isFinite())return t.isNaN()?"NaN":t.gt(0)?"Infinity":"-Infinity";var r,o="auto";switch(void 0!==n&&(n.notation&&(o=n.notation),"number"==typeof n?r=n:n.precision&&(r=n.precision)),o){case"fixed":return e.toFixed(t,r);case"exponential":return e.toExponential(t,r);case"engineering":return e.toEngineering(t,r);case"auto":if(n&&n.exponential&&(void 0!==n.exponential.lower||void 0!==n.exponential.upper)){var i=et.map(n,(function(t){return t}));return i.exponential=void 0,void 0!==n.exponential.lower&&(i.lowerExp=Math.round(Math.log(n.exponential.lower)/Math.LN10)),void 0!==n.exponential.upper&&(i.upperExp=Math.round(Math.log(n.exponential.upper)/Math.LN10)),console.warn("Deprecation warning: Formatting options exponential.lower and exponential.upper (minimum and maximum value) are replaced with exponential.lowerExp and exponential.upperExp (minimum and maximum exponent) since version 4.0.0. Replace "+JSON.stringify(n)+" with "+JSON.stringify(i)),e.format(t,i)}var a=n&&void 0!==n.lowerExp?n.lowerExp:-3,s=n&&void 0!==n.upperExp?n.upperExp:5;if(t.isZero())return"0";var u=t.e;return(u>=a&&u<s?t.toSignificantDigits(r).toFixed():e.toExponential(t,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var t=arguments[2],e=arguments[4];return"."!==t?t+e:e}));default:throw new Error('Unknown notation "'+o+'". Choose "auto", "exponential", or "fixed".')}},e.toEngineering=function(t,e){var n=t.e,r=n%3==0?n:n<0?n-3-n%3:n-n%3,o=Math.abs(n-r);return t.mul(Math.pow(10,o-n)).toPrecision(e).toString()+"e"+(n>=0?"+":"")+r.toString()},e.toExponential=function(t,e){return void 0!==e?t.toExponential(e-1):t.toExponential()},e.toFixed=function(t,e){return t.toFixed(e)}})),Gt=($t.format,$t.toEngineering,$t.toExponential,$t.toFixed,Q((function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=rt.format,o=$t.format;e.isString=function(t){return"string"==typeof t},e.endsWith=function(t,e){var n=t.length-e.length,r=t.length;return t.substring(n,r)===e},e.format=function(t,i){if("number"==typeof t)return r(t,i);if(tt(t))return o(t,i);if(function(t){return t&&"object"===n(t)&&"number"==typeof t.s&&"number"==typeof t.n&&"number"==typeof t.d||!1}(t))return i&&"decimal"===i.fraction?t.toString():t.s*t.n+"/"+t.d;if(Array.isArray(t))return function t(n,r){if(Array.isArray(n)){for(var o="[",i=n.length,a=0;a<i;a++)0!==a&&(o+=", "),o+=t(n[a],r);return o+="]"}return e.format(n,r)}(t,i);if(e.isString(t))return'"'+t+'"';if("function"==typeof t)return t.syntax?String(t.syntax):"function";if(t&&"object"===n(t)){if("function"==typeof t.format)return t.format(i);if(t&&t.toString()!=={}.toString())return t.toString();var a=[];for(var s in t)t.hasOwnProperty(s)&&a.push('"'+s+'": '+e.format(t[s],i));return"{"+a.join(", ")+"}"}return String(t)},e.stringify=function(t){for(var e=String(t),n="",r=0;r<e.length;){var o=e.charAt(r);"\\"===o?(n+=o,r++,""!==(o=e.charAt(r))&&-1!=='"\\/bfnrtu'.indexOf(o)||(n+="\\"),n+=o):n+='"'===o?'\\"':o,r++}return'"'+n+'"'},e.escape=function(t){var e=String(t);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}})));function Vt(t,e,n){if(!(this instanceof Vt))throw new SyntaxError("Constructor must be called with the new operator");this.actual=t,this.expected=e,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(t)?"["+t.join(", ")+"]":t)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=(new Error).stack}Gt.isString,Gt.endsWith,Gt.format,Gt.stringify,Gt.escape,Vt.prototype=new RangeError,Vt.prototype.constructor=RangeError,Vt.prototype.name="DimensionError",Vt.prototype.isDimensionError=!0;var Kt,Zt=Vt,Yt=Q((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.size=s,e.validate=function(t,e){if(0===e.length){if(Array.isArray(t))throw new o.default(t.length,0)}else!function t(e,n,r){var i,a=e.length;if(a!==n[r])throw new o.default(a,n[r]);if(r<n.length-1){var s=r+1;for(i=0;i<a;i++){var u=e[i];if(!Array.isArray(u))throw new o.default(n.length-1,n.length,"<");t(e[i],n,s)}}else for(i=0;i<a;i++)if(Array.isArray(e[i]))throw new o.default(n.length+1,n.length,">")}(t,e,0)},e.validateIndex=function(t,e){if(!n.default.isNumber(t)||!n.default.isInteger(t))throw new TypeError("Index must be an integer (value: "+t+")");if(t<0||"number"==typeof e&&t>=e)throw new i.default(t,e)},e.resize=function(t,e,o){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new Error("Resizing to scalar is not supported");e.forEach((function(t){if(!n.default.isNumber(t)||!n.default.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+r.default.format(e)+")")}));var i=void 0!==o?o:0;return function t(e,n,r,o){var i,a,s=e.length,u=n[r],c=Math.min(s,u);if(e.length=u,r<n.length-1){var p=r+1;for(i=0;i<c;i++)a=e[i],Array.isArray(a)||(a=[a],e[i]=a),t(a,n,p,o);for(i=c;i<u;i++)a=[],e[i]=a,t(a,n,p,o)}else{for(i=0;i<c;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=c;i<u;i++)e[i]=o}}(t,e,0,i),t},e.reshape=function(t,e){var n,r=u(t);function i(t){return t.reduce((function(t,e){return t*e}))}if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("Array expected");if(0===e.length)throw new o.default(0,i(s(t)),"!=");for(var a=1,c=0;c<e.length;c++)a*=e[c];if(r.length!==a)throw new o.default(i(e),i(s(t)),"!=");try{n=function(t,e){for(var n,r=t,o=e.length-1;o>0;o--){var i=e[o];n=[];for(var a=r.length/i,s=0;s<a;s++)n.push(r.slice(s*i,(s+1)*i));r=n}return r}(r,e)}catch(n){if(n instanceof o.default)throw new o.default(i(e),i(s(t)),"!=");throw n}return n},e.squeeze=function(t,e){for(var n=e||s(t);Array.isArray(t)&&1===t.length;)t=t[0],n.shift();for(var r=n.length;1===n[r-1];)r--;return r<n.length&&(t=function t(e,n,r){var o,i;if(r<n){var a=r+1;for(o=0,i=e.length;o<i;o++)e[o]=t(e[o],n,a)}else for(;Array.isArray(e);)e=e[0];return e}(t,r,0),n.length=r),t},e.unsqueeze=function(t,e,n,r){var o=r||s(t);if(n)for(var i=0;i<n;i++)t=[t],o.unshift(1);for(t=function t(e,n,r){var o,i;if(Array.isArray(e)){var a=r+1;for(o=0,i=e.length;o<i;o++)e[o]=t(e[o],n,a)}else for(var s=r;s<n;s++)e=[e];return e}(t,e,0);o.length<e;)o.push(1);return t},e.flatten=u,e.map=function(t,e){return Array.prototype.map.call(t,e)},e.forEach=function(t,e){Array.prototype.forEach.call(t,e)},e.filter=function(t,e){if(1!==s(t).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,e)},e.filterRegExp=function(t,e){if(1!==s(t).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(t,(function(t){return e.test(t)}))},e.join=function(t,e){return Array.prototype.join.call(t,e)},e.identify=function(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(0===t.length)return t;var e=[],n=0;e[0]={value:t[0],identifier:0};for(var r=1;r<t.length;r++)t[r]===t[r-1]?n++:n=0,e.push({value:t[r],identifier:n});return e},e.generalize=function(t){if(!Array.isArray(t))throw new TypeError("Array input expected");if(0===t.length)return t;for(var e=[],n=0;n<t.length;n++)e.push(t[n].value);return e};var n=a(rt),r=a(Gt),o=a(Zt),i=a(Ht);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){for(var e=[];Array.isArray(t);)e.push(t.length),t=t[0];return e}function u(t){if(!Array.isArray(t))return t;var e=[];return t.forEach((function t(n){Array.isArray(n)?n.forEach(t):e.push(n)})),e}}));(Kt=Yt)&&Kt.__esModule&&Object.prototype.hasOwnProperty.call(Kt,"default")&&Kt.default,Yt.size,Yt.validate,Yt.validateIndex,Yt.resize,Yt.reshape,Yt.squeeze,Yt.unsqueeze,Yt.flatten,Yt.map,Yt.forEach,Yt.filter,Yt.filterRegExp,Yt.join,Yt.identify,Yt.generalize;var Xt={name:"matrix",factory:function(t,e,n,r){var o=r("matrix",{"":function(){return i([])},string:function(t){return i([],t)},"string, string":function(t,e){return i([],t,e)},Array:function(t){return i(t)},Matrix:function(t){return i(t,t.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o;function i(e,n,r){return new(t.Matrix.storage(n||"default"))(e,r)}}},Qt=et.clone,te=Yt.validateIndex,ee=Rt.getSafeProperty,ne=Rt.setSafeProperty;function re(t,e){if(1!==e.size().length)throw new Zt(e.size(),1);var n=e.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");return ee(t,n)}function oe(t,e,n){if(1!==e.size().length)throw new Zt(e.size(),1);var r=e.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");var o=Qt(t);return ne(o,r,n),o}var ie={name:"subset",factory:function(t,e,n,r){var o=n(Xt),i=r("subset",{"Array, Index":function(t,e){var n=o(t).subset(e);return e.isScalar()?n:n.valueOf()},"Matrix, Index":function(t,e){return t.subset(e)},"Object, Index":re,"string, Index":function(e,n){if(!t.isIndex(n))throw new TypeError("Index expected");if(1!==n.size().length)throw new Zt(n.size().length,1);var r=e.length;te(n.min()[0],r),te(n.max()[0],r);var o=n.dimension(0),i="";return o.forEach((function(t){i+=e.charAt(t)})),i},"Array, Index, any":function(t,e,n){return o(Qt(t)).subset(e,n,void 0).valueOf()},"Array, Index, any, any":function(t,e,n,r){return o(Qt(t)).subset(e,n,r).valueOf()},"Matrix, Index, any":function(t,e,n){return t.clone().subset(e,n)},"Matrix, Index, any, any":function(t,e,n,r){return t.clone().subset(e,n,r)},"string, Index, string":a,"string, Index, string, string":a,"Object, Index, any":oe});return i.toTex=void 0,i;function a(t,e,n,r){if(!e||!0!==e.isIndex)throw new TypeError("Index expected");if(1!==e.size().length)throw new Zt(e.size().length,1);if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var o=e.dimension(0);if(o.size()[0]!==n.length)throw new Zt(o.size()[0],n.length);var i=t.length;te(e.min()[0]),te(e.max()[0]);for(var a=[],s=0;s<i;s++)a[s]=t.charAt(s);if(o.forEach((function(t,e){a[t]=n.charAt(e[0])})),a.length>i)for(var u=i-1,c=a.length;u<c;u++)a[u]||(a[u]=r);return a.join("")}}};function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var se=Ut,ue=Rt.getSafeProperty,ce={factory:function(t,e,n,r){var o=n(ie);return function(t,e){try{if(Array.isArray(t))return o(t,e);if(t&&"function"==typeof t.subset)return t.subset(e);if("string"==typeof t)return o(t,e);if("object"===ae(t)){if(!e.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return ue(t,e.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(t){throw se(t)}}}},pe=Rt.getSafeProperty,le={name:"AccessorNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(ce);function a(e,n){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t.isNode(e))throw new TypeError('Node expected for parameter "object"');if(!t.isIndexNode(n))throw new TypeError('IndexNode expected for parameter "index"');this.object=e||null,this.index=n,Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function s(e){return!(t.isAccessorNode(e)||t.isArrayNode(e)||t.isConstantNode(e)||t.isFunctionNode(e)||t.isObjectNode(e)||t.isParenthesisNode(e)||t.isSymbolNode(e))}return a.prototype=new o,a.prototype.type="AccessorNode",a.prototype.isAccessorNode=!0,a.prototype._compile=function(t,e){var n=this.object._compile(t,e),r=this.index._compile(t,e);if(this.index.isObjectProperty()){var o=this.index.getObjectProperty();return function(t,e,r){return pe(n(t,e,r),o)}}return function(t,e,o){var a=n(t,e,o),s=r(t,e,a);return i(a,s)}},a.prototype.forEach=function(t){t(this.object,"object",this),t(this.index,"index",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.object,"object",this)),this._ifNode(t(this.index,"index",this)))},a.prototype.clone=function(){return new a(this.object,this.index)},a.prototype._toString=function(t){var e=this.object.toString(t);return s(this.object)&&(e="("+e+")"),e+this.index.toString(t)},a.prototype.toHTML=function(t){var e=this.object.toHTML(t);return s(this.object)&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+this.index.toHTML(t)},a.prototype._toTex=function(t){var e=this.object.toTex(t);return s(this.object)&&(e="\\left(' + object + '\\right)"),e+this.index.toTex(t)},a.prototype.toJSON=function(){return{mathjs:"AccessorNode",object:this.object,index:this.index}},a.fromJSON=function(t){return new a(t.object,t.index)},a}},fe=Yt.map,he={name:"ArrayNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(this.items=e||[],!Array.isArray(this.items)||!this.items.every(t.isNode))throw new TypeError("Array containing Nodes expected");var n=function(){throw new Error("Property `ArrayNode.nodes` is deprecated, use `ArrayNode.items` instead")};Object.defineProperty(this,"nodes",{get:n,set:n})}return i.prototype=new o,i.prototype.type="ArrayNode",i.prototype.isArrayNode=!0,i.prototype._compile=function(t,e){var n=fe(this.items,(function(n){return n._compile(t,e)}));if("Array"!==t.config().matrix){var r=t.matrix;return function(t,e,o){return r(fe(n,(function(n){return n(t,e,o)})))}}return function(t,e,r){return fe(n,(function(n){return n(t,e,r)}))}},i.prototype.forEach=function(t){for(var e=0;e<this.items.length;e++)t(this.items[e],"items["+e+"]",this)},i.prototype.map=function(t){for(var e=[],n=0;n<this.items.length;n++)e[n]=this._ifNode(t(this.items[n],"items["+n+"]",this));return new i(e)},i.prototype.clone=function(){return new i(this.items.slice(0))},i.prototype._toString=function(t){return"["+this.items.map((function(e){return e.toString(t)})).join(", ")+"]"},i.prototype.toJSON=function(){return{mathjs:"ArrayNode",items:this.items}},i.fromJSON=function(t){return new i(t.items)},i.prototype.toHTML=function(t){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(e){return e.toHTML(t)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},i.prototype._toTex=function(t){var e="\\begin{bmatrix}";return this.items.forEach((function(n){n.items?e+=n.items.map((function(e){return e.toTex(t)})).join("&"):e+=n.toTex(t),e+="\\\\"})),e+="\\end{bmatrix}"},i}};function me(t){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var de=Ut,ye=Rt.setSafeProperty,ve={factory:function(t,e,n,r){var o=n(ie),i=n(Xt);return function(t,e,n){try{if(Array.isArray(t))return i(t).subset(e,n).valueOf();if(t&&"function"==typeof t.subset)return t.subset(e,n);if("string"==typeof t)return o(t,e,n);if("object"===me(t)){if(!e.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return ye(t,e.getObjectProperty(),n),t}throw new TypeError("Cannot apply index: unsupported type of object")}catch(t){throw de(t)}}}},ge=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{associativity:"left",associativeWith:[]}},{"OperatorNode:and":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{associativity:"left",associativeWith:[]},"OperatorNode:unequal":{associativity:"left",associativeWith:[]},"OperatorNode:smaller":{associativity:"left",associativeWith:[]},"OperatorNode:larger":{associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{associativity:"left",associativeWith:[]}},{"OperatorNode:to":{associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{associativity:"left",associativeWith:[]},"OperatorNode:mod":{associativity:"left",associativeWith:[]}},{"OperatorNode:unaryPlus":{associativity:"right"},"OperatorNode:unaryMinus":{associativity:"right"},"OperatorNode:bitNot":{associativity:"right"},"OperatorNode:not":{associativity:"right"}},{"OperatorNode:pow":{associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{associativity:"left"}},{"OperatorNode:transpose":{associativity:"left"}}];function be(t,e){var n=t;"keep"!==e&&(n=t.getContent());for(var r=n.getIdentifier(),o=0;o<ge.length;o++)if(r in ge[o])return o;return null}var we={properties:ge,getPrecedence:be,getAssociativity:function(t,e){var n=t;"keep"!==e&&(n=t.getContent());var r=n.getIdentifier(),o=be(n,e);if(null===o)return null;var i=ge[o][r];if(i.hasOwnProperty("associativity")){if("left"===i.associativity)return"left";if("right"===i.associativity)return"right";throw Error("'"+r+"' has the invalid associativity '"+i.associativity+"'.")}return null},isAssociativeWith:function(t,e,n){var r="keep"!==n?t.getContent():t,o="keep"!==n?t.getContent():e,i=r.getIdentifier(),a=o.getIdentifier(),s=be(r,n);if(null===s)return null;var u=ge[s][i];if(u.hasOwnProperty("associativeWith")&&u.associativeWith instanceof Array){for(var c=0;c<u.associativeWith.length;c++)if(u.associativeWith[c]===a)return!0;return!1}return null}},Ne=Rt.getSafeProperty,xe=Rt.setSafeProperty,Se={name:"AssignmentNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(ve),a=n(ce),s=we;function u(e,n,r){if(!(this instanceof u))throw new SyntaxError("Constructor must be called with the new operator");if(this.object=e,this.index=r?n:null,this.value=r||n,!t.isSymbolNode(e)&&!t.isAccessorNode(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(t.isSymbolNode(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!t.isIndexNode(this.index))throw new TypeError('IndexNode expected as "index"');if(!t.isNode(this.value))throw new TypeError('Node expected as "value"');Object.defineProperty(this,"name",{get:function(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}})}function c(t,e){e||(e="keep");var n=s.getPrecedence(t,e),r=s.getPrecedence(t.value,e);return"all"===e||null!==r&&r<=n}return u.prototype=new o,u.prototype.type="AssignmentNode",u.prototype.isAssignmentNode=!0,u.prototype._compile=function(e,n){var r=this.object._compile(e,n),o=this.index?this.index._compile(e,n):null,s=this.value._compile(e,n),u=this.object.name;if(this.index){if(this.index.isObjectProperty()){var c=this.index.getObjectProperty();return function(t,e,n){var o=r(t,e,n),i=s(t,e,n);return xe(o,c,i)}}if(t.isSymbolNode(this.object))return function(t,e,n){var a=r(t,e,n),c=s(t,e,n),p=o(t,e,a);return xe(t,u,i(a,p,c)),c};var p=this.object.object._compile(e,n);if(this.object.index.isObjectProperty()){var l=this.object.index.getObjectProperty();return function(t,e,n){var r=p(t,e,n),a=Ne(r,l),u=o(t,e,a),c=s(t,e,n);return xe(r,l,i(a,u,c)),c}}var f=this.object.index._compile(e,n);return function(t,e,n){var r=p(t,e,n),u=f(t,e,r),c=a(r,u),l=o(t,e,c),h=s(t,e,n);return i(r,u,i(c,l,h)),h}}if(!t.isSymbolNode(this.object))throw new TypeError("SymbolNode expected as object");return function(t,e,n){return xe(t,u,s(t,e,n))}},u.prototype.forEach=function(t){t(this.object,"object",this),this.index&&t(this.index,"index",this),t(this.value,"value",this)},u.prototype.map=function(t){return new u(this._ifNode(t(this.object,"object",this)),this.index?this._ifNode(t(this.index,"index",this)):null,this._ifNode(t(this.value,"value",this)))},u.prototype.clone=function(){return new u(this.object,this.index,this.value)},u.prototype._toString=function(t){var e=this.object.toString(t),n=this.index?this.index.toString(t):"",r=this.value.toString(t);return c(this,t&&t.parenthesis)&&(r="("+r+")"),e+n+" = "+r},u.prototype.toJSON=function(){return{mathjs:"AssignmentNode",object:this.object,index:this.index,value:this.value}},u.fromJSON=function(t){return new u(t.object,t.index,t.value)},u.prototype.toHTML=function(t){var e=this.object.toHTML(t),n=this.index?this.index.toHTML(t):"",r=this.value.toHTML(t);return c(this,t&&t.parenthesis)&&(r='<span class="math-paranthesis math-round-parenthesis">(</span>'+r+'<span class="math-paranthesis math-round-parenthesis">)</span>'),e+n+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r},u.prototype._toTex=function(t){var e=this.object.toTex(t),n=this.index?this.index.toTex(t):"",r=this.value.toTex(t);return c(this,t&&t.parenthesis)&&(r="\\left(".concat(r,"\\right)")),e+n+":="+r},u}},ke={name:"ResultSet",path:"type",factory:function(t,e,n,r){function o(t){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return o.prototype.type="ResultSet",o.prototype.isResultSet=!0,o.prototype.valueOf=function(){return this.entries},o.prototype.toString=function(){return"["+this.entries.join(", ")+"]"},o.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},o.fromJSON=function(t){return new o(t.entries)},o}},Ee=Yt.forEach,Ce=Yt.map,Ae={name:"BlockNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(ke);function a(e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map((function(e){var n=e&&e.node,r=!e||void 0===e.visible||e.visible;if(!t.isNode(n))throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof r)throw new TypeError('Property "visible" must be a boolean');return{node:n,visible:r}}))}return a.prototype=new o,a.prototype.type="BlockNode",a.prototype.isBlockNode=!0,a.prototype._compile=function(t,e){var n=Ce(this.blocks,(function(n){return{eval:n.node._compile(t,e),visible:n.visible}}));return function(t,e,r){var o=[];return Ee(n,(function(n){var i=n.eval(t,e,r);n.visible&&o.push(i)})),new i(o)}},a.prototype.forEach=function(t){for(var e=0;e<this.blocks.length;e++)t(this.blocks[e].node,"blocks["+e+"].node",this)},a.prototype.map=function(t){for(var e=[],n=0;n<this.blocks.length;n++){var r=this.blocks[n],o=this._ifNode(t(r.node,"blocks["+n+"].node",this));e[n]={node:o,visible:r.visible}}return new a(e)},a.prototype.clone=function(){return new a(this.blocks.map((function(t){return{node:t.node,visible:t.visible}})))},a.prototype._toString=function(t){return this.blocks.map((function(e){return e.node.toString(t)+(e.visible?"":";")})).join("\n")},a.prototype.toJSON=function(){return{mathjs:"BlockNode",blocks:this.blocks}},a.fromJSON=function(t){return new a(t.blocks)},a.prototype.toHTML=function(t){return this.blocks.map((function(e){return e.node.toHTML(t)+(e.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')},a.prototype._toTex=function(t){return this.blocks.map((function(e){return e.node.toTex(t)+(e.visible?"":";")})).join("\\;\\;\n")},a}},Oe={name:"ConditionalNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(Et);function a(e,n,r){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!t.isNode(e))throw new TypeError("Parameter condition must be a Node");if(!t.isNode(n))throw new TypeError("Parameter trueExpr must be a Node");if(!t.isNode(r))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=n,this.falseExpr=r}return a.prototype=new o,a.prototype.type="ConditionalNode",a.prototype.isConditionalNode=!0,a.prototype._compile=function(e,n){var r=this.condition._compile(e,n),o=this.trueExpr._compile(e,n),a=this.falseExpr._compile(e,n);return function(e,n,s){return function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(t.isBigNumber(e))return!e.isZero();if(t.isComplex(e))return!(!e.re&&!e.im);if(t.isUnit(e))return!!e.value}if(null==e)return!1;throw new TypeError('Unsupported type of condition "'+i(e)+'"')}(r(e,n,s))?o(e,n,s):a(e,n,s)}},a.prototype.forEach=function(t){t(this.condition,"condition",this),t(this.trueExpr,"trueExpr",this),t(this.falseExpr,"falseExpr",this)},a.prototype.map=function(t){return new a(this._ifNode(t(this.condition,"condition",this)),this._ifNode(t(this.trueExpr,"trueExpr",this)),this._ifNode(t(this.falseExpr,"falseExpr",this)))},a.prototype.clone=function(){return new a(this.condition,this.trueExpr,this.falseExpr)},a.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=we.getPrecedence(this,e),r=this.condition.toString(t),o=we.getPrecedence(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==o&&o<=n)&&(r="("+r+")");var i=this.trueExpr.toString(t),a=we.getPrecedence(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(i="("+i+")");var s=this.falseExpr.toString(t),u=we.getPrecedence(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s="("+s+")"),r+" ? "+i+" : "+s},a.prototype.toJSON=function(){return{mathjs:"ConditionalNode",condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}},a.fromJSON=function(t){return new a(t.condition,t.trueExpr,t.falseExpr)},a.prototype.toHTML=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=we.getPrecedence(this,e),r=this.condition.toHTML(t),o=we.getPrecedence(this.condition,e);("all"===e||"OperatorNode"===this.condition.type||null!==o&&o<=n)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var i=this.trueExpr.toHTML(t),a=we.getPrecedence(this.trueExpr,e);("all"===e||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(t),u=we.getPrecedence(this.falseExpr,e);return("all"===e||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r+'<span class="math-operator math-conditional-operator">?</span>'+i+'<span class="math-operator math-conditional-operator">:</span>'+s},a.prototype._toTex=function(t){return"\\begin{cases} {"+this.trueExpr.toTex(t)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(t)+"}\\\\{"+this.falseExpr.toTex(t)+"}, &\\quad{\\text{otherwise}}\\end{cases}"},a}},Te=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},je={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},Pe={"–":"\\--","—":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},Me=function(t,e){return Te({},t,e)},Ie=Q((function(t,e){e.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},e.operators={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},e.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var n={deg:"^\\circ"};e.escape=function(t){return function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.preserveFormatting,r=void 0!==n&&n,o=e.escapeMapFn,i=void 0===o?Me:o,a=String(t),s="",u=i(Te({},je),r?Te({},Pe):{}),c=Object.keys(u),p=function(){var t=!1;c.forEach((function(e,n){t||a.length>=e.length&&a.slice(0,e.length)===e&&(s+=u[c[n]],a=a.slice(e.length,a.length),t=!0)})),t||(s+=a.slice(0,1),a=a.slice(1,a.length))};a;)p();return s}(t,{preserveFormatting:!0})},e.toSymbol=function(t,r){return(r=void 0!==r&&r)?n.hasOwnProperty(t)?n[t]:"\\mathrm{"+e.escape(t)+"}":e.symbols.hasOwnProperty(t)?e.symbols[t]:e.escape(t)}})),Fe=(Ie.symbols,Ie.operators,Ie.defaultTemplate,Ie.escape,Ie.toSymbol,Gt.format),_e=Ie.escape,De={name:"ConstantNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(Et);function a(t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(2===arguments.length)throw new SyntaxError("new ConstantNode(valueStr, valueType) is not supported anymore since math v4.0.0. Use new ConstantNode(value) instead, where value is a non-stringified value.");this.value=t}return a.prototype=new o,a.prototype.type="ConstantNode",a.prototype.isConstantNode=!0,a.prototype._compile=function(t,e){var n=this.value;return function(){return n}},a.prototype.forEach=function(t){},a.prototype.map=function(t){return this.clone()},a.prototype.clone=function(){return new a(this.value)},a.prototype._toString=function(t){return Fe(this.value,t)},a.prototype.toHTML=function(t){var e=this._toString(t);switch(i(this.value)){case"number":case"BigNumber":case"Fraction":return'<span class="math-number">'+e+"</span>";case"string":return'<span class="math-string">'+e+"</span>";case"boolean":return'<span class="math-boolean">'+e+"</span>";case"null":return'<span class="math-null-symbol">'+e+"</span>";case"undefined":return'<span class="math-undefined">'+e+"</span>";default:return'<span class="math-symbol">'+e+"</span>"}},a.prototype.toJSON=function(){return{mathjs:"ConstantNode",value:this.value}},a.fromJSON=function(t){return new a(t.value)},a.prototype._toTex=function(t){var e=this._toString(t);switch(i(this.value)){case"string":return"\\mathtt{"+_e(e)+"}";case"number":case"BigNumber":var n=e.toLowerCase().indexOf("e");return-1!==n?e.substring(0,n)+"\\cdot10^{"+e.substring(n+1)+"}":e;case"Fraction":return this.value.toLatex();default:return e}},a}},Re=Gt.escape,Le=Yt.forEach,Be=Yt.join,ze=Rt.setSafeProperty,We={name:"FunctionAssignmentNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e,n,r){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(n))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!t.isNode(r))throw new TypeError('Node expected for parameter "expr"');if(e in Lt)throw new Error('Illegal function name, "'+e+'" is a reserved keyword');this.name=e,this.params=n.map((function(t){return t&&t.name||t})),this.types=n.map((function(t){return t&&t.type||"any"})),this.expr=r}function a(t,e){var n=we.getPrecedence(t,e),r=we.getPrecedence(t.expr,e);return"all"===e||null!==r&&r<=n}return i.prototype=new o,i.prototype.type="FunctionAssignmentNode",i.prototype.isFunctionAssignmentNode=!0,i.prototype._compile=function(t,e){var n=Object.create(e);Le(this.params,(function(t){n[t]=!0}));var o=this.expr._compile(t,n),i=this.name,a=this.params,s=Be(this.types,","),u=i+"("+Be(this.params,", ")+")";return function(t,e,n){var c={};c[s]=function(){for(var r=Object.create(e),i=0;i<a.length;i++)r[a[i]]=arguments[i];return o(t,r,n)};var p=r(i,c);return p.syntax=u,ze(t,i,p),p}},i.prototype.forEach=function(t){t(this.expr,"expr",this)},i.prototype.map=function(t){var e=this._ifNode(t(this.expr,"expr",this));return new i(this.name,this.params.slice(0),e)},i.prototype.clone=function(){return new i(this.name,this.params.slice(0),this.expr)},i.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toString(t);return a(this,e)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n},i.prototype.toJSON=function(){var t=this.types;return{mathjs:"FunctionAssignmentNode",name:this.name,params:this.params.map((function(e,n){return{name:e,type:t[n]}})),expr:this.expr}},i.fromJSON=function(t){return new i(t.name,t.params,t.expr)},i.prototype.toHTML=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=[],r=0;r<this.params.length;r++)n.push('<span class="math-symbol math-parameter">'+Re(this.params[r])+"</span>");var o=this.expr.toHTML(t);return a(this,e)&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+Re(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+o},i.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=this.expr.toTex(t);return a(this,e)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(Ie.toSymbol).join(",")+"\\right):="+n},i}},Je={name:"Range",path:"type",factory:function(t,e,n,r){function o(e,n,r){if(!(this instanceof o))throw new SyntaxError("Constructor must be called with the new operator");var i=null!=e,a=null!=n,s=null!=r;if(i)if(t.isBigNumber(e))e=e.toNumber();else if("number"!=typeof e)throw new TypeError("Parameter start must be a number");if(a)if(t.isBigNumber(n))n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter end must be a number");if(s)if(t.isBigNumber(r))r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter step must be a number");this.start=i?parseFloat(e):0,this.end=a?parseFloat(n):0,this.step=s?parseFloat(r):1}return o.prototype.type="Range",o.prototype.isRange=!0,o.parse=function(t){if("string"!=typeof t)return null;var e=t.split(":").map((function(t){return parseFloat(t)}));if(e.some((function(t){return isNaN(t)})))return null;switch(e.length){case 2:return new o(e[0],e[1]);case 3:return new o(e[0],e[2],e[1]);default:return null}},o.prototype.clone=function(){return new o(this.start,this.end,this.step)},o.prototype.size=function(){var t=0,e=this.start,n=this.step,r=this.end-e;return rt.sign(n)===rt.sign(r)?t=Math.ceil(r/n):0===r&&(t=0),isNaN(t)&&(t=0),[t]},o.prototype.min=function(){var t=this.size()[0];return t>0?this.step>0?this.start:this.start+(t-1)*this.step:void 0},o.prototype.max=function(){var t=this.size()[0];return t>0?this.step>0?this.start+(t-1)*this.step:this.start:void 0},o.prototype.forEach=function(t){var e=this.start,n=this.step,r=this.end,o=0;if(n>0)for(;e<r;)t(e,[o],this),e+=n,o++;else if(n<0)for(;e>r;)t(e,[o],this),e+=n,o++},o.prototype.map=function(t){var e=[];return this.forEach((function(n,r,o){e[r[0]]=t(n,r,o)})),e},o.prototype.toArray=function(){var t=[];return this.forEach((function(e,n){t[n[0]]=e})),t},o.prototype.valueOf=function(){return this.toArray()},o.prototype.format=function(t){var e=rt.format(this.start,t);return 1!==this.step&&(e+=":"+rt.format(this.step,t)),e+=":"+rt.format(this.end,t)},o.prototype.toString=function(){return this.format()},o.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},o.fromJSON=function(t){return new o(t.start,t.end,t.step)},o}},qe=Yt.map,He=Gt.escape,Ue={name:"IndexNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=n(Je),a=Array.isArray;function s(e,n){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if(this.dimensions=e,this.dotNotation=n||!1,!a(e)||!e.every(t.isNode))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties");var r=function(){throw new Error("Property `IndexNode.object` is deprecated, use `IndexNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}function u(e,n,r){return new i(t.isBigNumber(e)?e.toNumber():e,t.isBigNumber(n)?n.toNumber():n,t.isBigNumber(r)?r.toNumber():r)}return s.prototype=new o,s.prototype.type="IndexNode",s.prototype.isIndexNode=!0,s.prototype._compile=function(e,n){var r=qe(this.dimensions,(function(r,o){if(t.isRangeNode(r)){if(r.needsEnd()){var i=Object.create(n);i.end=!0;var a=r.start._compile(e,i),s=r.end._compile(e,i),c=r.step?r.step._compile(e,i):function(){return 1};return function(t,n,r){var i=e.size(r).valueOf(),p=Object.create(n);return p.end=i[o],u(a(t,p,r),s(t,p,r),c(t,p,r))}}var p=r.start._compile(e,n),l=r.end._compile(e,n),f=r.step?r.step._compile(e,n):function(){return 1};return function(t,e,n){return u(p(t,e,n),l(t,e,n),f(t,e,n))}}if(t.isSymbolNode(r)&&"end"===r.name){var h=Object.create(n);h.end=!0;var m=r._compile(e,h);return function(t,n,r){var i=e.size(r).valueOf(),a=Object.create(n);return a.end=i[o],m(t,a,r)}}var d=r._compile(e,n);return function(t,e,n){return d(t,e,n)}}));return function(t,n,o){var i=qe(r,(function(e){return e(t,n,o)}));return e.index.apply(e,i)}},s.prototype.forEach=function(t){for(var e=0;e<this.dimensions.length;e++)t(this.dimensions[e],"dimensions["+e+"]",this)},s.prototype.map=function(t){for(var e=[],n=0;n<this.dimensions.length;n++)e[n]=this._ifNode(t(this.dimensions[n],"dimensions["+n+"]",this));return new s(e)},s.prototype.clone=function(){return new s(this.dimensions.slice(0))},s.prototype.isObjectProperty=function(){return 1===this.dimensions.length&&t.isConstantNode(this.dimensions[0])&&"string"==typeof this.dimensions[0].value},s.prototype.getObjectProperty=function(){return this.isObjectProperty()?this.dimensions[0].value:null},s.prototype._toString=function(t){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"},s.prototype.toJSON=function(){return{mathjs:"IndexNode",dimensions:this.dimensions,dotNotation:this.dotNotation}},s.fromJSON=function(t){return new s(t.dimensions,t.dotNotation)},s.prototype.toHTML=function(t){for(var e=[],n=0;n<this.dimensions.length;n++)e[n]=this.dimensions[n].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+He(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'},s.prototype._toTex=function(t){var e=this.dimensions.map((function(e){return e.toTex(t)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+e.join(",")+"}"},s}};function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Ge=Gt.stringify,Ve=Gt.escape,Ke=Rt.isSafeProperty,Ze=et.hasOwnProperty,Ye={name:"ObjectNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(this.properties=e||{},e&&("object"!==$e(e)||!Object.keys(e).every((function(n){return t.isNode(e[n])}))))throw new TypeError("Object containing Nodes expected")}return i.prototype=new o,i.prototype.type="ObjectNode",i.prototype.isObjectNode=!0,i.prototype._compile=function(t,e){var n={};for(var r in this.properties)if(Ze(this.properties,r)){var o=Ge(r),i=JSON.parse(o);if(!Ke(this.properties,i))throw new Error('No access to property "'+i+'"');n[i]=this.properties[r]._compile(t,e)}return function(t,e,r){var o={};for(var i in n)Ze(n,i)&&(o[i]=n[i](t,e,r));return o}},i.prototype.forEach=function(t){for(var e in this.properties)this.properties.hasOwnProperty(e)&&t(this.properties[e],"properties["+Ge(e)+"]",this)},i.prototype.map=function(t){var e={};for(var n in this.properties)this.properties.hasOwnProperty(n)&&(e[n]=this._ifNode(t(this.properties[n],"properties["+Ge(n)+"]",this)));return new i(e)},i.prototype.clone=function(){var t={};for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t[e]=this.properties[e]);return new i(t)},i.prototype._toString=function(t){var e=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&e.push(Ge(n)+": "+this.properties[n].toString(t));return"{"+e.join(", ")+"}"},i.prototype.toJSON=function(){return{mathjs:"ObjectNode",properties:this.properties}},i.fromJSON=function(t){return new i(t.properties)},i.prototype.toHTML=function(t){var e=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&e.push('<span class="math-symbol math-property">'+Ve(n)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[n].toHTML(t));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'},i.prototype._toTex=function(t){var e=[];for(var n in this.properties)this.properties.hasOwnProperty(n)&&e.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(t)+"\\\\");return"\\left\\{\\begin{array}{ll}".concat(e.join("\n"),"\\end{array}\\right\\}")},i}},Xe=Yt.map,Qe=Gt.escape,tn=Rt.isSafeMethod,en=Rt.getSafeProperty,nn={name:"OperatorNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e,n,r,o){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof e)throw new TypeError('string expected for parameter "op"');if("string"!=typeof n)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(t.isNode))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===o,this.op=e,this.fn=n,this.args=r||[]}function a(t,e,n,r,o){var i,a=we.getPrecedence(t,e),s=we.getAssociativity(t,e);if("all"===e||r.length>2&&"OperatorNode:add"!==t.getIdentifier()&&"OperatorNode:multiply"!==t.getIdentifier())return r.map((function(t){switch(t.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(r.length){case 0:i=[];break;case 1:var u=we.getPrecedence(r[0],e);if(o&&null!==u){var c,p;if("keep"===e?(c=r[0].getIdentifier(),p=t.getIdentifier()):(c=r[0].getContent().getIdentifier(),p=t.getContent().getIdentifier()),!1===we.properties[a][p].latexLeftParens){i=[!1];break}if(!1===we.properties[u][c].latexParens){i=[!1];break}}if(null===u){i=[!1];break}if(u<=a){i=[!0];break}i=[!1];break;case 2:var l,f,h=we.getPrecedence(r[0],e),m=we.isAssociativeWith(t,r[0],e);l=null!==h&&(h===a&&"right"===s&&!m||h<a);var d,y,v,g=we.getPrecedence(r[1],e),b=we.isAssociativeWith(t,r[1],e);f=null!==g&&(g===a&&"left"===s&&!b||g<a),o&&("keep"===e?(d=t.getIdentifier(),y=t.args[0].getIdentifier(),v=t.args[1].getIdentifier()):(d=t.getContent().getIdentifier(),y=t.args[0].getContent().getIdentifier(),v=t.args[1].getContent().getIdentifier()),null!==h&&(!1===we.properties[a][d].latexLeftParens&&(l=!1),!1===we.properties[h][y].latexParens&&(l=!1)),null!==g&&(!1===we.properties[a][d].latexRightParens&&(f=!1),!1===we.properties[g][v].latexParens&&(f=!1))),i=[l,f];break;default:"OperatorNode:add"!==t.getIdentifier()&&"OperatorNode:multiply"!==t.getIdentifier()||(i=r.map((function(n){var r=we.getPrecedence(n,e),o=we.isAssociativeWith(t,n,e),i=we.getAssociativity(n,e);return null!==r&&(a===r&&s===i&&!o||r<a)})))}return r.length>=2&&"OperatorNode:multiply"===t.getIdentifier()&&t.implicit&&"auto"===e&&"hide"===n&&(i=r.map((function(t,e){var n="ParenthesisNode"===t.getIdentifier();return!(!i[e]&&!n)}))),i}return i.prototype=new o,i.prototype.type="OperatorNode",i.prototype.isOperatorNode=!0,i.prototype._compile=function(t,e){if("string"!=typeof this.fn||!tn(t,this.fn))throw t[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var n=en(t,this.fn),r=Xe(this.args,(function(n){return n._compile(t,e)}));if(1===r.length){var o=r[0];return function(t,e,r){return n(o(t,e,r))}}if(2===r.length){var i=r[0],a=r[1];return function(t,e,r){return n(i(t,e,r),a(t,e,r))}}return function(t,e,o){return n.apply(null,Xe(r,(function(n){return n(t,e,o)})))}},i.prototype.forEach=function(t){for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},i.prototype.map=function(t){for(var e=[],n=0;n<this.args.length;n++)e[n]=this._ifNode(t(this.args[n],"args["+n+"]",this));return new i(this.op,this.fn,e,this.implicit)},i.prototype.clone=function(){return new i(this.op,this.fn,this.args.slice(0),this.implicit)},i.prototype.isUnary=function(){return 1===this.args.length},i.prototype.isBinary=function(){return 2===this.args.length},i.prototype._toString=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=t&&t.implicit?t.implicit:"hide",r=this.args,o=a(this,e,n,r,!1);if(1===r.length){var i=we.getAssociativity(this,e),s=r[0].toString(t);o[0]&&(s="("+s+")");var u=/[a-zA-Z]+/.test(this.op);return"right"===i?this.op+(u?" ":"")+s:"left"===i?s+(u?" ":"")+this.op:s+this.op}if(2===r.length){var c=r[0].toString(t),p=r[1].toString(t);return o[0]&&(c="("+c+")"),o[1]&&(p="("+p+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?c+" "+p:c+" "+this.op+" "+p}if(r.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var l=r.map((function(e,n){return e=e.toString(t),o[n]&&(e="("+e+")"),e}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?l.join(" "):l.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"},i.prototype.toJSON=function(){return{mathjs:"OperatorNode",op:this.op,fn:this.fn,args:this.args,implicit:this.implicit}},i.fromJSON=function(t){return new i(t.op,t.fn,t.args,t.implicit)},i.prototype.toHTML=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=t&&t.implicit?t.implicit:"hide",r=this.args,o=a(this,e,n,r,!1);if(1===r.length){var i=we.getAssociativity(this,e),s=r[0].toHTML(t);return o[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===i?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+Qe(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+Qe(this.op)+"</span>"}if(2===r.length){var u=r[0].toHTML(t),c=r[1].toHTML(t);return o[0]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),o[1]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?u+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+c:u+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Qe(this.op)+"</span>"+c}var p=r.map((function(e,n){return e=e.toHTML(t),o[n]&&(e='<span class="math-parenthesis math-round-parenthesis">(</span>'+e+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e}));return r.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?p.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):p.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Qe(this.op)+"</span>"):'<span class="math-function">'+Qe(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+p.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'},i.prototype._toTex=function(t){var e=t&&t.parenthesis?t.parenthesis:"keep",n=t&&t.implicit?t.implicit:"hide",r=this.args,o=a(this,e,n,r,!0),i=Ie.operators[this.fn];if(i=void 0===i?this.op:i,1===r.length){var s=we.getAssociativity(this,e),u=r[0].toTex(t);return o[0]&&(u="\\left(".concat(u,"\\right)")),"right"===s?i+u:u+i}if(2===r.length){var c=r[0],p=c.toTex(t);o[0]&&(p="\\left(".concat(p,"\\right)"));var l,f=r[1].toTex(t);switch(o[1]&&(f="\\left(".concat(f,"\\right)")),l="keep"===e?c.getIdentifier():c.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return i+"{"+p+"}{"+f+"}";case"OperatorNode:pow":switch(p="{"+p+"}",f="{"+f+"}",l){case"ConditionalNode":case"OperatorNode:divide":p="\\left(".concat(p,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return p+"~"+f}return p+i+f}if(r.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var h=r.map((function(e,n){return e=e.toTex(t),o[n]&&(e="\\left(".concat(e,"\\right)")),e}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit?h.join("~"):h.join(i)}return"\\mathrm{"+this.fn+"}\\left("+r.map((function(e){return e.toTex(t)})).join(",")+"\\right)"},i.prototype.getIdentifier=function(){return this.type+":"+this.fn},i}},rn={name:"ParenthesisNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!t.isNode(e))throw new TypeError('Node expected for parameter "content"');this.content=e}return i.prototype=new o,i.prototype.type="ParenthesisNode",i.prototype.isParenthesisNode=!0,i.prototype._compile=function(t,e){return this.content._compile(t,e)},i.prototype.getContent=function(){return this.content.getContent()},i.prototype.forEach=function(t){t(this.content,"content",this)},i.prototype.map=function(t){return new i(t(this.content,"content",this))},i.prototype.clone=function(){return new i(this.content)},i.prototype._toString=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"("+this.content.toString(t)+")":this.content.toString(t)},i.prototype.toJSON=function(){return{mathjs:"ParenthesisNode",content:this.content}},i.fromJSON=function(t){return new i(t.content)},i.prototype.toHTML=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(t)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(t)},i.prototype._toTex=function(t){return!t||t&&!t.parenthesis||t&&"keep"===t.parenthesis?"\\left(".concat(this.content.toTex(t),"\\right)"):this.content.toTex(t)},i}},on=Gt.escape,an=et.hasOwnProperty,sn=Rt.getSafeProperty,un={name:"SymbolNode",path:"expression.node",math:!0,factory:function(t,e,n,r,o){var i=n(Jt);function a(e){return!!t.Unit&&t.Unit.isValuelessUnit(e)}function s(t){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"!=typeof t)throw new TypeError('String expected for parameter "name"');this.name=t}return s.prototype=new i,s.prototype.type="SymbolNode",s.prototype.isSymbolNode=!0,s.prototype._compile=function(e,n){var r=this.name;if(an(n,r))return function(t,e,n){return e[r]};if(r in e)return function(t,n,o){return sn(r in t?t:e,r)};var o=a(r);return function(e,n,i){return r in e?sn(e,r):o?new t.Unit(null,r):function(t){throw new Error("Undefined symbol "+t)}(r)}},s.prototype.forEach=function(t){},s.prototype.map=function(t){return this.clone()},s.prototype.clone=function(){return new s(this.name)},s.prototype._toString=function(t){return this.name},s.prototype.toHTML=function(t){var e=on(this.name);return"true"===e||"false"===e?'<span class="math-symbol math-boolean">'+e+"</span>":"i"===e?'<span class="math-symbol math-imaginary-symbol">'+e+"</span>":"Infinity"===e?'<span class="math-symbol math-infinity-symbol">'+e+"</span>":"NaN"===e?'<span class="math-symbol math-nan-symbol">'+e+"</span>":"null"===e?'<span class="math-symbol math-null-symbol">'+e+"</span>":"undefined"===e?'<span class="math-symbol math-undefined-symbol">'+e+"</span>":'<span class="math-symbol">'+e+"</span>"},s.prototype.toJSON=function(){return{mathjs:"SymbolNode",name:this.name}},s.fromJSON=function(t){return new s(t.name)},s.prototype._toTex=function(t){var e=!1;void 0===o[this.name]&&a(this.name)&&(e=!0);var n=Ie.toSymbol(this.name,e);return"\\"===n[0]?n:" "+n},s}};function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pn(){return(pn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var ln=Ie,fn=Gt.escape,hn=et.hasOwnProperty,mn=Yt.map,dn=Rt.validateSafeMethod,yn=Rt.getSafeProperty,vn={name:"FunctionNode",path:"expression.node",math:!0,factory:function(t,e,n,r,o){var i=n(Jt),a=n(un);function s(e,n){if(!(this instanceof s))throw new SyntaxError("Constructor must be called with the new operator");if("string"==typeof e&&(e=new a(e)),!t.isNode(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(n)||!n.every(t.isNode))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=n||[],Object.defineProperty(this,"name",{get:function(){return this.fn.name||""}.bind(this),set:function(){throw new Error("Cannot assign a new name, name is read-only")}});var r=function(){throw new Error("Property `FunctionNode.object` is deprecated, use `FunctionNode.fn` instead")};Object.defineProperty(this,"object",{get:r,set:r})}s.prototype=new i,s.prototype.type="FunctionNode",s.prototype.isFunctionNode=!0,s.prototype._compile=function(e,n){if(!(this instanceof s))throw new TypeError("No valid FunctionNode");var r=mn(this.args,(function(t){return t._compile(e,n)}));if(t.isSymbolNode(this.fn)){var o=this.fn.name,i=o in e?yn(e,o):void 0;if("function"==typeof i&&!0===i.rawArgs){var a=this.args;return function(t,n,r){return(o in t?yn(t,o):i)(a,e,pn({},t,n))}}if(1===r.length){var u=r[0];return function(t,e,n){return(o in t?yn(t,o):i)(u(t,e,n))}}if(2===r.length){var c=r[0],p=r[1];return function(t,e,n){return(o in t?yn(t,o):i)(c(t,e,n),p(t,e,n))}}return function(t,e,n){return(o in t?yn(t,o):i).apply(null,mn(r,(function(r){return r(t,e,n)})))}}if(t.isAccessorNode(this.fn)&&t.isIndexNode(this.fn.index)&&this.fn.index.isObjectProperty()){var l=this.fn.object._compile(e,n),f=this.fn.index.getObjectProperty(),h=this.args;return function(t,n,o){var i=l(t,n,o);return dn(i,f),i[f]&&i[f].rawArgs?i[f](h,e,pn({},t,n)):i[f].apply(i,mn(r,(function(e){return e(t,n,o)})))}}var m=this.fn._compile(e,n),d=this.args;return function(t,n,o){var i=m(t,n,o);return i&&i.rawArgs?i(d,e,pn({},t,n)):i.apply(i,mn(r,(function(e){return e(t,n,o)})))}},s.prototype.forEach=function(t){t(this.fn,"fn",this);for(var e=0;e<this.args.length;e++)t(this.args[e],"args["+e+"]",this)},s.prototype.map=function(t){for(var e=this._ifNode(t(this.fn,"fn",this)),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(t(this.args[r],"args["+r+"]",this));return new s(e,n)},s.prototype.clone=function(){return new s(this.fn,this.args.slice(0))};var u=s.prototype.toString;function c(e,n,r){for(var o,i="",a=new RegExp("\\$(?:\\{([a-z_][a-z_0-9]*)(?:\\[([0-9]+)\\])?\\}|\\$)","ig"),s=0;null!==(o=a.exec(e));)if(i+=e.substring(s,o.index),s=o.index,"$$"===o[0])i+="$",s++;else{s+=o[0].length;var u=n[o[1]];if(!u)throw new ReferenceError("Template: Property "+o[1]+" does not exist.");if(void 0===o[2])switch(cn(u)){case"string":i+=u;break;case"object":if(t.isNode(u))i+=u.toTex(r);else{if(!Array.isArray(u))throw new TypeError("Template: "+o[1]+" has to be a Node, String or array of Nodes");i+=u.map((function(e,n){if(t.isNode(e))return e.toTex(r);throw new TypeError("Template: "+o[1]+"["+n+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+o[1]+" has to be a Node, String or array of Nodes")}else{if(!t.isNode(u[o[2]]&&u[o[2]]))throw new TypeError("Template: "+o[1]+"["+o[2]+"] is not a Node.");i+=u[o[2]].toTex(r)}}return i+=e.slice(s)}s.prototype.toString=function(t){var e,n=this.fn.toString(t);return t&&"object"===cn(t.handler)&&hn(t.handler,n)&&(e=t.handler[n](this,t)),void 0!==e?e:u.call(this,t)},s.prototype._toString=function(e){var n=this.args.map((function(t){return t.toString(e)}));return(t.isFunctionAssignmentNode(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+n.join(", ")+")"},s.prototype.toJSON=function(){return{mathjs:"FunctionNode",fn:this.fn,args:this.args}},s.fromJSON=function(t){return new s(t.fn,t.args)},s.prototype.toHTML=function(t){var e=this.args.map((function(e){return e.toHTML(t)}));return'<span class="math-function">'+fn(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+e.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'};var p=s.prototype.toTex;return s.prototype.toTex=function(t){var e;return t&&"object"===cn(t.handler)&&hn(t.handler,this.name)&&(e=t.handler[this.name](this,t)),void 0!==e?e:p.call(this,t)},s.prototype._toTex=function(t){var e,n,r=this.args.map((function(e){return e.toTex(t)}));switch(!o[this.name]||"function"!=typeof o[this.name].toTex&&"object"!==cn(o[this.name].toTex)&&"string"!=typeof o[this.name].toTex||(e=o[this.name].toTex),cn(e)){case"function":n=e(this,t);break;case"string":n=c(e,this,t);break;case"object":switch(cn(e[r.length])){case"function":n=e[r.length](this,t);break;case"string":n=c(e[r.length],this,t)}}return void 0!==n?n:c(ln.defaultTemplate,this,t)},s.prototype.getIdentifier=function(){return this.type+":"+this.name},s}},gn={name:"RangeNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt);function i(e,n,r){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(!t.isNode(e))throw new TypeError("Node expected");if(!t.isNode(n))throw new TypeError("Node expected");if(r&&!t.isNode(r))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=n,this.step=r||null}function a(t,e){var n=we.getPrecedence(t,e),r={},o=we.getPrecedence(t.start,e);if(r.start=null!==o&&o<=n||"all"===e,t.step){var i=we.getPrecedence(t.step,e);r.step=null!==i&&i<=n||"all"===e}var a=we.getPrecedence(t.end,e);return r.end=null!==a&&a<=n||"all"===e,r}return i.prototype=new o,i.prototype.type="RangeNode",i.prototype.isRangeNode=!0,i.prototype.needsEnd=function(){return this.filter((function(e){return t.isSymbolNode(e)&&"end"===e.name})).length>0},i.prototype._compile=function(t,e){var n=t.range,r=this.start._compile(t,e),o=this.end._compile(t,e);if(this.step){var i=this.step._compile(t,e);return function(t,e,a){return n(r(t,e,a),o(t,e,a),i(t,e,a))}}return function(t,e,i){return n(r(t,e,i),o(t,e,i))}},i.prototype.forEach=function(t){t(this.start,"start",this),t(this.end,"end",this),this.step&&t(this.step,"step",this)},i.prototype.map=function(t){return new i(this._ifNode(t(this.start,"start",this)),this._ifNode(t(this.end,"end",this)),this.step&&this._ifNode(t(this.step,"step",this)))},i.prototype.clone=function(){return new i(this.start,this.end,this.step&&this.step)},i.prototype._toString=function(t){var e,n=a(this,t&&t.parenthesis?t.parenthesis:"keep"),r=this.start.toString(t);if(n.start&&(r="("+r+")"),e=r,this.step){var o=this.step.toString(t);n.step&&(o="("+o+")"),e+=":"+o}var i=this.end.toString(t);return n.end&&(i="("+i+")"),e+=":"+i},i.prototype.toJSON=function(){return{mathjs:"RangeNode",start:this.start,end:this.end,step:this.step}},i.fromJSON=function(t){return new i(t.start,t.end,t.step)},i.prototype.toHTML=function(t){var e,n=a(this,t&&t.parenthesis?t.parenthesis:"keep"),r=this.start.toHTML(t);if(n.start&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e=r,this.step){var o=this.step.toHTML(t);n.step&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+='<span class="math-operator math-range-operator">:</span>'+o}var i=this.end.toHTML(t);return n.end&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),e+='<span class="math-operator math-range-operator">:</span>'+i},i.prototype._toTex=function(t){var e=a(this,t&&t.parenthesis?t.parenthesis:"keep"),n=this.start.toTex(t);if(e.start&&(n="\\left(".concat(n,"\\right)")),this.step){var r=this.step.toTex(t);e.step&&(r="\\left(".concat(r,"\\right)")),n+=":"+r}var o=this.end.toTex(t);return e.end&&(o="\\left(".concat(o,"\\right)")),n+=":"+o},i}},bn=Gt.escape,wn={name:"RelationalNode",path:"expression.node",factory:function(t,e,n,r){var o=n(Jt),i=Rt.getSafeProperty;function a(t,e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(!Array.isArray(t))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(e))throw new TypeError("Parameter params must be an array");if(t.length!==e.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=t,this.params=e}return a.prototype=new o,a.prototype.type="RelationalNode",a.prototype.isRelationalNode=!0,a.prototype._compile=function(t,e){var n=this,r=this.params.map((function(n){return n._compile(t,e)}));return function(e,o,a){for(var s,u=r[0](e,o,a),c=0;c<n.conditionals.length;c++)if(s=u,u=r[c+1](e,o,a),!i(t,n.conditionals[c])(s,u))return!1;return!0}},a.prototype.forEach=function(t){var e=this;this.params.forEach((function(n,r){return t(n,"params["+r+"]",e)}),this)},a.prototype.map=function(t){var e=this;return new a(this.conditionals.slice(),this.params.map((function(n,r){return e._ifNode(t(n,"params["+r+"]",e))}),this))},a.prototype.clone=function(){return new a(this.conditionals,this.params)},a.prototype._toString=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=we.getPrecedence(this,e),r=this.params.map((function(r,o){var i=we.getPrecedence(r,e);return"all"===e||null!==i&&i<=n?"("+r.toString(t)+")":r.toString(t)})),o={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},i=r[0],a=0;a<this.conditionals.length;a++)i+=" "+o[this.conditionals[a]]+" "+r[a+1];return i},a.prototype.toJSON=function(){return{mathjs:"RelationalNode",conditionals:this.conditionals,params:this.params}},a.fromJSON=function(t){return new a(t.conditionals,t.params)},a.prototype.toHTML=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=we.getPrecedence(this,e),r=this.params.map((function(r,o){var i=we.getPrecedence(r,e);return"all"===e||null!==i&&i<=n?'<span class="math-parenthesis math-round-parenthesis">(</span>'+r.toHTML(t)+'<span class="math-parenthesis math-round-parenthesis">)</span>':r.toHTML(t)})),o={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="},i=r[0],a=0;a<this.conditionals.length;a++)i+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+bn(o[this.conditionals[a]])+"</span>"+r[a+1];return i},a.prototype._toTex=function(t){for(var e=t&&t.parenthesis?t.parenthesis:"keep",n=we.getPrecedence(this,e),r=this.params.map((function(r,o){var i=we.getPrecedence(r,e);return"all"===e||null!==i&&i<=n?"\\left("+r.toTex(t)+"\right)":r.toTex(t)})),o=r[0],i=0;i<this.conditionals.length;i++)o+=Ie.operators[this.conditionals[i]]+r[i+1];return o},a}};function Nn(){return(Nn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var xn={name:"parse",path:"expression",factory:function(t,e,n,r){var o=n(Tt),i=n(le),a=n(he),s=n(Se),u=n(Ae),c=n(Oe),p=n(De),l=n(We),f=n(Ue),h=n(Ye),m=n(nn),d=n(rn),y=n(vn),v=n(gn),g=n(wn),b=n(un);function w(e,n){if(1!==arguments.length&&2!==arguments.length)throw new ht("parse",arguments.length,1,2);var r=n&&n.nodes?n.nodes:{};if("string"==typeof e)return B(e,r);if(Array.isArray(e)||e instanceof t.Matrix)return St(e,(function(t){if("string"!=typeof t)throw new TypeError("String expected");return B(t,r)}));throw new TypeError("String or matrix expected")}var N=0,x=1,S=2,k=3,E=4,C={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},A={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},O={true:!0,false:!1,null:null,undefined:void 0},T=["NaN","Infinity"];function j(t,e){return t.expression.substr(t.index,e)}function P(t){return j(t,1)}function M(t){t.index++}function I(t){return t.expression.charAt(t.index-1)}function F(t){return t.expression.charAt(t.index+1)}function _(t){for(t.tokenType=N,t.token="",t.comment="";w.isWhitespace(P(t),t.nestingLevel);)M(t);if("#"===P(t))for(;"\n"!==P(t)&&""!==P(t);)t.comment+=P(t),M(t);if(""!==P(t)){if("\n"===P(t)&&!t.nestingLevel)return t.tokenType=x,t.token=P(t),void M(t);var e=P(t),n=j(t,2),r=j(t,3);if(3===r.length&&C[r])return t.tokenType=x,t.token=r,M(t),M(t),void M(t);if(2===n.length&&C[n])return t.tokenType=x,t.token=n,M(t),void M(t);if(C[e])return t.tokenType=x,t.token=e,void M(t);if(w.isDigitDot(e)){if(t.tokenType=S,"."===P(t))t.token+=P(t),M(t),w.isDigit(P(t))||(t.tokenType=x);else{for(;w.isDigit(P(t));)t.token+=P(t),M(t);w.isDecimalMark(P(t),F(t))&&(t.token+=P(t),M(t))}for(;w.isDigit(P(t));)t.token+=P(t),M(t);if("E"===P(t)||"e"===P(t))if(w.isDigit(F(t))||"-"===F(t)||"+"===F(t)){if(t.token+=P(t),M(t),"+"!==P(t)&&"-"!==P(t)||(t.token+=P(t),M(t)),!w.isDigit(P(t)))throw at(t,'Digit expected, got "'+P(t)+'"');for(;w.isDigit(P(t));)t.token+=P(t),M(t);if(w.isDecimalMark(P(t),F(t)))throw at(t,'Digit expected, got "'+P(t)+'"')}else if("."===F(t))throw M(t),at(t,'Digit expected, got "'+P(t)+'"')}else{if(!w.isAlpha(P(t),I(t),F(t))){for(t.tokenType=E;""!==P(t);)t.token+=P(t),M(t);throw at(t,'Syntax error in part "'+t.token+'"')}for(;w.isAlpha(P(t),I(t),F(t))||w.isDigit(P(t));)t.token+=P(t),M(t);A.hasOwnProperty(t.token)?t.tokenType=x:t.tokenType=k}}else t.tokenType=x}function D(t){do{_(t)}while("\n"===t.token)}function R(t){t.nestingLevel++}function L(t){t.nestingLevel--}function B(t,e){var n={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:N,nestingLevel:0,conditionalLevel:null};Nn(n,{expression:t,extraNodes:e}),_(n);var r=function(t){var e,n,r=[];for(""!==t.token&&"\n"!==t.token&&";"!==t.token&&((e=z(t)).comment=t.comment);"\n"===t.token||";"===t.token;)0===r.length&&e&&(n=";"!==t.token,r.push({node:e,visible:n})),_(t),"\n"!==t.token&&";"!==t.token&&""!==t.token&&((e=z(t)).comment=t.comment,n=";"!==t.token,r.push({node:e,visible:n}));return r.length>0?new u(r):(e||((e=new p(void 0)).comment=t.comment),e)}(n);if(""!==n.token)throw n.tokenType===x?st(n,"Unexpected operator "+n.token):at(n,'Unexpected part "'+n.token+'"');return r}function z(e){var n,r,o,i,a=function(t){for(var e=function(t){for(var e=W(t);"or"===t.token;)D(t),e=new m("or","or",[e,W(t)]);return e}(t);"?"===t.token;){var n=t.conditionalLevel;t.conditionalLevel=t.nestingLevel,D(t);var r=e,o=z(t);if(":"!==t.token)throw at(t,"False part of conditional expression expected");t.conditionalLevel=null,D(t);var i=z(t);e=new c(r,o,i),t.conditionalLevel=n}return e}(e);if("="===e.token){if(t.isSymbolNode(a))return n=a.name,D(e),o=z(e),new s(new b(n),o);if(t.isAccessorNode(a))return D(e),o=z(e),new s(a.object,a.index,o);if(t.isFunctionNode(a)&&t.isSymbolNode(a.fn)&&(i=!0,r=[],n=a.name,a.args.forEach((function(e,n){t.isSymbolNode(e)?r[n]=e.name:i=!1})),i))return D(e),o=z(e),new l(n,r,o);throw at(e,"Invalid left hand side of assignment operator =")}return a}function W(t){for(var e=J(t);"xor"===t.token;)D(t),e=new m("xor","xor",[e,J(t)]);return e}function J(t){for(var e=q(t);"and"===t.token;)D(t),e=new m("and","and",[e,q(t)]);return e}function q(t){for(var e=H(t);"|"===t.token;)D(t),e=new m("|","bitOr",[e,H(t)]);return e}function H(t){for(var e=U(t);"^|"===t.token;)D(t),e=new m("^|","bitXor",[e,U(t)]);return e}function U(t){for(var e=$(t);"&"===t.token;)D(t),e=new m("&","bitAnd",[e,$(t)]);return e}function $(t){for(var e=[G(t)],n=[],r={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};r.hasOwnProperty(t.token);){var o={name:t.token,fn:r[t.token]};n.push(o),D(t),e.push(G(t))}return 1===e.length?e[0]:2===e.length?new m(n[0].name,n[0].fn,e):new g(n.map((function(t){return t.fn})),e)}function G(t){var e,n,r,o,i;for(e=V(t),n={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};n.hasOwnProperty(t.token);)o=n[r=t.token],D(t),i=[e,V(t)],e=new m(r,o,i);return e}function V(t){var e,n,r,o,i;for(e=K(t),n={to:"to",in:"to"};n.hasOwnProperty(t.token);)o=n[r=t.token],D(t),"in"===r&&""===t.token?e=new m("*","multiply",[e,new b("in")],!0):(i=[e,K(t)],e=new m(r,o,i));return e}function K(t){var e,n=[];if(e=":"===t.token?new p(1):Z(t),":"===t.token&&t.conditionalLevel!==t.nestingLevel){for(n.push(e);":"===t.token&&n.length<3;)D(t),")"===t.token||"]"===t.token||","===t.token||""===t.token?n.push(new b("end")):n.push(Z(t));e=3===n.length?new v(n[0],n[2],n[1]):new v(n[0],n[1])}return e}function Z(t){var e,n,r,o,i;for(e=Y(t),n={"+":"add","-":"subtract"};n.hasOwnProperty(t.token);)o=n[r=t.token],D(t),i=[e,Y(t)],e=new m(r,o,i);return e}function Y(t){var e,n,r,o,i;for(n=e=X(t),r={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};r.hasOwnProperty(t.token);)i=r[o=t.token],D(t),n=X(t),e=new m(o,i,[e,n]);return e}function X(e){var n,r;for(r=n=Q(e);e.tokenType===k||"in"===e.token&&t.isConstantNode(n)||!(e.tokenType!==S||t.isConstantNode(r)||t.isOperatorNode(r)&&"!"!==r.op)||"("===e.token;)r=Q(e),n=new m("*","multiply",[n,r],!0);return n}function Q(e){for(var n=tt(e),r=n,o=[];"/"===e.token&&t.isConstantNode(r);){if(o.push(Nn({},e)),D(e),e.tokenType!==S){Nn(e,o.pop());break}if(o.push(Nn({},e)),D(e),e.tokenType!==k&&"("!==e.token){o.pop(),Nn(e,o.pop());break}Nn(e,o.pop()),o.pop(),r=tt(e),n=new m("/","divide",[n,r])}return n}function tt(t){var n,r,i,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return s.hasOwnProperty(t.token)?(i=s[t.token],n=t.token,D(t),r=[tt(t)],new m(n,i,r)):function(t){var n,r,i,s;return n=function(t){var n,r,i,s;for(n=function(t){var n=[];if(t.tokenType===k&&t.extraNodes.hasOwnProperty(t.token)){var r=t.extraNodes[t.token];if(_(t),"("===t.token){if(n=[],R(t),_(t),")"!==t.token)for(n.push(z(t));","===t.token;)_(t),n.push(z(t));if(")"!==t.token)throw at(t,"Parenthesis ) expected");L(t),_(t)}return new r(n)}return function(t){var n,r;return t.tokenType===k||t.tokenType===x&&t.token in A?(r=t.token,_(t),n=O.hasOwnProperty(r)?new p(O[r]):-1!==T.indexOf(r)?new p(o(r,"number")):new b(r),n=et(t,n)):function(t){var n,r;return'"'===t.token?(r=nt(t),n=new p(r),n=et(t,n)):function(t){var n,r;return"'"===t.token?(r=rt(t),n=new p(r),n=et(t,n)):function(t){var n,r,i,s;if("["===t.token){if(R(t),_(t),"]"!==t.token){var u=ot(t);if(";"===t.token){for(i=1,r=[u];";"===t.token;)_(t),r[i]=ot(t),i++;if("]"!==t.token)throw at(t,"End of matrix ] expected");L(t),_(t),s=r[0].items.length;for(var c=1;c<i;c++)if(r[c].items.length!==s)throw st(t,"Column dimensions mismatch ("+r[c].items.length+" !== "+s+")");n=new a(r)}else{if("]"!==t.token)throw at(t,"End of matrix ] expected");L(t),_(t),n=u}}else L(t),_(t),n=new a([]);return et(t,n)}return function(t){if("{"===t.token){var n;R(t);var r={};do{if(_(t),"}"!==t.token){if('"'===t.token)n=nt(t);else if("'"===t.token)n=rt(t);else{if(t.tokenType!==k)throw at(t,"Symbol or string expected as object key");n=t.token,_(t)}if(":"!==t.token)throw at(t,"Colon : expected after object key");_(t),r[n]=z(t)}}while(","===t.token);if("}"!==t.token)throw at(t,"Comma , or bracket } expected after object value");L(t),_(t);var i=new h(r);return i=et(t,i)}return function(t){var n;return t.tokenType===S?(n=t.token,_(t),new p(o(n,e.number))):function(t){var e;if("("===t.token){if(R(t),_(t),e=z(t),")"!==t.token)throw at(t,"Parenthesis ) expected");return L(t),_(t),e=new d(e),e=et(t,e)}return function(t){throw""===t.token?at(t,"Unexpected end of expression"):at(t,"Value expected")}(t)}(t)}(t)}(t)}(t)}(t)}(t)}(t)}(t),r={"!":"factorial","'":"ctranspose"};r.hasOwnProperty(t.token);)i=t.token,s=r[i],_(t),n=new m(i,s,[n]),n=et(t,n);return n}(t),("^"===t.token||".^"===t.token)&&(r=t.token,i="^"===r?"pow":"dotPow",D(t),s=[n,tt(t)],n=new m(r,i,s)),n}(t)}function et(e,n,r){for(var o;!("("!==e.token&&"["!==e.token&&"."!==e.token||r&&-1===r.indexOf(e.token));)if(o=[],"("===e.token){if(!t.isSymbolNode(n)&&!t.isAccessorNode(n))return n;if(R(e),_(e),")"!==e.token)for(o.push(z(e));","===e.token;)_(e),o.push(z(e));if(")"!==e.token)throw at(e,"Parenthesis ) expected");L(e),_(e),n=new y(n,o)}else if("["===e.token){if(R(e),_(e),"]"!==e.token)for(o.push(z(e));","===e.token;)_(e),o.push(z(e));if("]"!==e.token)throw at(e,"Parenthesis ] expected");L(e),_(e),n=new i(n,new f(o))}else{if(_(e),e.tokenType!==k)throw at(e,"Property name expected after dot");o.push(new p(e.token)),_(e),n=new i(n,new f(o,!0))}return n}function nt(t){for(var e="";""!==P(t)&&'"'!==P(t);)"\\"===P(t)&&(e+=P(t),M(t)),e+=P(t),M(t);if(_(t),'"'!==t.token)throw at(t,'End of string " expected');return _(t),JSON.parse('"'+e+'"')}function rt(t){for(var e="";""!==P(t)&&"'"!==P(t);)"\\"===P(t)&&(e+=P(t),M(t)),e+=P(t),M(t);if(_(t),"'"!==t.token)throw at(t,"End of string ' expected");return _(t),JSON.parse('"'+e+'"')}function ot(t){for(var e=[z(t)],n=1;","===t.token;)_(t),e[n]=z(t),n++;return new a(e)}function it(t){return t.index-t.token.length+1}function at(t,e){var n=it(t),r=new SyntaxError(e+" (char "+n+")");return r.char=n,r}function st(t,e){var n=it(t),r=new SyntaxError(e+" (char "+n+")");return r.char=n,r}return w.isAlpha=function(t,e,n){return w.isValidLatinOrGreek(t)||w.isValidMathSymbol(t,n)||w.isValidMathSymbol(e,t)},w.isValidLatinOrGreek=function(t){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(t)},w.isValidMathSymbol=function(t,e){return/^[\uD835]$/.test(t)&&/^[\uDC00-\uDFFF]$/.test(e)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(e)},w.isWhitespace=function(t,e){return" "===t||"\t"===t||"\n"===t&&e>0},w.isDecimalMark=function(t,e){return"."===t&&"/"!==e&&"*"!==e&&"^"!==e},w.isDigitDot=function(t){return t>="0"&&t<="9"||"."===t},w.isDigit=function(t){return t>="0"&&t<="9"},w}},Sn={name:"parse",factory:function(t,e,n,r){var o=n(xn);return r("parse",{"string | Array | Matrix":o,"string | Array | Matrix, Object":o})}},kn={name:"compile",factory:function(t,e,n,r){var o=n(xn);return r("compile",{string:function(t){return o(t).compile()},"Array | Matrix":function(t){return St(t,(function(t){return o(t).compile()}))}})}},En={name:"eval",factory:function(t,e,n,r){var o=n(xn);return r("compile",{string:function(t){return o(t).compile().eval({})},"string, Object":function(t,e){return o(t).compile().eval(e)},"Array | Matrix":function(t){var e={};return St(t,(function(t){return o(t).compile().eval(e)}))},"Array | Matrix, Object":function(t,e){return St(t,(function(t){return o(t).compile().eval(e)}))}})}},Cn={name:"format",factory:function(t,e,n,r){var o=r("format",{any:Gt.format,"any, Object | function | number":Gt.format});return o.toTex=void 0,o}},An=xt.create();An.import(Sn),An.import(kn),An.import(En),An.import(Cn),An.import({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e},mod:function(t,e){return t%e},unaryPlus:function(t){return t},unaryMinus:function(t){return-t},bitOr:function(t,e){return t|e},bitXor:function(t,e){return t^e},bitAnd:function(t,e){return t&e},bitNot:function(t){return~t},leftShift:function(t,e){return t<<e},rightArithShift:function(t,e){return t>>e},rightLogShift:function(t,e){return t>>>e},or:function(t,e){return!(!t&&!e)},xor:function(t,e){return!!t!=!!e},and:function(t,e){return!(!t||!e)},not:function(t){return!t},equal:function(t,e){return t==e},unequal:function(t,e){return t!=e},smaller:function(t,e){return t<e},larger:function(t,e){return t>e},smallerEq:function(t,e){return t<=e},largerEq:function(t,e){return t>=e},matrix:function(){throw new Error("Matrices not supported")},index:function(){throw new Error("Matrix indexes not supported")},pi:Math.PI,e:Math.E,true:!0,false:!1,null:null});var On={};Object.getOwnPropertyNames(Math).forEach((function(t){Object.prototype.hasOwnProperty(t)||(On[t]=Math[t])})),An.import(On);var Tn,jn=An,Pn=function(){function t(){n(this,t)}return o(t,null,[{key:"parse",value:function(t){if(!t)throw Error("Notation is required");if("string"!=typeof t)throw Error("Notation must be a string");return function t(e){if(Array.isArray(e))return e.map((function(e){return t(e)}));if(e instanceof Object)if("dice"===e.type){var n=t(e.sides);n=Array.isArray(n)?n.join(""):n;var r=t(e.qty);switch(r=jn.eval(Array.isArray(r)?r.join(""):r),e.modifiers=Object.assign.apply(Object,[{}].concat(d(Object.keys(e.modifiers).map((function(n){return i({},n,t(e.modifiers[n]))}))))),e.subType){case"standard":return new W(e.notation,jn.eval(n),r,e.modifiers);case"percentile":return new q(e.notation,r,e.modifiers);case"fudge":return new J(e.notation,jn.eval(n),r,e.modifiers);default:throw Error("Parser: Dice type was not recognised")}}else{if("group"===e.type)return e.expressions=t(e.expressions),e.modifiers=Object.assign.apply(Object,[{}].concat(d(Object.keys(e.modifiers).map((function(n){return i({},n,t(e.modifiers[n]))}))))),new X(e.notation,e.expressions,e.modifiers);if("modifier"===e.type)switch(e.subType){case"drop":return new V(e.notation,e.end,e.qty);case"explode":return e.comparePoint=t(e.comparePoint),new R(e.notation,e.comparePoint,e.compound,e.penetrate);case"keep":return new G(e.notation,e.end,e.qty);case"target":return e.successCP=t(e.successCP),e.failureCP=e.failureCP?t(e.failureCP):null,new Z(e.notation,e.successCP,e.failureCP);case"re-roll":return e.comparePoint=t(e.comparePoint),new B(e.notation,e.once,e.comparePoint);case"critical-success":return e.comparePoint=t(e.comparePoint),new $(e.notation,e.comparePoint);case"critical-failure":return e.comparePoint=t(e.comparePoint),new U(e.notation,e.comparePoint);case"sort":return new K(e.notation,e.direction)}else if("compare-point"===e.type)return new F(e.operator,e.value)}return e}(v(t))}}]),t}(),Mn=function(){var t=Symbol("calculateTotals"),r=Symbol("notation"),i=Symbol("parsed-notation"),a=Symbol("rolls"),s=Symbol("totals");return function(){function u(t){if(n(this,u),!t)throw new Error("Notation is required");if(this[i]=[],t instanceof Object&&!Array.isArray(t)){if(!t.notation)throw new Error("Notation is required");if("string"!=typeof t.notation)throw new Error("Notation is not valid: ".concat(t.notation));if(t.rolls){if(!Array.isArray(t.rolls))throw new Error("Rolls must be an Array: ".concat(t.rolls));this[a]=t.rolls.map((function(t){return t instanceof L?t:Array.isArray(t)?new L(t):t instanceof Object&&Array.isArray(t.rolls)?new L(t.rolls):void 0}))}this[r]=t.notation,this[i]=Pn.parse(this.notation),this[a]&&this[a].length||(this[a]=[],this.roll())}else{if("string"!=typeof t)throw new Error("Notation is not valid: ".concat(t));this[r]=t,this[a]=[],this[i]=Pn.parse(this.notation),this.roll()}}return o(u,[{key:"export",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M.JSON;switch(t){case M.BASE_64:return btoa(this.export(M.JSON));case M.JSON:return JSON.stringify(this);case M.OBJECT:return JSON.parse(this.export(M.JSON));default:throw new Error("Unrecognised export format: ".concat(t))}}},{key:"hasRolls",value:function(){return!!(this[i]&&Array.isArray(this.rolls)&&this.rolls.length)}},{key:"roll",value:function(){return this[a]=[],this[s]=0,this[a]=this[i].map((function(t){if(t instanceof W||t instanceof X)return t.roll()})).filter(Boolean),this[a]}},{key:"toJSON",value:function(){return{notation:this.notation,output:this.output,rolls:this.rolls,total:this.total,type:"dice-roll"}}},{key:"toString",value:function(){return this.output}},{key:t,value:function(){var t=this,e="",n=0;return this.hasRolls()&&this[i].forEach((function(r){r instanceof W?(e+=t.rolls[n]?t.rolls[n].value:0,n++):e+=r})),e?P.toFixed(jn.eval(e),2):0}},{key:"notation",get:function(){return this[r]||""}},{key:"output",get:function(){var t=this,e=0,n="".concat(this.notation,": ");return this.hasRolls()?(n+=this[i].map((function(n){if(n instanceof W){var r=t.rolls[e]||null;return e++,r}return n})).filter(Boolean).join(""),n+=" = ".concat(this.total)):n+="No dice rolled",n}},{key:"rolls",get:function(){return this[a]||[]}},{key:"total",get:function(){return!this[s]&&this.hasRolls()&&(this[s]=this[t]()),this[s]||0}}],[{key:"import",value:function(t){if(t){if(P.isJson(t))return u.import(JSON.parse(t));if(P.isBase64(t))return u.import(atob(t));if("object"===e(t))return t instanceof u?t:new u(t);throw new Error("Unrecognised import format for data: ".concat(t))}throw new Error("No data to import")}}]),u}()}(),In=(Tn=Symbol("log"),function(){function t(e){var r=this;if(n(this,t),this[Tn]=[],e)if(Array.isArray(e.log))e.log.forEach((function(t){r[Tn].push(Mn.import(t))}));else if(e.log)throw new Error("DiceRoller: Roll log must be an Array")}return o(t,[{key:"clearLog",value:function(){this[Tn].length=0}},{key:"export",value:function(t){switch(t||M.JSON){case M.BASE_64:return btoa(this.export(M.JSON));case M.JSON:return JSON.stringify(this);case M.OBJECT:return JSON.parse(this.export(M.JSON));default:throw new Error("Unrecognised export format: "+t)}}},{key:"import",value:function(t){var n=this;if(t){if(P.isJson(t))return this.import(JSON.parse(t));if(P.isBase64(t))return this.import(atob(t));if("object"===e(t)){if(!t.log&&Array.isArray(t)&&t.length&&(t={log:t}),t.log&&Array.isArray(t.log))t.log.forEach((function(t){n[Tn].push(Mn.import(t))}));else if(t.log)throw new Error("Roll log must be an Array");return this.log}throw new Error("Unrecognised import format for data: "+t)}throw new Error("No data to import")}},{key:"toJSON",value:function(){return{log:this.log,output:this.output,total:this.total,type:"dice-roller"}}},{key:"toString",value:function(){return this.output}},{key:"roll",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n||!n.length)throw new Error("No notations specified");var o=n.filter(Boolean);if(!o.length)throw new Error("No notations specified");var i=o.map((function(e){var n=new Mn(e);return t[Tn].push(n),n}));return i.length>1?i:i[0]}},{key:"log",get:function(){return this[Tn]||[]}},{key:"output",get:function(){return this.log.join("; ")}},{key:"total",get:function(){return this.log.reduce((function(t,e){return t+e.total}),0)}}],[{key:"import",value:function(e){var n=new t;return n.import(e),n}}]),t}());t.Dice=H,t.DiceRoll=Mn,t.DiceRoller=In,t.Modifiers=Y,t.Parser=Pn,t.diceUtils=P,t.exportFormats=M,Object.defineProperty(t,"__esModule",{value:!0})}(e)})));function Ue(e){let n,r,o,i,p;return{c(){n=c("div"),r=c("pre"),o=f(),i=c("button"),i.textContent="Clear",m(r,"class","pre-scrollable bg-white small border p-3 svelte-1deeukk"),m(i,"class","btn btn-lg btn-primary btn-block")},m(t,u,c){s(t,n,u),a(n,r),e[4](r),a(n,o),a(n,i),c&&p(),p=h(i,"click",e[1])},p:t,i:t,o:t,d(t){t&&u(n),e[4](null),p()}}}function $e(t,e,n){let r="";const o=t=>{n(0,r.innerHTML=n(0,r.innerHTML+=t+"\n",r),r),n(0,r.scrollTop=r.scrollHeight,r)};let{recording:i=boolean}=e;return qe.onSegmentChange(t=>{if(console.log(t),t.isFinal){o(`Heard: "${t.words.map(({value:t})=>t.toLowerCase()).join(" ")}"`);const e=new He.DiceRoller;let n=1;for(const{type:r,value:o}of t.entities)switch(r){case"quantity":n=isNaN(o)?1:o;break;case"dice":isNaN(o)||(e.roll(`${Number(n)}d${Number(o)}`),n=1)}e.total?(o(e.toString().split(";").map(t=>t.trim()).join("\n")),o("Total: "+e.total)):o("Sorry, didn't hear any rolls this time.")}}),t.$set=t=>{"recording"in t&&n(2,i=t.recording)},t.$$.update=()=>{4&t.$$.dirty&&(i?qe.startContext(t=>{void 0!==t?(console.error(t),o("Error: Failed to start recording!")):o("Listening...")}):qe.stopContext())},[r,()=>n(0,r.innerHTML="",r),i,o,function(t){g[t?"unshift":"push"](()=>{n(0,r=t)})}]}class Ge extends B{constructor(t){super(),L(this,t,$e,Ue,i,{recording:2})}}function Ve(e){let n,r,o;return{c(){n=p("svg"),r=p("path"),o=p("path"),m(r,"d","M5 3a3 3 0 016 0v5a3 3 0 01-6 0V3z"),m(o,"fill-rule","evenodd"),m(o,"d","M3.5 6.5A.5.5 0 014 7v1a4 4 0 008 0V7a.5.5 0 011 0v1a5 5 0 01-4.5\n    4.975V15h3a.5.5 0 010 1h-7a.5.5 0 010-1h3v-2.025A5 5 0 013 8V7a.5.5 0\n    01.5-.5z"),m(o,"clip-rule","evenodd"),m(n,"class","bi bi-mic-fill"),m(n,"width","1em"),m(n,"height","1em"),m(n,"viewBox","0 0 16 16"),m(n,"fill","currentColor"),m(n,"xmlns","http://www.w3.org/2000/svg")},m(t,e){s(t,n,e),a(n,r),a(n,o)},p:t,i:t,o:t,d(t){t&&u(n)}}}class Ke extends B{constructor(t){super(),L(this,t,null,Ve,i,{})}}function Ze(e){let n;return{c(){n=c("button"),n.textContent="Initializing...",m(n,"class","btn btn-primary"),n.disabled=!0},m(t,e){s(t,n,e)},p:t,i:t,o:t,d(t){t&&u(n)}}}function Ye(t){let e,n,r,o,i,a;const p=[Qe,Xe],l=[];function f(t,e){return t[1]?1:0}return n=f(t),r=l[n]=p[n](t),{c(){e=c("button"),r.c(),m(e,"class",o="btn btn-lg btn-"+(t[1]?"danger":"primary"))},m(r,o,u){s(r,e,o),l[n].m(e,null),i=!0,u&&a(),a=h(e,"click",t[2])},p(t,a){let s=n;n=f(t),n!==s&&(j(),I(l[s],1,1,()=>{l[s]=null}),P(),r=l[n],r||(r=l[n]=p[n](t),r.c()),M(r,1),r.m(e,null)),(!i||2&a&&o!==(o="btn btn-lg btn-"+(t[1]?"danger":"primary")))&&m(e,"class",o)},i(t){i||(M(r),i=!0)},o(t){I(r),i=!1},d(t){t&&u(e),l[n].d(),a()}}}function Xe(e){let n;return{c(){n=l("Stop Recording")},m(t,e){s(t,n,e)},i:t,o:t,d(t){t&&u(n)}}}function Qe(t){let e,n;const r=new Ke({});return{c(){F(r.$$.fragment),e=l("\n          Click to Speak")},m(t,o){_(r,t,o),s(t,e,o),n=!0},i(t){n||(M(r.$$.fragment,t),n=!0)},o(t){I(r.$$.fragment,t),n=!1},d(t){D(r,t),t&&u(e)}}}function tn(t){let e,n,r,o,i,p,l,h,d,y,v,g,b,w,N;const x=[Ye,Ze],S=[];function k(t,e){return t[0]?0:1}y=k(t),v=S[y]=x[y](t);const E=new Ge({props:{recording:t[1]}});return{c(){e=c("div"),n=c("div"),r=c("img"),i=f(),p=c("h1"),p.textContent="DnD Voice Dice Roller",l=f(),h=c("p"),h.innerHTML="\n      Try saying something like:\n      <i>&quot;Roll 2d8 + 2d4&quot;</i>",d=f(),v.c(),g=f(),F(E.$$.fragment),b=f(),w=c("p"),w.innerHTML='\n    © 2020\n    <a href="https://viljami.io" target="_blank">viljami.io</a> \n    <a href="https://github.com/anttiviljami" target="_blank"><img src="https://img.icons8.com/material-sharp/96/000000/github.png" alt="GitHub" class="icon"></a> \n    <a href="https://twitter.com/anttiviljami" title="twitter.com/anttiviljami" target="_blank"><img src="https://img.icons8.com/android/96/000000/twitter.png" alt="Twitter" class="icon"></a>',m(r,"class","logo"),m(r,"alt","logo"),r.src!==(o="d20.png")&&m(r,"src","d20.png"),m(n,"class","mt-5 mb-3 text-center"),m(w,"align","center"),m(w,"class","mt-3"),m(e,"class","container")},m(t,o){s(t,e,o),a(e,n),a(n,r),a(n,i),a(n,p),a(n,l),a(n,h),a(n,d),S[y].m(n,null),a(e,g),_(E,e,null),a(e,b),a(e,w),N=!0},p(t,[e]){let r=y;y=k(t),y===r?S[y].p(t,e):(j(),I(S[r],1,1,()=>{S[r]=null}),P(),v=S[y],v||(v=S[y]=x[y](t),v.c()),M(v,1),v.m(n,null));const o={};2&e&&(o.recording=t[1]),E.$set(o)},i(t){N||(M(v),M(E.$$.fragment,t),N=!0)},o(t){I(v),I(E.$$.fragment,t),N=!1},d(t){t&&u(e),S[y].d(),D(E)}}}function en(t,e,n){let r=!1;qe.initialize(t=>{void 0===t?n(0,r=!0):console.error("Failed to initialize Speechly client:",t)});let o,i=!1;return[r,i,()=>{n(1,i=!i),i?o=setTimeout(()=>{n(1,i=!1)},8e3):clearTimeout(o)}]}return new class extends B{constructor(t){super(),L(this,t,en,tn,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
